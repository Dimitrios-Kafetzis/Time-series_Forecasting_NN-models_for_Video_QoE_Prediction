Starting training of all models at Τετ 14 Μαΐ 2025 10:03:41 μμ EEST
Models will be saved in /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5
All models will be trained with the new dataset format (default) and --use_stats flag enabled

=====================================================
Training linear model with config: basic
Starting at Τετ 14 Μαΐ 2025 10:03:41 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type linear                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 
2025-05-14 22:03:41.616736: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:03:41.783407: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:03:42.448040: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:03:42.448162: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:03:42.448178: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:03:49.491106: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:03:50.191358: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:03:50.191390: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:03:50.191525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5554 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 1)                 226       
                                                                 
=================================================================
Total params: 226
Trainable params: 226
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 1:20 - loss: 2.3398 23/102 [=====>........................] - ETA: 0s - loss: 1.1428   43/102 [===========>..................] - ETA: 0s - loss: 0.7108 63/102 [=================>............] - ETA: 0s - loss: 0.5435 84/102 [=======================>......] - ETA: 0s - loss: 0.4362102/102 [==============================] - 1s 4ms/step - loss: 0.3764 - val_loss: 0.0611 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.0656 23/102 [=====>........................] - ETA: 0s - loss: 0.0625 42/102 [===========>..................] - ETA: 0s - loss: 0.0664 62/102 [=================>............] - ETA: 0s - loss: 0.0646 82/102 [=======================>......] - ETA: 0s - loss: 0.0638101/102 [============================>.] - ETA: 0s - loss: 0.0623102/102 [==============================] - 0s 3ms/step - loss: 0.0623 - val_loss: 0.0419 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.0291 23/102 [=====>........................] - ETA: 0s - loss: 0.0489 44/102 [===========>..................] - ETA: 0s - loss: 0.0469 66/102 [==================>...........] - ETA: 0s - loss: 0.0467 87/102 [========================>.....] - ETA: 0s - loss: 0.0486102/102 [==============================] - 0s 3ms/step - loss: 0.0476 - val_loss: 0.0276 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0614 20/102 [====>.........................] - ETA: 0s - loss: 0.0414 39/102 [==========>...................] - ETA: 0s - loss: 0.0401 59/102 [================>.............] - ETA: 0s - loss: 0.0399 80/102 [======================>.......] - ETA: 0s - loss: 0.0427101/102 [============================>.] - ETA: 0s - loss: 0.0428102/102 [==============================] - 0s 3ms/step - loss: 0.0428 - val_loss: 0.0271 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0956 21/102 [=====>........................] - ETA: 0s - loss: 0.0434 41/102 [===========>..................] - ETA: 0s - loss: 0.0427 62/102 [=================>............] - ETA: 0s - loss: 0.0407 82/102 [=======================>......] - ETA: 0s - loss: 0.0411102/102 [==============================] - 0s 3ms/step - loss: 0.0410 - val_loss: 0.0271 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0333 24/102 [======>.......................] - ETA: 0s - loss: 0.0423 45/102 [============>.................] - ETA: 0s - loss: 0.0427 67/102 [==================>...........] - ETA: 0s - loss: 0.0407 88/102 [========================>.....] - ETA: 0s - loss: 0.0401102/102 [==============================] - 0s 3ms/step - loss: 0.0398 - val_loss: 0.0273 - lr: 0.0010
Epoch 7/20
  1/102 [..............................] - ETA: 0s - loss: 0.0405 22/102 [=====>........................] - ETA: 0s - loss: 0.0393 41/102 [===========>..................] - ETA: 0s - loss: 0.0387 60/102 [================>.............] - ETA: 0s - loss: 0.0407 78/102 [=====================>........] - ETA: 0s - loss: 0.0414 98/102 [===========================>..] - ETA: 0s - loss: 0.0392102/102 [==============================] - 0s 3ms/step - loss: 0.0388 - val_loss: 0.0268 - lr: 5.0000e-04
Epoch 8/20
  1/102 [..............................] - ETA: 0s - loss: 0.0495 24/102 [======>.......................] - ETA: 0s - loss: 0.0417 45/102 [============>.................] - ETA: 0s - loss: 0.0400 66/102 [==================>...........] - ETA: 0s - loss: 0.0398 86/102 [========================>.....] - ETA: 0s - loss: 0.0389102/102 [==============================] - 0s 3ms/step - loss: 0.0382 - val_loss: 0.0264 - lr: 5.0000e-04
Epoch 9/20
  1/102 [..............................] - ETA: 0s - loss: 0.0108 21/102 [=====>........................] - ETA: 0s - loss: 0.0367 41/102 [===========>..................] - ETA: 0s - loss: 0.0390 60/102 [================>.............] - ETA: 0s - loss: 0.0395 80/102 [======================>.......] - ETA: 0s - loss: 0.0379100/102 [============================>.] - ETA: 0s - loss: 0.0376102/102 [==============================] - 0s 3ms/step - loss: 0.0376 - val_loss: 0.0262 - lr: 5.0000e-04
Epoch 10/20
  1/102 [..............................] - ETA: 0s - loss: 0.0378 22/102 [=====>........................] - ETA: 0s - loss: 0.0409 43/102 [===========>..................] - ETA: 0s - loss: 0.0383 63/102 [=================>............] - ETA: 0s - loss: 0.0400 83/102 [=======================>......] - ETA: 0s - loss: 0.0387102/102 [==============================] - 0s 3ms/step - loss: 0.0372 - val_loss: 0.0253 - lr: 5.0000e-04
Epoch 11/20
  1/102 [..............................] - ETA: 0s - loss: 0.0113 22/102 [=====>........................] - ETA: 0s - loss: 0.0327 43/102 [===========>..................] - ETA: 0s - loss: 0.0389 63/102 [=================>............] - ETA: 0s - loss: 0.0373 84/102 [=======================>......] - ETA: 0s - loss: 0.0367102/102 [==============================] - 0s 3ms/step - loss: 0.0366 - val_loss: 0.0259 - lr: 5.0000e-04
Epoch 12/20
  1/102 [..............................] - ETA: 0s - loss: 0.0120 22/102 [=====>........................] - ETA: 0s - loss: 0.0415 42/102 [===========>..................] - ETA: 0s - loss: 0.0350 62/102 [=================>............] - ETA: 0s - loss: 0.0360 82/102 [=======================>......] - ETA: 0s - loss: 0.0345102/102 [==============================] - ETA: 0s - loss: 0.0358102/102 [==============================] - 0s 3ms/step - loss: 0.0358 - val_loss: 0.0254 - lr: 5.0000e-04
Epoch 13/20
  1/102 [..............................] - ETA: 0s - loss: 0.0218 23/102 [=====>........................] - ETA: 0s - loss: 0.0325 40/102 [==========>...................] - ETA: 0s - loss: 0.0331 61/102 [================>.............] - ETA: 0s - loss: 0.0357 83/102 [=======================>......] - ETA: 0s - loss: 0.0356102/102 [==============================] - 0s 3ms/step - loss: 0.0355 - val_loss: 0.0249 - lr: 2.5000e-04
Epoch 14/20
  1/102 [..............................] - ETA: 0s - loss: 0.0156 23/102 [=====>........................] - ETA: 0s - loss: 0.0380 44/102 [===========>..................] - ETA: 0s - loss: 0.0369 65/102 [==================>...........] - ETA: 0s - loss: 0.0368 85/102 [========================>.....] - ETA: 0s - loss: 0.0357102/102 [==============================] - 0s 3ms/step - loss: 0.0349 - val_loss: 0.0248 - lr: 2.5000e-04
Epoch 15/20
  1/102 [..............................] - ETA: 0s - loss: 0.0179 23/102 [=====>........................] - ETA: 0s - loss: 0.0338 44/102 [===========>..................] - ETA: 0s - loss: 0.0312 64/102 [=================>............] - ETA: 0s - loss: 0.0340 84/102 [=======================>......] - ETA: 0s - loss: 0.0341102/102 [==============================] - 0s 3ms/step - loss: 0.0349 - val_loss: 0.0249 - lr: 2.5000e-04
Epoch 16/20
  1/102 [..............................] - ETA: 0s - loss: 0.0377 22/102 [=====>........................] - ETA: 0s - loss: 0.0396 42/102 [===========>..................] - ETA: 0s - loss: 0.0354 63/102 [=================>............] - ETA: 0s - loss: 0.0351 84/102 [=======================>......] - ETA: 0s - loss: 0.0350102/102 [==============================] - 0s 3ms/step - loss: 0.0345 - val_loss: 0.0246 - lr: 1.2500e-04
Epoch 17/20
  1/102 [..............................] - ETA: 0s - loss: 0.0207 22/102 [=====>........................] - ETA: 0s - loss: 0.0338 42/102 [===========>..................] - ETA: 0s - loss: 0.0325 62/102 [=================>............] - ETA: 0s - loss: 0.0350 82/102 [=======================>......] - ETA: 0s - loss: 0.0348101/102 [============================>.] - ETA: 0s - loss: 0.0344102/102 [==============================] - 0s 3ms/step - loss: 0.0344 - val_loss: 0.0247 - lr: 1.2500e-04
Epoch 18/20
  1/102 [..............................] - ETA: 0s - loss: 0.0488 22/102 [=====>........................] - ETA: 0s - loss: 0.0359 44/102 [===========>..................] - ETA: 0s - loss: 0.0362 65/102 [==================>...........] - ETA: 0s - loss: 0.0353 86/102 [========================>.....] - ETA: 0s - loss: 0.0354102/102 [==============================] - 0s 3ms/step - loss: 0.0344 - val_loss: 0.0245 - lr: 1.2500e-04
Epoch 19/20
  1/102 [..............................] - ETA: 0s - loss: 0.0682 23/102 [=====>........................] - ETA: 0s - loss: 0.0357 42/102 [===========>..................] - ETA: 0s - loss: 0.0344 63/102 [=================>............] - ETA: 0s - loss: 0.0343 84/102 [=======================>......] - ETA: 0s - loss: 0.0349102/102 [==============================] - 0s 3ms/step - loss: 0.0343 - val_loss: 0.0243 - lr: 6.2500e-05
Epoch 20/20
  1/102 [..............................] - ETA: 0s - loss: 0.0934 24/102 [======>.......................] - ETA: 0s - loss: 0.0394 44/102 [===========>..................] - ETA: 0s - loss: 0.0360 65/102 [==================>...........] - ETA: 0s - loss: 0.0338 84/102 [=======================>......] - ETA: 0s - loss: 0.0334102/102 [==============================] - 0s 3ms/step - loss: 0.0341 - val_loss: 0.0243 - lr: 6.2500e-05
 1/16 [>.............................] - ETA: 0s - loss: 0.049316/16 [==============================] - 0s 2ms/step - loss: 0.0614
Test Loss: 0.061397574841976166
Saved model as forecasting_models_v5/model_linear_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LINEAR model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 69ms/step
Predicted QoE for the next time step: -5546.138203573333
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/linear_basic.h5
Completed at Τετ 14 Μαΐ 2025 10:04:00 μμ EEST
=====================================================

=====================================================
Training linear model with config: with_l1_reg
Starting at Τετ 14 Μαΐ 2025 10:04:00 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type linear                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --l1_reg 0.01
2025-05-14 22:04:01.365828: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:04:01.527897: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:04:02.226276: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:04:02.226368: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:04:02.226380: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:04:09.318479: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:04:10.012860: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:04:10.012885: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:04:10.013063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5554 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 1)                 226       
                                                                 
=================================================================
Total params: 226
Trainable params: 226
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 1:24 - loss: 0.4292 24/102 [======>.......................] - ETA: 0s - loss: 0.3150   46/102 [============>.................] - ETA: 0s - loss: 0.2734 69/102 [===================>..........] - ETA: 0s - loss: 0.2514 90/102 [=========================>....] - ETA: 0s - loss: 0.2337102/102 [==============================] - 1s 4ms/step - loss: 0.2279 - val_loss: 0.1656 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.1740 22/102 [=====>........................] - ETA: 0s - loss: 0.1765 43/102 [===========>..................] - ETA: 0s - loss: 0.1684 64/102 [=================>............] - ETA: 0s - loss: 0.1626 84/102 [=======================>......] - ETA: 0s - loss: 0.1597102/102 [==============================] - 0s 3ms/step - loss: 0.1571 - val_loss: 0.1200 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.1254 21/102 [=====>........................] - ETA: 0s - loss: 0.1300 41/102 [===========>..................] - ETA: 0s - loss: 0.1267 59/102 [================>.............] - ETA: 0s - loss: 0.1265 80/102 [======================>.......] - ETA: 0s - loss: 0.1235100/102 [============================>.] - ETA: 0s - loss: 0.1202102/102 [==============================] - 0s 3ms/step - loss: 0.1198 - val_loss: 0.0897 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.1083 23/102 [=====>........................] - ETA: 0s - loss: 0.0952 46/102 [============>.................] - ETA: 0s - loss: 0.1013 69/102 [===================>..........] - ETA: 0s - loss: 0.1005 93/102 [==========================>...] - ETA: 0s - loss: 0.0969102/102 [==============================] - 0s 3ms/step - loss: 0.0959 - val_loss: 0.0746 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0919 21/102 [=====>........................] - ETA: 0s - loss: 0.0884 40/102 [==========>...................] - ETA: 0s - loss: 0.0854 60/102 [================>.............] - ETA: 0s - loss: 0.0859 80/102 [======================>.......] - ETA: 0s - loss: 0.0831 99/102 [============================>.] - ETA: 0s - loss: 0.0816102/102 [==============================] - 0s 3ms/step - loss: 0.0818 - val_loss: 0.0616 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0630 21/102 [=====>........................] - ETA: 0s - loss: 0.0739 43/102 [===========>..................] - ETA: 0s - loss: 0.0739 64/102 [=================>............] - ETA: 0s - loss: 0.0719 85/102 [========================>.....] - ETA: 0s - loss: 0.0723102/102 [==============================] - 0s 3ms/step - loss: 0.0722 - val_loss: 0.0534 - lr: 0.0010
Epoch 7/20
  1/102 [..............................] - ETA: 0s - loss: 0.0560 22/102 [=====>........................] - ETA: 0s - loss: 0.0672 38/102 [==========>...................] - ETA: 0s - loss: 0.0671 54/102 [==============>...............] - ETA: 0s - loss: 0.0649 76/102 [=====================>........] - ETA: 0s - loss: 0.0643 97/102 [===========================>..] - ETA: 0s - loss: 0.0648102/102 [==============================] - 0s 3ms/step - loss: 0.0648 - val_loss: 0.0472 - lr: 0.0010
Epoch 8/20
  1/102 [..............................] - ETA: 0s - loss: 0.0877 23/102 [=====>........................] - ETA: 0s - loss: 0.0655 42/102 [===========>..................] - ETA: 0s - loss: 0.0611 62/102 [=================>............] - ETA: 0s - loss: 0.0608 82/102 [=======================>......] - ETA: 0s - loss: 0.0593102/102 [==============================] - 0s 3ms/step - loss: 0.0605 - val_loss: 0.0426 - lr: 0.0010
Epoch 9/20
  1/102 [..............................] - ETA: 0s - loss: 0.0411 22/102 [=====>........................] - ETA: 0s - loss: 0.0597 42/102 [===========>..................] - ETA: 0s - loss: 0.0579 62/102 [=================>............] - ETA: 0s - loss: 0.0571 83/102 [=======================>......] - ETA: 0s - loss: 0.0555102/102 [==============================] - 0s 3ms/step - loss: 0.0563 - val_loss: 0.0387 - lr: 0.0010
Epoch 10/20
  1/102 [..............................] - ETA: 0s - loss: 0.0464 22/102 [=====>........................] - ETA: 0s - loss: 0.0505 41/102 [===========>..................] - ETA: 0s - loss: 0.0505 60/102 [================>.............] - ETA: 0s - loss: 0.0507 79/102 [======================>.......] - ETA: 0s - loss: 0.0529100/102 [============================>.] - ETA: 0s - loss: 0.0542102/102 [==============================] - 0s 3ms/step - loss: 0.0542 - val_loss: 0.0371 - lr: 0.0010
Epoch 11/20
  1/102 [..............................] - ETA: 0s - loss: 0.0851 22/102 [=====>........................] - ETA: 0s - loss: 0.0471 43/102 [===========>..................] - ETA: 0s - loss: 0.0505 66/102 [==================>...........] - ETA: 0s - loss: 0.0506 87/102 [========================>.....] - ETA: 0s - loss: 0.0513102/102 [==============================] - 0s 3ms/step - loss: 0.0522 - val_loss: 0.0356 - lr: 0.0010
Epoch 12/20
  1/102 [..............................] - ETA: 0s - loss: 0.0572 23/102 [=====>........................] - ETA: 0s - loss: 0.0540 44/102 [===========>..................] - ETA: 0s - loss: 0.0544 64/102 [=================>............] - ETA: 0s - loss: 0.0525 85/102 [========================>.....] - ETA: 0s - loss: 0.0518102/102 [==============================] - 0s 3ms/step - loss: 0.0506 - val_loss: 0.0355 - lr: 0.0010
Epoch 13/20
  1/102 [..............................] - ETA: 0s - loss: 0.0273 22/102 [=====>........................] - ETA: 0s - loss: 0.0478 42/102 [===========>..................] - ETA: 0s - loss: 0.0444 63/102 [=================>............] - ETA: 0s - loss: 0.0478 83/102 [=======================>......] - ETA: 0s - loss: 0.0487102/102 [==============================] - 0s 3ms/step - loss: 0.0503 - val_loss: 0.0366 - lr: 0.0010
Epoch 14/20
  1/102 [..............................] - ETA: 0s - loss: 0.0513 21/102 [=====>........................] - ETA: 0s - loss: 0.0523 40/102 [==========>...................] - ETA: 0s - loss: 0.0518 61/102 [================>.............] - ETA: 0s - loss: 0.0493 81/102 [======================>.......] - ETA: 0s - loss: 0.0498102/102 [==============================] - ETA: 0s - loss: 0.0498102/102 [==============================] - 0s 3ms/step - loss: 0.0498 - val_loss: 0.0349 - lr: 0.0010
Epoch 15/20
  1/102 [..............................] - ETA: 0s - loss: 0.0457 22/102 [=====>........................] - ETA: 0s - loss: 0.0438 42/102 [===========>..................] - ETA: 0s - loss: 0.0439 63/102 [=================>............] - ETA: 0s - loss: 0.0483 83/102 [=======================>......] - ETA: 0s - loss: 0.0488100/102 [============================>.] - ETA: 0s - loss: 0.0499102/102 [==============================] - 0s 3ms/step - loss: 0.0498 - val_loss: 0.0338 - lr: 0.0010
Epoch 16/20
  1/102 [..............................] - ETA: 0s - loss: 0.0408 21/102 [=====>........................] - ETA: 0s - loss: 0.0522 40/102 [==========>...................] - ETA: 0s - loss: 0.0502 61/102 [================>.............] - ETA: 0s - loss: 0.0491 83/102 [=======================>......] - ETA: 0s - loss: 0.0503102/102 [==============================] - 0s 3ms/step - loss: 0.0487 - val_loss: 0.0342 - lr: 0.0010
Epoch 17/20
  1/102 [..............................] - ETA: 0s - loss: 0.0401 22/102 [=====>........................] - ETA: 0s - loss: 0.0532 42/102 [===========>..................] - ETA: 0s - loss: 0.0476 63/102 [=================>............] - ETA: 0s - loss: 0.0459 84/102 [=======================>......] - ETA: 0s - loss: 0.0469102/102 [==============================] - 0s 3ms/step - loss: 0.0483 - val_loss: 0.0356 - lr: 0.0010
Epoch 18/20
  1/102 [..............................] - ETA: 0s - loss: 0.0440 23/102 [=====>........................] - ETA: 0s - loss: 0.0507 43/102 [===========>..................] - ETA: 0s - loss: 0.0496 62/102 [=================>............] - ETA: 0s - loss: 0.0490 81/102 [======================>.......] - ETA: 0s - loss: 0.0489100/102 [============================>.] - ETA: 0s - loss: 0.0474102/102 [==============================] - 0s 3ms/step - loss: 0.0478 - val_loss: 0.0320 - lr: 5.0000e-04
Epoch 19/20
  1/102 [..............................] - ETA: 0s - loss: 0.0463 24/102 [======>.......................] - ETA: 0s - loss: 0.0527 41/102 [===========>..................] - ETA: 0s - loss: 0.0494 63/102 [=================>............] - ETA: 0s - loss: 0.0476 84/102 [=======================>......] - ETA: 0s - loss: 0.0465102/102 [==============================] - 0s 3ms/step - loss: 0.0473 - val_loss: 0.0310 - lr: 5.0000e-04
Epoch 20/20
  1/102 [..............................] - ETA: 0s - loss: 0.0620 23/102 [=====>........................] - ETA: 0s - loss: 0.0425 45/102 [============>.................] - ETA: 0s - loss: 0.0491 65/102 [==================>...........] - ETA: 0s - loss: 0.0488 86/102 [========================>.....] - ETA: 0s - loss: 0.0478102/102 [==============================] - 0s 3ms/step - loss: 0.0466 - val_loss: 0.0331 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.068416/16 [==============================] - 0s 2ms/step - loss: 0.1399
Test Loss: 0.13987885415554047
Saved model as forecasting_models_v5/model_linear_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LINEAR model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 68ms/step
Predicted QoE for the next time step: 1326.9577295185775
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/linear_with_l1_reg.h5
Completed at Τετ 14 Μαΐ 2025 10:04:20 μμ EEST
=====================================================

=====================================================
Training linear model with config: with_l2_reg
Starting at Τετ 14 Μαΐ 2025 10:04:20 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type linear                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --l2_reg 0.01
2025-05-14 22:04:21.177827: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:04:21.346656: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:04:22.034838: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:04:22.034923: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:04:22.034934: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:04:28.924156: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:04:29.664800: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:04:29.664826: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:04:29.664955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5554 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 1)                 226       
                                                                 
=================================================================
Total params: 226
Trainable params: 226
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 1:15 - loss: 0.8191 24/102 [======>.......................] - ETA: 0s - loss: 0.2495   48/102 [=============>................] - ETA: 0s - loss: 0.1799 72/102 [====================>.........] - ETA: 0s - loss: 0.1465 94/102 [==========================>...] - ETA: 0s - loss: 0.1277102/102 [==============================] - 1s 4ms/step - loss: 0.1225 - val_loss: 0.0478 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.0553 22/102 [=====>........................] - ETA: 0s - loss: 0.0535 41/102 [===========>..................] - ETA: 0s - loss: 0.0592 60/102 [================>.............] - ETA: 0s - loss: 0.0594 80/102 [======================>.......] - ETA: 0s - loss: 0.0577 99/102 [============================>.] - ETA: 0s - loss: 0.0591102/102 [==============================] - 0s 3ms/step - loss: 0.0592 - val_loss: 0.0460 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.0425 19/102 [====>.........................] - ETA: 0s - loss: 0.0646 40/102 [==========>...................] - ETA: 0s - loss: 0.0582 60/102 [================>.............] - ETA: 0s - loss: 0.0589 79/102 [======================>.......] - ETA: 0s - loss: 0.0570 99/102 [============================>.] - ETA: 0s - loss: 0.0559102/102 [==============================] - 0s 3ms/step - loss: 0.0556 - val_loss: 0.0371 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0641 24/102 [======>.......................] - ETA: 0s - loss: 0.0477 45/102 [============>.................] - ETA: 0s - loss: 0.0523 65/102 [==================>...........] - ETA: 0s - loss: 0.0514 84/102 [=======================>......] - ETA: 0s - loss: 0.0495102/102 [==============================] - 0s 3ms/step - loss: 0.0506 - val_loss: 0.0355 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0272 20/102 [====>.........................] - ETA: 0s - loss: 0.0456 40/102 [==========>...................] - ETA: 0s - loss: 0.0467 60/102 [================>.............] - ETA: 0s - loss: 0.0480 81/102 [======================>.......] - ETA: 0s - loss: 0.0477100/102 [============================>.] - ETA: 0s - loss: 0.0470102/102 [==============================] - 0s 3ms/step - loss: 0.0474 - val_loss: 0.0335 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0523 20/102 [====>.........................] - ETA: 0s - loss: 0.0463 40/102 [==========>...................] - ETA: 0s - loss: 0.0462 60/102 [================>.............] - ETA: 0s - loss: 0.0461 81/102 [======================>.......] - ETA: 0s - loss: 0.0452102/102 [==============================] - ETA: 0s - loss: 0.0450102/102 [==============================] - 0s 3ms/step - loss: 0.0450 - val_loss: 0.0336 - lr: 0.0010
Epoch 7/20
  1/102 [..............................] - ETA: 0s - loss: 0.0399 22/102 [=====>........................] - ETA: 0s - loss: 0.0453 42/102 [===========>..................] - ETA: 0s - loss: 0.0441 62/102 [=================>............] - ETA: 0s - loss: 0.0431 82/102 [=======================>......] - ETA: 0s - loss: 0.0434102/102 [==============================] - ETA: 0s - loss: 0.0440102/102 [==============================] - 0s 3ms/step - loss: 0.0440 - val_loss: 0.0353 - lr: 0.0010
Epoch 8/20
  1/102 [..............................] - ETA: 0s - loss: 0.0386 21/102 [=====>........................] - ETA: 0s - loss: 0.0412 41/102 [===========>..................] - ETA: 0s - loss: 0.0408 62/102 [=================>............] - ETA: 0s - loss: 0.0426 82/102 [=======================>......] - ETA: 0s - loss: 0.0424102/102 [==============================] - ETA: 0s - loss: 0.0415102/102 [==============================] - 0s 3ms/step - loss: 0.0415 - val_loss: 0.0289 - lr: 5.0000e-04
Epoch 9/20
  1/102 [..............................] - ETA: 0s - loss: 0.0424 21/102 [=====>........................] - ETA: 0s - loss: 0.0380 40/102 [==========>...................] - ETA: 0s - loss: 0.0392 60/102 [================>.............] - ETA: 0s - loss: 0.0414 80/102 [======================>.......] - ETA: 0s - loss: 0.0409 99/102 [============================>.] - ETA: 0s - loss: 0.0401102/102 [==============================] - 0s 3ms/step - loss: 0.0406 - val_loss: 0.0281 - lr: 5.0000e-04
Epoch 10/20
  1/102 [..............................] - ETA: 0s - loss: 0.0284 24/102 [======>.......................] - ETA: 0s - loss: 0.0322 45/102 [============>.................] - ETA: 0s - loss: 0.0350 66/102 [==================>...........] - ETA: 0s - loss: 0.0384 86/102 [========================>.....] - ETA: 0s - loss: 0.0402102/102 [==============================] - 0s 3ms/step - loss: 0.0400 - val_loss: 0.0296 - lr: 5.0000e-04
Epoch 11/20
  1/102 [..............................] - ETA: 0s - loss: 0.0210 23/102 [=====>........................] - ETA: 0s - loss: 0.0393 46/102 [============>.................] - ETA: 0s - loss: 0.0411 69/102 [===================>..........] - ETA: 0s - loss: 0.0412 92/102 [==========================>...] - ETA: 0s - loss: 0.0400102/102 [==============================] - 0s 3ms/step - loss: 0.0397 - val_loss: 0.0274 - lr: 5.0000e-04
Epoch 12/20
  1/102 [..............................] - ETA: 0s - loss: 0.0308 24/102 [======>.......................] - ETA: 0s - loss: 0.0390 46/102 [============>.................] - ETA: 0s - loss: 0.0410 69/102 [===================>..........] - ETA: 0s - loss: 0.0401 92/102 [==========================>...] - ETA: 0s - loss: 0.0396102/102 [==============================] - 0s 3ms/step - loss: 0.0386 - val_loss: 0.0261 - lr: 5.0000e-04
Epoch 13/20
  1/102 [..............................] - ETA: 0s - loss: 0.0354 24/102 [======>.......................] - ETA: 0s - loss: 0.0380 47/102 [============>.................] - ETA: 0s - loss: 0.0400 62/102 [=================>............] - ETA: 0s - loss: 0.0407 72/102 [====================>.........] - ETA: 0s - loss: 0.0387 86/102 [========================>.....] - ETA: 0s - loss: 0.0388102/102 [==============================] - 0s 4ms/step - loss: 0.0387 - val_loss: 0.0264 - lr: 5.0000e-04
Epoch 14/20
  1/102 [..............................] - ETA: 0s - loss: 0.0687 22/102 [=====>........................] - ETA: 0s - loss: 0.0383 44/102 [===========>..................] - ETA: 0s - loss: 0.0368 65/102 [==================>...........] - ETA: 0s - loss: 0.0395 86/102 [========================>.....] - ETA: 0s - loss: 0.0386102/102 [==============================] - 0s 3ms/step - loss: 0.0384 - val_loss: 0.0256 - lr: 5.0000e-04
Epoch 15/20
  1/102 [..............................] - ETA: 0s - loss: 0.0275 21/102 [=====>........................] - ETA: 0s - loss: 0.0343 41/102 [===========>..................] - ETA: 0s - loss: 0.0369 61/102 [================>.............] - ETA: 0s - loss: 0.0370 83/102 [=======================>......] - ETA: 0s - loss: 0.0365102/102 [==============================] - 0s 3ms/step - loss: 0.0368 - val_loss: 0.0261 - lr: 5.0000e-04
Epoch 16/20
  1/102 [..............................] - ETA: 0s - loss: 0.0176 22/102 [=====>........................] - ETA: 0s - loss: 0.0382 44/102 [===========>..................] - ETA: 0s - loss: 0.0385 66/102 [==================>...........] - ETA: 0s - loss: 0.0371 88/102 [========================>.....] - ETA: 0s - loss: 0.0370102/102 [==============================] - 0s 3ms/step - loss: 0.0368 - val_loss: 0.0263 - lr: 5.0000e-04
Epoch 17/20
  1/102 [..............................] - ETA: 0s - loss: 0.0371 14/102 [===>..........................] - ETA: 0s - loss: 0.0325 32/102 [========>.....................] - ETA: 0s - loss: 0.0358 55/102 [===============>..............] - ETA: 0s - loss: 0.0365 78/102 [=====================>........] - ETA: 0s - loss: 0.0364101/102 [============================>.] - ETA: 0s - loss: 0.0362102/102 [==============================] - 0s 3ms/step - loss: 0.0361 - val_loss: 0.0251 - lr: 2.5000e-04
Epoch 18/20
  1/102 [..............................] - ETA: 0s - loss: 0.0390 25/102 [======>.......................] - ETA: 0s - loss: 0.0372 47/102 [============>.................] - ETA: 0s - loss: 0.0379 71/102 [===================>..........] - ETA: 0s - loss: 0.0362 95/102 [==========================>...] - ETA: 0s - loss: 0.0358102/102 [==============================] - 0s 3ms/step - loss: 0.0360 - val_loss: 0.0252 - lr: 2.5000e-04
Epoch 19/20
  1/102 [..............................] - ETA: 0s - loss: 0.0340 25/102 [======>.......................] - ETA: 0s - loss: 0.0325 48/102 [=============>................] - ETA: 0s - loss: 0.0342 72/102 [====================>.........] - ETA: 0s - loss: 0.0347 96/102 [===========================>..] - ETA: 0s - loss: 0.0351102/102 [==============================] - 0s 3ms/step - loss: 0.0356 - val_loss: 0.0269 - lr: 2.5000e-04
Epoch 20/20
  1/102 [..............................] - ETA: 0s - loss: 0.0472 25/102 [======>.......................] - ETA: 0s - loss: 0.0384 47/102 [============>.................] - ETA: 0s - loss: 0.0360 67/102 [==================>...........] - ETA: 0s - loss: 0.0350 89/102 [=========================>....] - ETA: 0s - loss: 0.0349102/102 [==============================] - 0s 3ms/step - loss: 0.0353 - val_loss: 0.0262 - lr: 1.2500e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.051616/16 [==============================] - 0s 2ms/step - loss: 0.0612
Test Loss: 0.061209600418806076
Saved model as forecasting_models_v5/model_linear_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LINEAR model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 73ms/step
Predicted QoE for the next time step: 22058.69261501413
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/linear_with_l2_reg.h5
Completed at Τετ 14 Μαΐ 2025 10:04:40 μμ EEST
=====================================================

=====================================================
Training linear model with config: with_elastic_net
Starting at Τετ 14 Μαΐ 2025 10:04:40 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type linear                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --l1_reg 0.005 --l2_reg 0.005
2025-05-14 22:04:40.669540: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:04:40.845323: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:04:41.525729: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:04:41.525868: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:04:41.525887: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:04:48.414631: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:04:49.132874: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:04:49.132900: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:04:49.133047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5554 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 1)                 226       
                                                                 
=================================================================
Total params: 226
Trainable params: 226
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 1:21 - loss: 0.4865 25/102 [======>.......................] - ETA: 0s - loss: 0.2614   47/102 [============>.................] - ETA: 0s - loss: 0.2132 67/102 [==================>...........] - ETA: 0s - loss: 0.1923 89/102 [=========================>....] - ETA: 0s - loss: 0.1782102/102 [==============================] - 1s 5ms/step - loss: 0.1722 - val_loss: 0.1055 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.1108 21/102 [=====>........................] - ETA: 0s - loss: 0.1188 43/102 [===========>..................] - ETA: 0s - loss: 0.1142 65/102 [==================>...........] - ETA: 0s - loss: 0.1119 85/102 [========================>.....] - ETA: 0s - loss: 0.1113102/102 [==============================] - 0s 3ms/step - loss: 0.1122 - val_loss: 0.0943 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.1217 20/102 [====>.........................] - ETA: 0s - loss: 0.0977 40/102 [==========>...................] - ETA: 0s - loss: 0.0975 59/102 [================>.............] - ETA: 0s - loss: 0.0964 78/102 [=====================>........] - ETA: 0s - loss: 0.0962 98/102 [===========================>..] - ETA: 0s - loss: 0.0960102/102 [==============================] - 0s 3ms/step - loss: 0.0954 - val_loss: 0.0740 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0953 21/102 [=====>........................] - ETA: 0s - loss: 0.0873 41/102 [===========>..................] - ETA: 0s - loss: 0.0868 60/102 [================>.............] - ETA: 0s - loss: 0.0851 79/102 [======================>.......] - ETA: 0s - loss: 0.0864 97/102 [===========================>..] - ETA: 0s - loss: 0.0849102/102 [==============================] - 0s 3ms/step - loss: 0.0838 - val_loss: 0.0647 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0645 22/102 [=====>........................] - ETA: 0s - loss: 0.0779 41/102 [===========>..................] - ETA: 0s - loss: 0.0809 61/102 [================>.............] - ETA: 0s - loss: 0.0779 84/102 [=======================>......] - ETA: 0s - loss: 0.0747102/102 [==============================] - 0s 3ms/step - loss: 0.0741 - val_loss: 0.0563 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0678 21/102 [=====>........................] - ETA: 0s - loss: 0.0639 41/102 [===========>..................] - ETA: 0s - loss: 0.0693 61/102 [================>.............] - ETA: 0s - loss: 0.0691 81/102 [======================>.......] - ETA: 0s - loss: 0.0695101/102 [============================>.] - ETA: 0s - loss: 0.0681102/102 [==============================] - 0s 3ms/step - loss: 0.0681 - val_loss: 0.0537 - lr: 0.0010
Epoch 7/20
  1/102 [..............................] - ETA: 0s - loss: 0.0562 22/102 [=====>........................] - ETA: 0s - loss: 0.0644 44/102 [===========>..................] - ETA: 0s - loss: 0.0643 65/102 [==================>...........] - ETA: 0s - loss: 0.0653 86/102 [========================>.....] - ETA: 0s - loss: 0.0641102/102 [==============================] - 0s 3ms/step - loss: 0.0640 - val_loss: 0.0506 - lr: 0.0010
Epoch 8/20
  1/102 [..............................] - ETA: 0s - loss: 0.0543 22/102 [=====>........................] - ETA: 0s - loss: 0.0627 42/102 [===========>..................] - ETA: 0s - loss: 0.0590 63/102 [=================>............] - ETA: 0s - loss: 0.0586 83/102 [=======================>......] - ETA: 0s - loss: 0.0594102/102 [==============================] - 0s 3ms/step - loss: 0.0591 - val_loss: 0.0448 - lr: 0.0010
Epoch 9/20
  1/102 [..............................] - ETA: 0s - loss: 0.0406 21/102 [=====>........................] - ETA: 0s - loss: 0.0530 41/102 [===========>..................] - ETA: 0s - loss: 0.0555 61/102 [================>.............] - ETA: 0s - loss: 0.0566 81/102 [======================>.......] - ETA: 0s - loss: 0.0570101/102 [============================>.] - ETA: 0s - loss: 0.0559102/102 [==============================] - 0s 3ms/step - loss: 0.0559 - val_loss: 0.0404 - lr: 0.0010
Epoch 10/20
  1/102 [..............................] - ETA: 0s - loss: 0.0328 16/102 [===>..........................] - ETA: 0s - loss: 0.0506 37/102 [=========>....................] - ETA: 0s - loss: 0.0534 58/102 [================>.............] - ETA: 0s - loss: 0.0559 78/102 [=====================>........] - ETA: 0s - loss: 0.0552100/102 [============================>.] - ETA: 0s - loss: 0.0551102/102 [==============================] - 0s 3ms/step - loss: 0.0548 - val_loss: 0.0368 - lr: 0.0010
Epoch 11/20
  1/102 [..............................] - ETA: 0s - loss: 0.0500 21/102 [=====>........................] - ETA: 0s - loss: 0.0500 42/102 [===========>..................] - ETA: 0s - loss: 0.0504 62/102 [=================>............] - ETA: 0s - loss: 0.0492 83/102 [=======================>......] - ETA: 0s - loss: 0.0506102/102 [==============================] - 0s 3ms/step - loss: 0.0501 - val_loss: 0.0381 - lr: 0.0010
Epoch 12/20
  1/102 [..............................] - ETA: 0s - loss: 0.0217 21/102 [=====>........................] - ETA: 0s - loss: 0.0526 42/102 [===========>..................] - ETA: 0s - loss: 0.0480 64/102 [=================>............] - ETA: 0s - loss: 0.0488 84/102 [=======================>......] - ETA: 0s - loss: 0.0483102/102 [==============================] - 0s 3ms/step - loss: 0.0483 - val_loss: 0.0335 - lr: 0.0010
Epoch 13/20
  1/102 [..............................] - ETA: 0s - loss: 0.0536 22/102 [=====>........................] - ETA: 0s - loss: 0.0522 42/102 [===========>..................] - ETA: 0s - loss: 0.0494 62/102 [=================>............] - ETA: 0s - loss: 0.0473 83/102 [=======================>......] - ETA: 0s - loss: 0.0475102/102 [==============================] - 0s 3ms/step - loss: 0.0472 - val_loss: 0.0321 - lr: 0.0010
Epoch 14/20
  1/102 [..............................] - ETA: 0s - loss: 0.0545 22/102 [=====>........................] - ETA: 0s - loss: 0.0396 42/102 [===========>..................] - ETA: 0s - loss: 0.0433 62/102 [=================>............] - ETA: 0s - loss: 0.0443 82/102 [=======================>......] - ETA: 0s - loss: 0.0448102/102 [==============================] - ETA: 0s - loss: 0.0464102/102 [==============================] - 0s 3ms/step - loss: 0.0464 - val_loss: 0.0307 - lr: 0.0010
Epoch 15/20
  1/102 [..............................] - ETA: 0s - loss: 0.0301 22/102 [=====>........................] - ETA: 0s - loss: 0.0476 42/102 [===========>..................] - ETA: 0s - loss: 0.0440 62/102 [=================>............] - ETA: 0s - loss: 0.0447 83/102 [=======================>......] - ETA: 0s - loss: 0.0440102/102 [==============================] - 0s 3ms/step - loss: 0.0443 - val_loss: 0.0299 - lr: 0.0010
Epoch 16/20
  1/102 [..............................] - ETA: 0s - loss: 0.0241 20/102 [====>.........................] - ETA: 0s - loss: 0.0449 40/102 [==========>...................] - ETA: 0s - loss: 0.0429 60/102 [================>.............] - ETA: 0s - loss: 0.0427 81/102 [======================>.......] - ETA: 0s - loss: 0.0442102/102 [==============================] - ETA: 0s - loss: 0.0439102/102 [==============================] - 0s 3ms/step - loss: 0.0439 - val_loss: 0.0297 - lr: 0.0010
Epoch 17/20
  1/102 [..............................] - ETA: 0s - loss: 0.0620 21/102 [=====>........................] - ETA: 0s - loss: 0.0412 40/102 [==========>...................] - ETA: 0s - loss: 0.0421 60/102 [================>.............] - ETA: 0s - loss: 0.0435 82/102 [=======================>......] - ETA: 0s - loss: 0.0432102/102 [==============================] - 0s 3ms/step - loss: 0.0433 - val_loss: 0.0299 - lr: 0.0010
Epoch 18/20
  1/102 [..............................] - ETA: 0s - loss: 0.0284 22/102 [=====>........................] - ETA: 0s - loss: 0.0455 43/102 [===========>..................] - ETA: 0s - loss: 0.0422 62/102 [=================>............] - ETA: 0s - loss: 0.0433 82/102 [=======================>......] - ETA: 0s - loss: 0.0442102/102 [==============================] - 0s 3ms/step - loss: 0.0435 - val_loss: 0.0274 - lr: 0.0010
Epoch 19/20
  1/102 [..............................] - ETA: 0s - loss: 0.0875 22/102 [=====>........................] - ETA: 0s - loss: 0.0404 43/102 [===========>..................] - ETA: 0s - loss: 0.0400 64/102 [=================>............] - ETA: 0s - loss: 0.0407 85/102 [========================>.....] - ETA: 0s - loss: 0.0417102/102 [==============================] - 0s 3ms/step - loss: 0.0420 - val_loss: 0.0283 - lr: 0.0010
Epoch 20/20
  1/102 [..............................] - ETA: 0s - loss: 0.0657 21/102 [=====>........................] - ETA: 0s - loss: 0.0335 42/102 [===========>..................] - ETA: 0s - loss: 0.0420 61/102 [================>.............] - ETA: 0s - loss: 0.0430 82/102 [=======================>......] - ETA: 0s - loss: 0.0439102/102 [==============================] - ETA: 0s - loss: 0.0434102/102 [==============================] - 0s 3ms/step - loss: 0.0434 - val_loss: 0.0272 - lr: 0.0010
 1/16 [>.............................] - ETA: 0s - loss: 0.054616/16 [==============================] - 0s 2ms/step - loss: 0.1016
Test Loss: 0.1015729308128357
Saved model as forecasting_models_v5/model_linear_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LINEAR model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 69ms/step
Predicted QoE for the next time step: 1784.1013638926695
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/linear_with_elastic_net.h5
Completed at Τετ 14 Μαΐ 2025 10:04:59 μμ EEST
=====================================================

=====================================================
Training dnn model with config: basic
Starting at Τετ 14 Μαΐ 2025 10:04:59 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type dnn                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 
2025-05-14 22:05:00.306088: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:05:00.468219: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:05:01.107841: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:05:01.107932: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:05:01.107942: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:05:08.063505: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:05:08.789814: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:05:08.789851: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:05:08.790008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5566 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 64)                14464     
                                                                 
 dropout (Dropout)           (None, 64)                0         
                                                                 
 dense_1 (Dense)             (None, 32)                2080      
                                                                 
 dropout_1 (Dropout)         (None, 32)                0         
                                                                 
 dense_2 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 16,577
Trainable params: 16,577
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 1:34 - loss: 0.3147 16/102 [===>..........................] - ETA: 0s - loss: 0.1910   32/102 [========>.....................] - ETA: 0s - loss: 0.1513 47/102 [============>.................] - ETA: 0s - loss: 0.1356 62/102 [=================>............] - ETA: 0s - loss: 0.1224 76/102 [=====================>........] - ETA: 0s - loss: 0.1124 91/102 [=========================>....] - ETA: 0s - loss: 0.1061102/102 [==============================] - 2s 6ms/step - loss: 0.1025 - val_loss: 0.0319 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.0463 17/102 [====>.........................] - ETA: 0s - loss: 0.0644 33/102 [========>.....................] - ETA: 0s - loss: 0.0624 48/102 [=============>................] - ETA: 0s - loss: 0.0611 62/102 [=================>............] - ETA: 0s - loss: 0.0614 76/102 [=====================>........] - ETA: 0s - loss: 0.0592 90/102 [=========================>....] - ETA: 0s - loss: 0.0607102/102 [==============================] - 0s 4ms/step - loss: 0.0608 - val_loss: 0.0234 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.0421 12/102 [==>...........................] - ETA: 0s - loss: 0.0527 28/102 [=======>......................] - ETA: 0s - loss: 0.0492 44/102 [===========>..................] - ETA: 0s - loss: 0.0508 59/102 [================>.............] - ETA: 0s - loss: 0.0489 73/102 [====================>.........] - ETA: 0s - loss: 0.0477 86/102 [========================>.....] - ETA: 0s - loss: 0.0475100/102 [============================>.] - ETA: 0s - loss: 0.0459102/102 [==============================] - 0s 4ms/step - loss: 0.0458 - val_loss: 0.0099 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0392 15/102 [===>..........................] - ETA: 0s - loss: 0.0367 30/102 [=======>......................] - ETA: 0s - loss: 0.0351 46/102 [============>.................] - ETA: 0s - loss: 0.0342 61/102 [================>.............] - ETA: 0s - loss: 0.0338 76/102 [=====================>........] - ETA: 0s - loss: 0.0345 91/102 [=========================>....] - ETA: 0s - loss: 0.0333102/102 [==============================] - 0s 4ms/step - loss: 0.0333 - val_loss: 0.0195 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0242 16/102 [===>..........................] - ETA: 0s - loss: 0.0342 30/102 [=======>......................] - ETA: 0s - loss: 0.0337 44/102 [===========>..................] - ETA: 0s - loss: 0.0321 58/102 [================>.............] - ETA: 0s - loss: 0.0322 75/102 [=====================>........] - ETA: 0s - loss: 0.0331 90/102 [=========================>....] - ETA: 0s - loss: 0.0333102/102 [==============================] - 0s 4ms/step - loss: 0.0322 - val_loss: 0.0092 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0206 15/102 [===>..........................] - ETA: 0s - loss: 0.0287 30/102 [=======>......................] - ETA: 0s - loss: 0.0269 44/102 [===========>..................] - ETA: 0s - loss: 0.0266 58/102 [================>.............] - ETA: 0s - loss: 0.0257 72/102 [====================>.........] - ETA: 0s - loss: 0.0271 86/102 [========================>.....] - ETA: 0s - loss: 0.0277101/102 [============================>.] - ETA: 0s - loss: 0.0277102/102 [==============================] - 0s 4ms/step - loss: 0.0277 - val_loss: 0.0100 - lr: 0.0010
Epoch 7/20
  1/102 [..............................] - ETA: 0s - loss: 0.0523 18/102 [====>.........................] - ETA: 0s - loss: 0.0251 34/102 [=========>....................] - ETA: 0s - loss: 0.0270 49/102 [=============>................] - ETA: 0s - loss: 0.0261 63/102 [=================>............] - ETA: 0s - loss: 0.0256 77/102 [=====================>........] - ETA: 0s - loss: 0.0258 91/102 [=========================>....] - ETA: 0s - loss: 0.0255102/102 [==============================] - 0s 4ms/step - loss: 0.0258 - val_loss: 0.0098 - lr: 0.0010
Epoch 8/20
  1/102 [..............................] - ETA: 0s - loss: 0.0296 16/102 [===>..........................] - ETA: 0s - loss: 0.0254 32/102 [========>.....................] - ETA: 0s - loss: 0.0253 46/102 [============>.................] - ETA: 0s - loss: 0.0266 60/102 [================>.............] - ETA: 0s - loss: 0.0253 76/102 [=====================>........] - ETA: 0s - loss: 0.0260 91/102 [=========================>....] - ETA: 0s - loss: 0.0261102/102 [==============================] - 0s 4ms/step - loss: 0.0257 - val_loss: 0.0084 - lr: 5.0000e-04
Epoch 9/20
  1/102 [..............................] - ETA: 0s - loss: 0.0281 16/102 [===>..........................] - ETA: 0s - loss: 0.0270 30/102 [=======>......................] - ETA: 0s - loss: 0.0240 44/102 [===========>..................] - ETA: 0s - loss: 0.0230 60/102 [================>.............] - ETA: 0s - loss: 0.0233 74/102 [====================>.........] - ETA: 0s - loss: 0.0245 89/102 [=========================>....] - ETA: 0s - loss: 0.0251102/102 [==============================] - ETA: 0s - loss: 0.0259102/102 [==============================] - 0s 4ms/step - loss: 0.0259 - val_loss: 0.0090 - lr: 5.0000e-04
Epoch 10/20
  1/102 [..............................] - ETA: 0s - loss: 0.0155 16/102 [===>..........................] - ETA: 0s - loss: 0.0204 31/102 [========>.....................] - ETA: 0s - loss: 0.0226 45/102 [============>.................] - ETA: 0s - loss: 0.0239 59/102 [================>.............] - ETA: 0s - loss: 0.0241 73/102 [====================>.........] - ETA: 0s - loss: 0.0247 88/102 [========================>.....] - ETA: 0s - loss: 0.0250102/102 [==============================] - ETA: 0s - loss: 0.0247102/102 [==============================] - 0s 4ms/step - loss: 0.0247 - val_loss: 0.0097 - lr: 5.0000e-04
Epoch 11/20
  1/102 [..............................] - ETA: 0s - loss: 0.0446 18/102 [====>.........................] - ETA: 0s - loss: 0.0266 34/102 [=========>....................] - ETA: 0s - loss: 0.0245 49/102 [=============>................] - ETA: 0s - loss: 0.0261 66/102 [==================>...........] - ETA: 0s - loss: 0.0248 81/102 [======================>.......] - ETA: 0s - loss: 0.0237 95/102 [==========================>...] - ETA: 0s - loss: 0.0239102/102 [==============================] - 0s 4ms/step - loss: 0.0241 - val_loss: 0.0087 - lr: 2.5000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.017116/16 [==============================] - 0s 2ms/step - loss: 0.0288
Test Loss: 0.028840752318501472
Saved model as forecasting_models_v5/model_dnn_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for DNN model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 82ms/step
Predicted QoE for the next time step: 7808.720994832969
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/dnn_basic.h5
Completed at Τετ 14 Μαΐ 2025 10:05:17 μμ EEST
=====================================================

=====================================================
Training dnn model with config: deep
Starting at Τετ 14 Μαΐ 2025 10:05:17 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type dnn                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --hidden_layers 128,64,32
2025-05-14 22:05:18.390465: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:05:18.559860: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:05:19.255490: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:05:19.255576: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:05:19.255586: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:05:26.242117: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:05:26.960678: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:05:26.960705: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:05:26.960875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5566 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 64)                14464     
                                                                 
 dropout (Dropout)           (None, 64)                0         
                                                                 
 dense_1 (Dense)             (None, 32)                2080      
                                                                 
 dropout_1 (Dropout)         (None, 32)                0         
                                                                 
 dense_2 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 16,577
Trainable params: 16,577
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 1:36 - loss: 0.4593 18/102 [====>.........................] - ETA: 0s - loss: 0.2215   36/102 [=========>....................] - ETA: 0s - loss: 0.1711 53/102 [==============>...............] - ETA: 0s - loss: 0.1500 68/102 [===================>..........] - ETA: 0s - loss: 0.1357 82/102 [=======================>......] - ETA: 0s - loss: 0.1277 97/102 [===========================>..] - ETA: 0s - loss: 0.1205102/102 [==============================] - 2s 6ms/step - loss: 0.1185 - val_loss: 0.0284 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.0608 13/102 [==>...........................] - ETA: 0s - loss: 0.0815 29/102 [=======>......................] - ETA: 0s - loss: 0.0747 44/102 [===========>..................] - ETA: 0s - loss: 0.0712 58/102 [================>.............] - ETA: 0s - loss: 0.0667 72/102 [====================>.........] - ETA: 0s - loss: 0.0659 87/102 [========================>.....] - ETA: 0s - loss: 0.0663102/102 [==============================] - 0s 4ms/step - loss: 0.0647 - val_loss: 0.0288 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.0445 16/102 [===>..........................] - ETA: 0s - loss: 0.0475 30/102 [=======>......................] - ETA: 0s - loss: 0.0482 44/102 [===========>..................] - ETA: 0s - loss: 0.0491 57/102 [===============>..............] - ETA: 0s - loss: 0.0495 71/102 [===================>..........] - ETA: 0s - loss: 0.0499 86/102 [========================>.....] - ETA: 0s - loss: 0.0490101/102 [============================>.] - ETA: 0s - loss: 0.0489102/102 [==============================] - 0s 4ms/step - loss: 0.0490 - val_loss: 0.0156 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0347 16/102 [===>..........................] - ETA: 0s - loss: 0.0387 29/102 [=======>......................] - ETA: 0s - loss: 0.0393 43/102 [===========>..................] - ETA: 0s - loss: 0.0381 58/102 [================>.............] - ETA: 0s - loss: 0.0377 72/102 [====================>.........] - ETA: 0s - loss: 0.0391 86/102 [========================>.....] - ETA: 0s - loss: 0.0392100/102 [============================>.] - ETA: 0s - loss: 0.0385102/102 [==============================] - 0s 4ms/step - loss: 0.0386 - val_loss: 0.0142 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0475 15/102 [===>..........................] - ETA: 0s - loss: 0.0363 30/102 [=======>......................] - ETA: 0s - loss: 0.0361 45/102 [============>.................] - ETA: 0s - loss: 0.0357 60/102 [================>.............] - ETA: 0s - loss: 0.0340 74/102 [====================>.........] - ETA: 0s - loss: 0.0334 89/102 [=========================>....] - ETA: 0s - loss: 0.0330102/102 [==============================] - 0s 4ms/step - loss: 0.0323 - val_loss: 0.0105 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0348 15/102 [===>..........................] - ETA: 0s - loss: 0.0283 29/102 [=======>......................] - ETA: 0s - loss: 0.0256 43/102 [===========>..................] - ETA: 0s - loss: 0.0263 57/102 [===============>..............] - ETA: 0s - loss: 0.0273 72/102 [====================>.........] - ETA: 0s - loss: 0.0274 87/102 [========================>.....] - ETA: 0s - loss: 0.0268102/102 [==============================] - ETA: 0s - loss: 0.0265102/102 [==============================] - 0s 4ms/step - loss: 0.0265 - val_loss: 0.0083 - lr: 0.0010
Epoch 7/20
  1/102 [..............................] - ETA: 0s - loss: 0.0177 16/102 [===>..........................] - ETA: 0s - loss: 0.0290 30/102 [=======>......................] - ETA: 0s - loss: 0.0267 44/102 [===========>..................] - ETA: 0s - loss: 0.0261 58/102 [================>.............] - ETA: 0s - loss: 0.0260 73/102 [====================>.........] - ETA: 0s - loss: 0.0263 87/102 [========================>.....] - ETA: 0s - loss: 0.0262102/102 [==============================] - 0s 4ms/step - loss: 0.0260 - val_loss: 0.0081 - lr: 0.0010
Epoch 8/20
  1/102 [..............................] - ETA: 0s - loss: 0.0177 15/102 [===>..........................] - ETA: 0s - loss: 0.0258 29/102 [=======>......................] - ETA: 0s - loss: 0.0247 44/102 [===========>..................] - ETA: 0s - loss: 0.0249 59/102 [================>.............] - ETA: 0s - loss: 0.0254 73/102 [====================>.........] - ETA: 0s - loss: 0.0253 87/102 [========================>.....] - ETA: 0s - loss: 0.0256101/102 [============================>.] - ETA: 0s - loss: 0.0249102/102 [==============================] - 0s 4ms/step - loss: 0.0249 - val_loss: 0.0094 - lr: 0.0010
Epoch 9/20
  1/102 [..............................] - ETA: 0s - loss: 0.0400 16/102 [===>..........................] - ETA: 0s - loss: 0.0250 32/102 [========>.....................] - ETA: 0s - loss: 0.0239 47/102 [============>.................] - ETA: 0s - loss: 0.0219 61/102 [================>.............] - ETA: 0s - loss: 0.0220 75/102 [=====================>........] - ETA: 0s - loss: 0.0222 90/102 [=========================>....] - ETA: 0s - loss: 0.0223102/102 [==============================] - 0s 4ms/step - loss: 0.0233 - val_loss: 0.0082 - lr: 0.0010
Epoch 10/20
  1/102 [..............................] - ETA: 0s - loss: 0.0265 16/102 [===>..........................] - ETA: 0s - loss: 0.0223 31/102 [========>.....................] - ETA: 0s - loss: 0.0213 47/102 [============>.................] - ETA: 0s - loss: 0.0215 63/102 [=================>............] - ETA: 0s - loss: 0.0216 78/102 [=====================>........] - ETA: 0s - loss: 0.0221 92/102 [==========================>...] - ETA: 0s - loss: 0.0223102/102 [==============================] - 0s 4ms/step - loss: 0.0225 - val_loss: 0.0083 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.017616/16 [==============================] - 0s 2ms/step - loss: 0.0322
Test Loss: 0.03217773512005806
Saved model as forecasting_models_v5/model_dnn_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for DNN model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 81ms/step
Predicted QoE for the next time step: 31224.425038929017
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/dnn_deep.h5
Completed at Τετ 14 Μαΐ 2025 10:05:35 μμ EEST
=====================================================

=====================================================
Training dnn model with config: with_elu
Starting at Τετ 14 Μαΐ 2025 10:05:35 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type dnn                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --activation elu
2025-05-14 22:05:36.157638: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:05:36.334404: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:05:37.041964: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:05:37.042057: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:05:37.042068: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:05:44.153181: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:05:44.893009: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:05:44.893038: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:05:44.893186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5567 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 64)                14464     
                                                                 
 dropout (Dropout)           (None, 64)                0         
                                                                 
 dense_1 (Dense)             (None, 32)                2080      
                                                                 
 dropout_1 (Dropout)         (None, 32)                0         
                                                                 
 dense_2 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 16,577
Trainable params: 16,577
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 1:40 - loss: 0.3184 17/102 [====>.........................] - ETA: 0s - loss: 0.2938   35/102 [=========>....................] - ETA: 0s - loss: 0.2469 52/102 [==============>...............] - ETA: 0s - loss: 0.2192 68/102 [===================>..........] - ETA: 0s - loss: 0.2038 83/102 [=======================>......] - ETA: 0s - loss: 0.1874 98/102 [===========================>..] - ETA: 0s - loss: 0.1749102/102 [==============================] - 2s 6ms/step - loss: 0.1721 - val_loss: 0.0177 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.0474 13/102 [==>...........................] - ETA: 0s - loss: 0.0996 29/102 [=======>......................] - ETA: 0s - loss: 0.0966 46/102 [============>.................] - ETA: 0s - loss: 0.0982 61/102 [================>.............] - ETA: 0s - loss: 0.0958 75/102 [=====================>........] - ETA: 0s - loss: 0.0945 90/102 [=========================>....] - ETA: 0s - loss: 0.0915102/102 [==============================] - 0s 4ms/step - loss: 0.0887 - val_loss: 0.0124 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.1020 17/102 [====>.........................] - ETA: 0s - loss: 0.0837 32/102 [========>.....................] - ETA: 0s - loss: 0.0796 46/102 [============>.................] - ETA: 0s - loss: 0.0797 60/102 [================>.............] - ETA: 0s - loss: 0.0770 76/102 [=====================>........] - ETA: 0s - loss: 0.0778 91/102 [=========================>....] - ETA: 0s - loss: 0.0761102/102 [==============================] - 0s 4ms/step - loss: 0.0737 - val_loss: 0.0112 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0403 16/102 [===>..........................] - ETA: 0s - loss: 0.0657 32/102 [========>.....................] - ETA: 0s - loss: 0.0575 48/102 [=============>................] - ETA: 0s - loss: 0.0552 63/102 [=================>............] - ETA: 0s - loss: 0.0538 77/102 [=====================>........] - ETA: 0s - loss: 0.0535 91/102 [=========================>....] - ETA: 0s - loss: 0.0525102/102 [==============================] - 0s 4ms/step - loss: 0.0525 - val_loss: 0.0124 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0433 16/102 [===>..........................] - ETA: 0s - loss: 0.0509 30/102 [=======>......................] - ETA: 0s - loss: 0.0495 45/102 [============>.................] - ETA: 0s - loss: 0.0494 55/102 [===============>..............] - ETA: 0s - loss: 0.0481 73/102 [====================>.........] - ETA: 0s - loss: 0.0484 89/102 [=========================>....] - ETA: 0s - loss: 0.0467102/102 [==============================] - 0s 4ms/step - loss: 0.0469 - val_loss: 0.0096 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0405 16/102 [===>..........................] - ETA: 0s - loss: 0.0432 31/102 [========>.....................] - ETA: 0s - loss: 0.0402 46/102 [============>.................] - ETA: 0s - loss: 0.0401 61/102 [================>.............] - ETA: 0s - loss: 0.0386 75/102 [=====================>........] - ETA: 0s - loss: 0.0387 89/102 [=========================>....] - ETA: 0s - loss: 0.0382102/102 [==============================] - 0s 4ms/step - loss: 0.0383 - val_loss: 0.0138 - lr: 0.0010
Epoch 7/20
  1/102 [..............................] - ETA: 0s - loss: 0.0336 15/102 [===>..........................] - ETA: 0s - loss: 0.0345 29/102 [=======>......................] - ETA: 0s - loss: 0.0324 44/102 [===========>..................] - ETA: 0s - loss: 0.0332 59/102 [================>.............] - ETA: 0s - loss: 0.0346 73/102 [====================>.........] - ETA: 0s - loss: 0.0343 88/102 [========================>.....] - ETA: 0s - loss: 0.0331102/102 [==============================] - ETA: 0s - loss: 0.0335102/102 [==============================] - 0s 4ms/step - loss: 0.0335 - val_loss: 0.0118 - lr: 0.0010
Epoch 8/20
  1/102 [..............................] - ETA: 0s - loss: 0.0450 16/102 [===>..........................] - ETA: 0s - loss: 0.0357 32/102 [========>.....................] - ETA: 0s - loss: 0.0329 46/102 [============>.................] - ETA: 0s - loss: 0.0331 60/102 [================>.............] - ETA: 0s - loss: 0.0319 75/102 [=====================>........] - ETA: 0s - loss: 0.0320 90/102 [=========================>....] - ETA: 0s - loss: 0.0316102/102 [==============================] - 0s 4ms/step - loss: 0.0316 - val_loss: 0.0094 - lr: 5.0000e-04
Epoch 9/20
  1/102 [..............................] - ETA: 0s - loss: 0.0613 17/102 [====>.........................] - ETA: 0s - loss: 0.0299 32/102 [========>.....................] - ETA: 0s - loss: 0.0304 47/102 [============>.................] - ETA: 0s - loss: 0.0303 63/102 [=================>............] - ETA: 0s - loss: 0.0297 78/102 [=====================>........] - ETA: 0s - loss: 0.0298 92/102 [==========================>...] - ETA: 0s - loss: 0.0295102/102 [==============================] - 0s 4ms/step - loss: 0.0296 - val_loss: 0.0131 - lr: 5.0000e-04
Epoch 10/20
  1/102 [..............................] - ETA: 0s - loss: 0.0268 15/102 [===>..........................] - ETA: 0s - loss: 0.0259 29/102 [=======>......................] - ETA: 0s - loss: 0.0290 44/102 [===========>..................] - ETA: 0s - loss: 0.0297 61/102 [================>.............] - ETA: 0s - loss: 0.0283 76/102 [=====================>........] - ETA: 0s - loss: 0.0287 92/102 [==========================>...] - ETA: 0s - loss: 0.0284102/102 [==============================] - 0s 4ms/step - loss: 0.0279 - val_loss: 0.0108 - lr: 5.0000e-04
Epoch 11/20
  1/102 [..............................] - ETA: 0s - loss: 0.0243 16/102 [===>..........................] - ETA: 0s - loss: 0.0254 29/102 [=======>......................] - ETA: 0s - loss: 0.0240 45/102 [============>.................] - ETA: 0s - loss: 0.0239 59/102 [================>.............] - ETA: 0s - loss: 0.0243 73/102 [====================>.........] - ETA: 0s - loss: 0.0240 87/102 [========================>.....] - ETA: 0s - loss: 0.0253102/102 [==============================] - ETA: 0s - loss: 0.0258102/102 [==============================] - 0s 4ms/step - loss: 0.0258 - val_loss: 0.0111 - lr: 2.5000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.018816/16 [==============================] - 0s 2ms/step - loss: 0.0268
Test Loss: 0.026758618652820587
Saved model as forecasting_models_v5/model_dnn_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for DNN model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 82ms/step
Predicted QoE for the next time step: -16052.48404965921
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/dnn_with_elu.h5
Completed at Τετ 14 Μαΐ 2025 10:05:54 μμ EEST
=====================================================

=====================================================
Training dnn model with config: with_high_dropout
Starting at Τετ 14 Μαΐ 2025 10:05:54 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type dnn                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --dropout_rate 0.4
2025-05-14 22:05:54.495755: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:05:54.659516: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:05:55.313600: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:05:55.313681: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:05:55.313691: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:06:02.578881: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:06:03.310091: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:06:03.310118: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:06:03.310273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5555 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 64)                14464     
                                                                 
 dropout (Dropout)           (None, 64)                0         
                                                                 
 dense_1 (Dense)             (None, 32)                2080      
                                                                 
 dropout_1 (Dropout)         (None, 32)                0         
                                                                 
 dense_2 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 16,577
Trainable params: 16,577
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 1:38 - loss: 1.3900 13/102 [==>...........................] - ETA: 0s - loss: 0.5574   28/102 [=======>......................] - ETA: 0s - loss: 0.3643 44/102 [===========>..................] - ETA: 0s - loss: 0.2832 59/102 [================>.............] - ETA: 0s - loss: 0.2445 74/102 [====================>.........] - ETA: 0s - loss: 0.2192 89/102 [=========================>....] - ETA: 0s - loss: 0.2014102/102 [==============================] - 2s 6ms/step - loss: 0.1897 - val_loss: 0.0309 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.0704 16/102 [===>..........................] - ETA: 0s - loss: 0.0823 30/102 [=======>......................] - ETA: 0s - loss: 0.0806 44/102 [===========>..................] - ETA: 0s - loss: 0.0810 59/102 [================>.............] - ETA: 0s - loss: 0.0794 73/102 [====================>.........] - ETA: 0s - loss: 0.0766 87/102 [========================>.....] - ETA: 0s - loss: 0.0749102/102 [==============================] - ETA: 0s - loss: 0.0737102/102 [==============================] - 0s 4ms/step - loss: 0.0737 - val_loss: 0.0270 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.0551 15/102 [===>..........................] - ETA: 0s - loss: 0.0624 28/102 [=======>......................] - ETA: 0s - loss: 0.0597 44/102 [===========>..................] - ETA: 0s - loss: 0.0583 59/102 [================>.............] - ETA: 0s - loss: 0.0581 73/102 [====================>.........] - ETA: 0s - loss: 0.0572 88/102 [========================>.....] - ETA: 0s - loss: 0.0566102/102 [==============================] - 0s 4ms/step - loss: 0.0553 - val_loss: 0.0138 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0404 16/102 [===>..........................] - ETA: 0s - loss: 0.0520 31/102 [========>.....................] - ETA: 0s - loss: 0.0495 45/102 [============>.................] - ETA: 0s - loss: 0.0499 59/102 [================>.............] - ETA: 0s - loss: 0.0468 75/102 [=====================>........] - ETA: 0s - loss: 0.0458 90/102 [=========================>....] - ETA: 0s - loss: 0.0444102/102 [==============================] - 0s 4ms/step - loss: 0.0435 - val_loss: 0.0161 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0539 16/102 [===>..........................] - ETA: 0s - loss: 0.0456 30/102 [=======>......................] - ETA: 0s - loss: 0.0428 44/102 [===========>..................] - ETA: 0s - loss: 0.0405 59/102 [================>.............] - ETA: 0s - loss: 0.0388 73/102 [====================>.........] - ETA: 0s - loss: 0.0380 89/102 [=========================>....] - ETA: 0s - loss: 0.0383102/102 [==============================] - 0s 4ms/step - loss: 0.0376 - val_loss: 0.0099 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0359 17/102 [====>.........................] - ETA: 0s - loss: 0.0321 31/102 [========>.....................] - ETA: 0s - loss: 0.0322 44/102 [===========>..................] - ETA: 0s - loss: 0.0321 58/102 [================>.............] - ETA: 0s - loss: 0.0313 73/102 [====================>.........] - ETA: 0s - loss: 0.0315 86/102 [========================>.....] - ETA: 0s - loss: 0.0323101/102 [============================>.] - ETA: 0s - loss: 0.0322102/102 [==============================] - 0s 4ms/step - loss: 0.0322 - val_loss: 0.0103 - lr: 0.0010
Epoch 7/20
  1/102 [..............................] - ETA: 0s - loss: 0.0120 17/102 [====>.........................] - ETA: 0s - loss: 0.0325 32/102 [========>.....................] - ETA: 0s - loss: 0.0311 46/102 [============>.................] - ETA: 0s - loss: 0.0303 60/102 [================>.............] - ETA: 0s - loss: 0.0301 74/102 [====================>.........] - ETA: 0s - loss: 0.0300 88/102 [========================>.....] - ETA: 0s - loss: 0.0305102/102 [==============================] - ETA: 0s - loss: 0.0299102/102 [==============================] - 0s 4ms/step - loss: 0.0299 - val_loss: 0.0082 - lr: 0.0010
Epoch 8/20
  1/102 [..............................] - ETA: 0s - loss: 0.0161 17/102 [====>.........................] - ETA: 0s - loss: 0.0304 31/102 [========>.....................] - ETA: 0s - loss: 0.0298 45/102 [============>.................] - ETA: 0s - loss: 0.0294 60/102 [================>.............] - ETA: 0s - loss: 0.0295 74/102 [====================>.........] - ETA: 0s - loss: 0.0293 89/102 [=========================>....] - ETA: 0s - loss: 0.0284102/102 [==============================] - 0s 4ms/step - loss: 0.0290 - val_loss: 0.0084 - lr: 0.0010
Epoch 9/20
  1/102 [..............................] - ETA: 0s - loss: 0.0312 15/102 [===>..........................] - ETA: 0s - loss: 0.0282 29/102 [=======>......................] - ETA: 0s - loss: 0.0293 44/102 [===========>..................] - ETA: 0s - loss: 0.0279 58/102 [================>.............] - ETA: 0s - loss: 0.0271 72/102 [====================>.........] - ETA: 0s - loss: 0.0278 88/102 [========================>.....] - ETA: 0s - loss: 0.0267102/102 [==============================] - ETA: 0s - loss: 0.0272102/102 [==============================] - 0s 4ms/step - loss: 0.0272 - val_loss: 0.0090 - lr: 0.0010
Epoch 10/20
  1/102 [..............................] - ETA: 0s - loss: 0.0354 16/102 [===>..........................] - ETA: 0s - loss: 0.0305 30/102 [=======>......................] - ETA: 0s - loss: 0.0267 44/102 [===========>..................] - ETA: 0s - loss: 0.0271 59/102 [================>.............] - ETA: 0s - loss: 0.0274 73/102 [====================>.........] - ETA: 0s - loss: 0.0271 88/102 [========================>.....] - ETA: 0s - loss: 0.0270102/102 [==============================] - ETA: 0s - loss: 0.0273102/102 [==============================] - 0s 5ms/step - loss: 0.0273 - val_loss: 0.0090 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.016516/16 [==============================] - 0s 2ms/step - loss: 0.0297
Test Loss: 0.029734810814261436
Saved model as forecasting_models_v5/model_dnn_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for DNN model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 79ms/step
Predicted QoE for the next time step: 25056.516437576156
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/dnn_with_high_dropout.h5
Completed at Τετ 14 Μαΐ 2025 10:06:12 μμ EEST
=====================================================

=====================================================
Training lstm model with config: basic
Starting at Τετ 14 Μαΐ 2025 10:06:12 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type lstm                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --attention_units 128
2025-05-14 22:06:12.570684: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:06:12.735836: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:06:13.386636: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:06:13.386728: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:06:13.386738: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:06:20.379755: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:06:21.064037: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:06:21.064065: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:06:21.064222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5563 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 5, 96)             54528     
                                                                 
 lstm_1 (LSTM)               (None, 5, 96)             74112     
                                                                 
 lstm_2 (LSTM)               (None, 5, 96)             74112     
                                                                 
 lstm_3 (LSTM)               (None, 5, 96)             74112     
                                                                 
 self_attention (SelfAttenti  (None, 96)               12544     
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                2425      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 291,859
Trainable params: 291,859
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 15:14 - loss: 0.3519  2/102 [..............................] - ETA: 9s - loss: 0.3538     3/102 [..............................] - ETA: 9s - loss: 0.3563  4/102 [>.............................] - ETA: 9s - loss: 0.3393  5/102 [>.............................] - ETA: 8s - loss: 0.3263  6/102 [>.............................] - ETA: 8s - loss: 0.3140  7/102 [=>............................] - ETA: 8s - loss: 0.3051  8/102 [=>............................] - ETA: 8s - loss: 0.2883  9/102 [=>............................] - ETA: 8s - loss: 0.2695 10/102 [=>............................] - ETA: 8s - loss: 0.2556 11/102 [==>...........................] - ETA: 8s - loss: 0.2396 12/102 [==>...........................] - ETA: 8s - loss: 0.2223 13/102 [==>...........................] - ETA: 8s - loss: 0.2246 14/102 [===>..........................] - ETA: 8s - loss: 0.2179 15/102 [===>..........................] - ETA: 8s - loss: 0.2077 16/102 [===>..........................] - ETA: 8s - loss: 0.1978 17/102 [====>.........................] - ETA: 8s - loss: 0.1887 18/102 [====>.........................] - ETA: 8s - loss: 0.1800 19/102 [====>.........................] - ETA: 8s - loss: 0.1732 20/102 [====>.........................] - ETA: 8s - loss: 0.1687 21/102 [=====>........................] - ETA: 7s - loss: 0.1638 22/102 [=====>........................] - ETA: 7s - loss: 0.1591 23/102 [=====>........................] - ETA: 7s - loss: 0.1541 24/102 [======>.......................] - ETA: 7s - loss: 0.1494 25/102 [======>.......................] - ETA: 7s - loss: 0.1456 26/102 [======>.......................] - ETA: 7s - loss: 0.1418 27/102 [======>.......................] - ETA: 7s - loss: 0.1381 28/102 [=======>......................] - ETA: 7s - loss: 0.1339 29/102 [=======>......................] - ETA: 7s - loss: 0.1301 30/102 [=======>......................] - ETA: 7s - loss: 0.1265 31/102 [========>.....................] - ETA: 6s - loss: 0.1230 32/102 [========>.....................] - ETA: 6s - loss: 0.1207 33/102 [========>.....................] - ETA: 6s - loss: 0.1177 34/102 [=========>....................] - ETA: 6s - loss: 0.1154 35/102 [=========>....................] - ETA: 6s - loss: 0.1129 36/102 [=========>....................] - ETA: 6s - loss: 0.1101 37/102 [=========>....................] - ETA: 6s - loss: 0.1076 38/102 [==========>...................] - ETA: 6s - loss: 0.1052 39/102 [==========>...................] - ETA: 6s - loss: 0.1029 40/102 [==========>...................] - ETA: 6s - loss: 0.1007 41/102 [===========>..................] - ETA: 5s - loss: 0.0988 42/102 [===========>..................] - ETA: 5s - loss: 0.0969 43/102 [===========>..................] - ETA: 5s - loss: 0.0952 44/102 [===========>..................] - ETA: 5s - loss: 0.0933 45/102 [============>.................] - ETA: 5s - loss: 0.0914 46/102 [============>.................] - ETA: 5s - loss: 0.0900 47/102 [============>.................] - ETA: 5s - loss: 0.0882 48/102 [=============>................] - ETA: 5s - loss: 0.0865 49/102 [=============>................] - ETA: 5s - loss: 0.0852 50/102 [=============>................] - ETA: 5s - loss: 0.0845 51/102 [==============>...............] - ETA: 5s - loss: 0.0834 52/102 [==============>...............] - ETA: 4s - loss: 0.0820 53/102 [==============>...............] - ETA: 4s - loss: 0.0812 54/102 [==============>...............] - ETA: 4s - loss: 0.0802 55/102 [===============>..............] - ETA: 4s - loss: 0.0791 56/102 [===============>..............] - ETA: 4s - loss: 0.0782 57/102 [===============>..............] - ETA: 4s - loss: 0.0774 58/102 [================>.............] - ETA: 4s - loss: 0.0767 59/102 [================>.............] - ETA: 4s - loss: 0.0762 60/102 [================>.............] - ETA: 4s - loss: 0.0751 61/102 [================>.............] - ETA: 4s - loss: 0.0741 62/102 [=================>............] - ETA: 3s - loss: 0.0732 63/102 [=================>............] - ETA: 3s - loss: 0.0723 64/102 [=================>............] - ETA: 3s - loss: 0.0716 65/102 [==================>...........] - ETA: 3s - loss: 0.0708 66/102 [==================>...........] - ETA: 3s - loss: 0.0699 67/102 [==================>...........] - ETA: 3s - loss: 0.0690 68/102 [===================>..........] - ETA: 3s - loss: 0.0683 69/102 [===================>..........] - ETA: 3s - loss: 0.0676 70/102 [===================>..........] - ETA: 3s - loss: 0.0667 71/102 [===================>..........] - ETA: 3s - loss: 0.0661 72/102 [====================>.........] - ETA: 2s - loss: 0.0658 73/102 [====================>.........] - ETA: 2s - loss: 0.0652 74/102 [====================>.........] - ETA: 2s - loss: 0.0644 75/102 [=====================>........] - ETA: 2s - loss: 0.0639 76/102 [=====================>........] - ETA: 2s - loss: 0.0634 77/102 [=====================>........] - ETA: 2s - loss: 0.0627 78/102 [=====================>........] - ETA: 2s - loss: 0.0624 79/102 [======================>.......] - ETA: 2s - loss: 0.0618 80/102 [======================>.......] - ETA: 2s - loss: 0.0612 81/102 [======================>.......] - ETA: 2s - loss: 0.0609 82/102 [=======================>......] - ETA: 1s - loss: 0.0606 83/102 [=======================>......] - ETA: 1s - loss: 0.0602 84/102 [=======================>......] - ETA: 1s - loss: 0.0597 85/102 [========================>.....] - ETA: 1s - loss: 0.0592 86/102 [========================>.....] - ETA: 1s - loss: 0.0591 87/102 [========================>.....] - ETA: 1s - loss: 0.0586 88/102 [========================>.....] - ETA: 1s - loss: 0.0582 89/102 [=========================>....] - ETA: 1s - loss: 0.0577 90/102 [=========================>....] - ETA: 1s - loss: 0.0573 91/102 [=========================>....] - ETA: 1s - loss: 0.0568 92/102 [==========================>...] - ETA: 0s - loss: 0.0563 93/102 [==========================>...] - ETA: 0s - loss: 0.0559 94/102 [==========================>...] - ETA: 0s - loss: 0.0554 95/102 [==========================>...] - ETA: 0s - loss: 0.0554 96/102 [===========================>..] - ETA: 0s - loss: 0.0551 97/102 [===========================>..] - ETA: 0s - loss: 0.0548 98/102 [===========================>..] - ETA: 0s - loss: 0.0545 99/102 [============================>.] - ETA: 0s - loss: 0.0540100/102 [============================>.] - ETA: 0s - loss: 0.0537101/102 [============================>.] - ETA: 0s - loss: 0.0535102/102 [==============================] - ETA: 0s - loss: 0.0534102/102 [==============================] - 20s 113ms/step - loss: 0.0534 - val_loss: 0.0084 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 9s - loss: 0.0160  2/102 [..............................] - ETA: 9s - loss: 0.0330  3/102 [..............................] - ETA: 9s - loss: 0.0266  4/102 [>.............................] - ETA: 9s - loss: 0.0263  5/102 [>.............................] - ETA: 9s - loss: 0.0233  6/102 [>.............................] - ETA: 9s - loss: 0.0215  7/102 [=>............................] - ETA: 9s - loss: 0.0239  8/102 [=>............................] - ETA: 9s - loss: 0.0231  9/102 [=>............................] - ETA: 9s - loss: 0.0246 10/102 [=>............................] - ETA: 9s - loss: 0.0261 11/102 [==>...........................] - ETA: 9s - loss: 0.0254 12/102 [==>...........................] - ETA: 9s - loss: 0.0258 13/102 [==>...........................] - ETA: 8s - loss: 0.0259 14/102 [===>..........................] - ETA: 8s - loss: 0.0255 15/102 [===>..........................] - ETA: 8s - loss: 0.0248 16/102 [===>..........................] - ETA: 8s - loss: 0.0240 17/102 [====>.........................] - ETA: 8s - loss: 0.0239 18/102 [====>.........................] - ETA: 8s - loss: 0.0232 19/102 [====>.........................] - ETA: 8s - loss: 0.0240 20/102 [====>.........................] - ETA: 8s - loss: 0.0236 21/102 [=====>........................] - ETA: 8s - loss: 0.0234 22/102 [=====>........................] - ETA: 7s - loss: 0.0230 23/102 [=====>........................] - ETA: 7s - loss: 0.0226 24/102 [======>.......................] - ETA: 7s - loss: 0.0221 25/102 [======>.......................] - ETA: 7s - loss: 0.0215 26/102 [======>.......................] - ETA: 7s - loss: 0.0218 27/102 [======>.......................] - ETA: 7s - loss: 0.0213 28/102 [=======>......................] - ETA: 7s - loss: 0.0214 29/102 [=======>......................] - ETA: 7s - loss: 0.0213 30/102 [=======>......................] - ETA: 7s - loss: 0.0209 31/102 [========>.....................] - ETA: 7s - loss: 0.0213 32/102 [========>.....................] - ETA: 6s - loss: 0.0215 33/102 [========>.....................] - ETA: 6s - loss: 0.0214 34/102 [=========>....................] - ETA: 6s - loss: 0.0215 35/102 [=========>....................] - ETA: 6s - loss: 0.0217 36/102 [=========>....................] - ETA: 6s - loss: 0.0216 37/102 [=========>....................] - ETA: 6s - loss: 0.0222 38/102 [==========>...................] - ETA: 6s - loss: 0.0223 39/102 [==========>...................] - ETA: 6s - loss: 0.0224 40/102 [==========>...................] - ETA: 6s - loss: 0.0223 41/102 [===========>..................] - ETA: 6s - loss: 0.0221 42/102 [===========>..................] - ETA: 6s - loss: 0.0220 43/102 [===========>..................] - ETA: 5s - loss: 0.0220 44/102 [===========>..................] - ETA: 5s - loss: 0.0216 45/102 [============>.................] - ETA: 5s - loss: 0.0215 46/102 [============>.................] - ETA: 5s - loss: 0.0212 47/102 [============>.................] - ETA: 5s - loss: 0.0210 48/102 [=============>................] - ETA: 5s - loss: 0.0209 49/102 [=============>................] - ETA: 5s - loss: 0.0210 50/102 [=============>................] - ETA: 5s - loss: 0.0209 51/102 [==============>...............] - ETA: 5s - loss: 0.0206 52/102 [==============>...............] - ETA: 5s - loss: 0.0207 53/102 [==============>...............] - ETA: 4s - loss: 0.0208 54/102 [==============>...............] - ETA: 4s - loss: 0.0207 55/102 [===============>..............] - ETA: 4s - loss: 0.0207 56/102 [===============>..............] - ETA: 4s - loss: 0.0209 57/102 [===============>..............] - ETA: 4s - loss: 0.0207 58/102 [================>.............] - ETA: 4s - loss: 0.0207 59/102 [================>.............] - ETA: 4s - loss: 0.0205 60/102 [================>.............] - ETA: 4s - loss: 0.0205 61/102 [================>.............] - ETA: 4s - loss: 0.0205 62/102 [=================>............] - ETA: 4s - loss: 0.0205 63/102 [=================>............] - ETA: 3s - loss: 0.0204 64/102 [=================>............] - ETA: 3s - loss: 0.0204 65/102 [==================>...........] - ETA: 3s - loss: 0.0204 66/102 [==================>...........] - ETA: 3s - loss: 0.0203 67/102 [==================>...........] - ETA: 3s - loss: 0.0203 68/102 [===================>..........] - ETA: 3s - loss: 0.0201 69/102 [===================>..........] - ETA: 3s - loss: 0.0200 70/102 [===================>..........] - ETA: 3s - loss: 0.0202 71/102 [===================>..........] - ETA: 3s - loss: 0.0201 72/102 [====================>.........] - ETA: 3s - loss: 0.0200 73/102 [====================>.........] - ETA: 2s - loss: 0.0201 74/102 [====================>.........] - ETA: 2s - loss: 0.0199 75/102 [=====================>........] - ETA: 2s - loss: 0.0199 76/102 [=====================>........] - ETA: 2s - loss: 0.0200 77/102 [=====================>........] - ETA: 2s - loss: 0.0201 78/102 [=====================>........] - ETA: 2s - loss: 0.0200 79/102 [======================>.......] - ETA: 2s - loss: 0.0200 80/102 [======================>.......] - ETA: 2s - loss: 0.0199 81/102 [======================>.......] - ETA: 2s - loss: 0.0198 82/102 [=======================>......] - ETA: 2s - loss: 0.0197 83/102 [=======================>......] - ETA: 1s - loss: 0.0198 84/102 [=======================>......] - ETA: 1s - loss: 0.0197 85/102 [========================>.....] - ETA: 1s - loss: 0.0197 86/102 [========================>.....] - ETA: 1s - loss: 0.0198 87/102 [========================>.....] - ETA: 1s - loss: 0.0198 88/102 [========================>.....] - ETA: 1s - loss: 0.0196 89/102 [=========================>....] - ETA: 1s - loss: 0.0196 90/102 [=========================>....] - ETA: 1s - loss: 0.0196 91/102 [=========================>....] - ETA: 1s - loss: 0.0197 92/102 [==========================>...] - ETA: 1s - loss: 0.0196 93/102 [==========================>...] - ETA: 0s - loss: 0.0195 94/102 [==========================>...] - ETA: 0s - loss: 0.0194 95/102 [==========================>...] - ETA: 0s - loss: 0.0192 96/102 [===========================>..] - ETA: 0s - loss: 0.0191 97/102 [===========================>..] - ETA: 0s - loss: 0.0190 98/102 [===========================>..] - ETA: 0s - loss: 0.0191 99/102 [============================>.] - ETA: 0s - loss: 0.0189100/102 [============================>.] - ETA: 0s - loss: 0.0189101/102 [============================>.] - ETA: 0s - loss: 0.0189102/102 [==============================] - ETA: 0s - loss: 0.0188102/102 [==============================] - 11s 105ms/step - loss: 0.0188 - val_loss: 0.0087 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 10s - loss: 0.0241  2/102 [..............................] - ETA: 10s - loss: 0.0184  3/102 [..............................] - ETA: 10s - loss: 0.0212  4/102 [>.............................] - ETA: 9s - loss: 0.0211   5/102 [>.............................] - ETA: 10s - loss: 0.0195  6/102 [>.............................] - ETA: 10s - loss: 0.0182  7/102 [=>............................] - ETA: 9s - loss: 0.0173   8/102 [=>............................] - ETA: 9s - loss: 0.0164  9/102 [=>............................] - ETA: 9s - loss: 0.0160 10/102 [=>............................] - ETA: 9s - loss: 0.0175 11/102 [==>...........................] - ETA: 9s - loss: 0.0178 12/102 [==>...........................] - ETA: 9s - loss: 0.0179 13/102 [==>...........................] - ETA: 9s - loss: 0.0193 14/102 [===>..........................] - ETA: 8s - loss: 0.0200 15/102 [===>..........................] - ETA: 8s - loss: 0.0216 16/102 [===>..........................] - ETA: 8s - loss: 0.0216 17/102 [====>.........................] - ETA: 8s - loss: 0.0217 18/102 [====>.........................] - ETA: 8s - loss: 0.0211 19/102 [====>.........................] - ETA: 8s - loss: 0.0210 20/102 [====>.........................] - ETA: 8s - loss: 0.0213 21/102 [=====>........................] - ETA: 8s - loss: 0.0209 22/102 [=====>........................] - ETA: 8s - loss: 0.0207 23/102 [=====>........................] - ETA: 8s - loss: 0.0206 24/102 [======>.......................] - ETA: 7s - loss: 0.0205 25/102 [======>.......................] - ETA: 7s - loss: 0.0205 26/102 [======>.......................] - ETA: 7s - loss: 0.0198 27/102 [======>.......................] - ETA: 7s - loss: 0.0197 28/102 [=======>......................] - ETA: 7s - loss: 0.0192 29/102 [=======>......................] - ETA: 7s - loss: 0.0196 30/102 [=======>......................] - ETA: 7s - loss: 0.0196 31/102 [========>.....................] - ETA: 7s - loss: 0.0191 32/102 [========>.....................] - ETA: 7s - loss: 0.0191 33/102 [========>.....................] - ETA: 6s - loss: 0.0189 34/102 [=========>....................] - ETA: 6s - loss: 0.0188 35/102 [=========>....................] - ETA: 6s - loss: 0.0188 36/102 [=========>....................] - ETA: 6s - loss: 0.0185 37/102 [=========>....................] - ETA: 6s - loss: 0.0184 38/102 [==========>...................] - ETA: 6s - loss: 0.0184 39/102 [==========>...................] - ETA: 6s - loss: 0.0186 40/102 [==========>...................] - ETA: 6s - loss: 0.0187 41/102 [===========>..................] - ETA: 6s - loss: 0.0185 42/102 [===========>..................] - ETA: 6s - loss: 0.0184 43/102 [===========>..................] - ETA: 5s - loss: 0.0182 44/102 [===========>..................] - ETA: 5s - loss: 0.0181 45/102 [============>.................] - ETA: 5s - loss: 0.0181 46/102 [============>.................] - ETA: 5s - loss: 0.0180 47/102 [============>.................] - ETA: 5s - loss: 0.0178 48/102 [=============>................] - ETA: 5s - loss: 0.0177 49/102 [=============>................] - ETA: 5s - loss: 0.0176 50/102 [=============>................] - ETA: 5s - loss: 0.0174 51/102 [==============>...............] - ETA: 5s - loss: 0.0172 52/102 [==============>...............] - ETA: 5s - loss: 0.0173 53/102 [==============>...............] - ETA: 4s - loss: 0.0172 54/102 [==============>...............] - ETA: 4s - loss: 0.0175 55/102 [===============>..............] - ETA: 4s - loss: 0.0175 56/102 [===============>..............] - ETA: 4s - loss: 0.0174 57/102 [===============>..............] - ETA: 4s - loss: 0.0173 58/102 [================>.............] - ETA: 4s - loss: 0.0174 59/102 [================>.............] - ETA: 4s - loss: 0.0176 60/102 [================>.............] - ETA: 4s - loss: 0.0174 61/102 [================>.............] - ETA: 4s - loss: 0.0173 62/102 [=================>............] - ETA: 4s - loss: 0.0171 63/102 [=================>............] - ETA: 3s - loss: 0.0172 64/102 [=================>............] - ETA: 3s - loss: 0.0171 65/102 [==================>...........] - ETA: 3s - loss: 0.0169 66/102 [==================>...........] - ETA: 3s - loss: 0.0171 67/102 [==================>...........] - ETA: 3s - loss: 0.0173 68/102 [===================>..........] - ETA: 3s - loss: 0.0172 69/102 [===================>..........] - ETA: 3s - loss: 0.0172 70/102 [===================>..........] - ETA: 3s - loss: 0.0172 71/102 [===================>..........] - ETA: 3s - loss: 0.0173 72/102 [====================>.........] - ETA: 3s - loss: 0.0175 73/102 [====================>.........] - ETA: 2s - loss: 0.0174 74/102 [====================>.........] - ETA: 2s - loss: 0.0173 75/102 [=====================>........] - ETA: 2s - loss: 0.0173 76/102 [=====================>........] - ETA: 2s - loss: 0.0171 77/102 [=====================>........] - ETA: 2s - loss: 0.0172 78/102 [=====================>........] - ETA: 2s - loss: 0.0170 79/102 [======================>.......] - ETA: 2s - loss: 0.0170 80/102 [======================>.......] - ETA: 2s - loss: 0.0172 81/102 [======================>.......] - ETA: 2s - loss: 0.0172 82/102 [=======================>......] - ETA: 2s - loss: 0.0172 83/102 [=======================>......] - ETA: 1s - loss: 0.0171 84/102 [=======================>......] - ETA: 1s - loss: 0.0171 85/102 [========================>.....] - ETA: 1s - loss: 0.0172 86/102 [========================>.....] - ETA: 1s - loss: 0.0172 87/102 [========================>.....] - ETA: 1s - loss: 0.0172 88/102 [========================>.....] - ETA: 1s - loss: 0.0172 89/102 [=========================>....] - ETA: 1s - loss: 0.0173 90/102 [=========================>....] - ETA: 1s - loss: 0.0173 91/102 [=========================>....] - ETA: 1s - loss: 0.0174 92/102 [==========================>...] - ETA: 1s - loss: 0.0174 93/102 [==========================>...] - ETA: 0s - loss: 0.0175 94/102 [==========================>...] - ETA: 0s - loss: 0.0174 95/102 [==========================>...] - ETA: 0s - loss: 0.0174 96/102 [===========================>..] - ETA: 0s - loss: 0.0175 97/102 [===========================>..] - ETA: 0s - loss: 0.0174 98/102 [===========================>..] - ETA: 0s - loss: 0.0173 99/102 [============================>.] - ETA: 0s - loss: 0.0173100/102 [============================>.] - ETA: 0s - loss: 0.0173101/102 [============================>.] - ETA: 0s - loss: 0.0177102/102 [==============================] - ETA: 0s - loss: 0.0177102/102 [==============================] - 11s 105ms/step - loss: 0.0177 - val_loss: 0.0081 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 10s - loss: 0.0101  2/102 [..............................] - ETA: 9s - loss: 0.0119   3/102 [..............................] - ETA: 9s - loss: 0.0161  4/102 [>.............................] - ETA: 9s - loss: 0.0167  5/102 [>.............................] - ETA: 9s - loss: 0.0148  6/102 [>.............................] - ETA: 9s - loss: 0.0167  7/102 [=>............................] - ETA: 9s - loss: 0.0189  8/102 [=>............................] - ETA: 9s - loss: 0.0192  9/102 [=>............................] - ETA: 9s - loss: 0.0189 10/102 [=>............................] - ETA: 8s - loss: 0.0181 11/102 [==>...........................] - ETA: 8s - loss: 0.0175 12/102 [==>...........................] - ETA: 8s - loss: 0.0166 13/102 [==>...........................] - ETA: 8s - loss: 0.0167 14/102 [===>..........................] - ETA: 8s - loss: 0.0166 15/102 [===>..........................] - ETA: 8s - loss: 0.0176 16/102 [===>..........................] - ETA: 8s - loss: 0.0181 17/102 [====>.........................] - ETA: 8s - loss: 0.0174 18/102 [====>.........................] - ETA: 8s - loss: 0.0174 19/102 [====>.........................] - ETA: 8s - loss: 0.0175 20/102 [====>.........................] - ETA: 8s - loss: 0.0172 21/102 [=====>........................] - ETA: 8s - loss: 0.0170 22/102 [=====>........................] - ETA: 8s - loss: 0.0167 23/102 [=====>........................] - ETA: 7s - loss: 0.0168 24/102 [======>.......................] - ETA: 7s - loss: 0.0167 25/102 [======>.......................] - ETA: 7s - loss: 0.0166 26/102 [======>.......................] - ETA: 7s - loss: 0.0166 27/102 [======>.......................] - ETA: 7s - loss: 0.0164 28/102 [=======>......................] - ETA: 7s - loss: 0.0162 29/102 [=======>......................] - ETA: 7s - loss: 0.0164 30/102 [=======>......................] - ETA: 7s - loss: 0.0169 31/102 [========>.....................] - ETA: 7s - loss: 0.0169 32/102 [========>.....................] - ETA: 7s - loss: 0.0172 33/102 [========>.....................] - ETA: 6s - loss: 0.0177 34/102 [=========>....................] - ETA: 6s - loss: 0.0175 35/102 [=========>....................] - ETA: 6s - loss: 0.0178 36/102 [=========>....................] - ETA: 6s - loss: 0.0183 37/102 [=========>....................] - ETA: 6s - loss: 0.0183 38/102 [==========>...................] - ETA: 6s - loss: 0.0185 39/102 [==========>...................] - ETA: 6s - loss: 0.0183 40/102 [==========>...................] - ETA: 6s - loss: 0.0182 41/102 [===========>..................] - ETA: 6s - loss: 0.0181 42/102 [===========>..................] - ETA: 6s - loss: 0.0182 43/102 [===========>..................] - ETA: 5s - loss: 0.0181 44/102 [===========>..................] - ETA: 5s - loss: 0.0182 45/102 [============>.................] - ETA: 5s - loss: 0.0184 46/102 [============>.................] - ETA: 5s - loss: 0.0182 47/102 [============>.................] - ETA: 5s - loss: 0.0181 48/102 [=============>................] - ETA: 5s - loss: 0.0181 49/102 [=============>................] - ETA: 5s - loss: 0.0181 50/102 [=============>................] - ETA: 5s - loss: 0.0180 51/102 [==============>...............] - ETA: 5s - loss: 0.0180 52/102 [==============>...............] - ETA: 5s - loss: 0.0184 53/102 [==============>...............] - ETA: 4s - loss: 0.0181 54/102 [==============>...............] - ETA: 4s - loss: 0.0179 55/102 [===============>..............] - ETA: 4s - loss: 0.0178 56/102 [===============>..............] - ETA: 4s - loss: 0.0177 57/102 [===============>..............] - ETA: 4s - loss: 0.0175 58/102 [================>.............] - ETA: 4s - loss: 0.0178 59/102 [================>.............] - ETA: 4s - loss: 0.0176 60/102 [================>.............] - ETA: 4s - loss: 0.0176 61/102 [================>.............] - ETA: 4s - loss: 0.0174 62/102 [=================>............] - ETA: 4s - loss: 0.0174 63/102 [=================>............] - ETA: 3s - loss: 0.0177 64/102 [=================>............] - ETA: 3s - loss: 0.0180 65/102 [==================>...........] - ETA: 3s - loss: 0.0179 66/102 [==================>...........] - ETA: 3s - loss: 0.0178 67/102 [==================>...........] - ETA: 3s - loss: 0.0179 68/102 [===================>..........] - ETA: 3s - loss: 0.0177 69/102 [===================>..........] - ETA: 3s - loss: 0.0176 70/102 [===================>..........] - ETA: 3s - loss: 0.0175 71/102 [===================>..........] - ETA: 3s - loss: 0.0173 72/102 [====================>.........] - ETA: 3s - loss: 0.0177 73/102 [====================>.........] - ETA: 2s - loss: 0.0176 74/102 [====================>.........] - ETA: 2s - loss: 0.0175 75/102 [=====================>........] - ETA: 2s - loss: 0.0174 76/102 [=====================>........] - ETA: 2s - loss: 0.0174 77/102 [=====================>........] - ETA: 2s - loss: 0.0174 78/102 [=====================>........] - ETA: 2s - loss: 0.0173 79/102 [======================>.......] - ETA: 2s - loss: 0.0174 80/102 [======================>.......] - ETA: 2s - loss: 0.0174 81/102 [======================>.......] - ETA: 2s - loss: 0.0174 82/102 [=======================>......] - ETA: 2s - loss: 0.0174 83/102 [=======================>......] - ETA: 1s - loss: 0.0175 84/102 [=======================>......] - ETA: 1s - loss: 0.0176 85/102 [========================>.....] - ETA: 1s - loss: 0.0176 86/102 [========================>.....] - ETA: 1s - loss: 0.0177 87/102 [========================>.....] - ETA: 1s - loss: 0.0177 88/102 [========================>.....] - ETA: 1s - loss: 0.0176 89/102 [=========================>....] - ETA: 1s - loss: 0.0176 90/102 [=========================>....] - ETA: 1s - loss: 0.0174 91/102 [=========================>....] - ETA: 1s - loss: 0.0175 92/102 [==========================>...] - ETA: 1s - loss: 0.0174 93/102 [==========================>...] - ETA: 0s - loss: 0.0172 94/102 [==========================>...] - ETA: 0s - loss: 0.0174 95/102 [==========================>...] - ETA: 0s - loss: 0.0174 96/102 [===========================>..] - ETA: 0s - loss: 0.0176 97/102 [===========================>..] - ETA: 0s - loss: 0.0176 98/102 [===========================>..] - ETA: 0s - loss: 0.0178 99/102 [============================>.] - ETA: 0s - loss: 0.0177100/102 [============================>.] - ETA: 0s - loss: 0.0178101/102 [============================>.] - ETA: 0s - loss: 0.0178102/102 [==============================] - ETA: 0s - loss: 0.0178102/102 [==============================] - 11s 105ms/step - loss: 0.0178 - val_loss: 0.0111 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 11s - loss: 0.0324  2/102 [..............................] - ETA: 11s - loss: 0.0238  3/102 [..............................] - ETA: 10s - loss: 0.0192  4/102 [>.............................] - ETA: 10s - loss: 0.0175  5/102 [>.............................] - ETA: 10s - loss: 0.0154  6/102 [>.............................] - ETA: 9s - loss: 0.0159   7/102 [=>............................] - ETA: 9s - loss: 0.0146  8/102 [=>............................] - ETA: 9s - loss: 0.0144  9/102 [=>............................] - ETA: 9s - loss: 0.0146 10/102 [=>............................] - ETA: 9s - loss: 0.0138 11/102 [==>...........................] - ETA: 9s - loss: 0.0131 12/102 [==>...........................] - ETA: 9s - loss: 0.0134 13/102 [==>...........................] - ETA: 8s - loss: 0.0135 14/102 [===>..........................] - ETA: 8s - loss: 0.0137 15/102 [===>..........................] - ETA: 8s - loss: 0.0135 16/102 [===>..........................] - ETA: 8s - loss: 0.0130 17/102 [====>.........................] - ETA: 8s - loss: 0.0129 18/102 [====>.........................] - ETA: 8s - loss: 0.0131 19/102 [====>.........................] - ETA: 8s - loss: 0.0134 20/102 [====>.........................] - ETA: 8s - loss: 0.0136 21/102 [=====>........................] - ETA: 8s - loss: 0.0135 22/102 [=====>........................] - ETA: 8s - loss: 0.0146 23/102 [=====>........................] - ETA: 7s - loss: 0.0145 24/102 [======>.......................] - ETA: 7s - loss: 0.0152 25/102 [======>.......................] - ETA: 7s - loss: 0.0150 26/102 [======>.......................] - ETA: 7s - loss: 0.0154 27/102 [======>.......................] - ETA: 7s - loss: 0.0156 28/102 [=======>......................] - ETA: 7s - loss: 0.0155 29/102 [=======>......................] - ETA: 7s - loss: 0.0159 30/102 [=======>......................] - ETA: 7s - loss: 0.0165 31/102 [========>.....................] - ETA: 7s - loss: 0.0163 32/102 [========>.....................] - ETA: 7s - loss: 0.0165 33/102 [========>.....................] - ETA: 6s - loss: 0.0169 34/102 [=========>....................] - ETA: 6s - loss: 0.0168 35/102 [=========>....................] - ETA: 6s - loss: 0.0165 36/102 [=========>....................] - ETA: 6s - loss: 0.0167 37/102 [=========>....................] - ETA: 6s - loss: 0.0169 38/102 [==========>...................] - ETA: 6s - loss: 0.0171 39/102 [==========>...................] - ETA: 6s - loss: 0.0169 40/102 [==========>...................] - ETA: 6s - loss: 0.0171 41/102 [===========>..................] - ETA: 6s - loss: 0.0171 42/102 [===========>..................] - ETA: 6s - loss: 0.0173 43/102 [===========>..................] - ETA: 5s - loss: 0.0172 44/102 [===========>..................] - ETA: 5s - loss: 0.0171 45/102 [============>.................] - ETA: 5s - loss: 0.0169 46/102 [============>.................] - ETA: 5s - loss: 0.0169 47/102 [============>.................] - ETA: 5s - loss: 0.0169 48/102 [=============>................] - ETA: 5s - loss: 0.0168 49/102 [=============>................] - ETA: 5s - loss: 0.0166 50/102 [=============>................] - ETA: 5s - loss: 0.0166 51/102 [==============>...............] - ETA: 5s - loss: 0.0165 52/102 [==============>...............] - ETA: 5s - loss: 0.0163 53/102 [==============>...............] - ETA: 4s - loss: 0.0166 54/102 [==============>...............] - ETA: 4s - loss: 0.0168 55/102 [===============>..............] - ETA: 4s - loss: 0.0166 56/102 [===============>..............] - ETA: 4s - loss: 0.0170 57/102 [===============>..............] - ETA: 4s - loss: 0.0168 58/102 [================>.............] - ETA: 4s - loss: 0.0167 59/102 [================>.............] - ETA: 4s - loss: 0.0166 60/102 [================>.............] - ETA: 4s - loss: 0.0165 61/102 [================>.............] - ETA: 4s - loss: 0.0164 62/102 [=================>............] - ETA: 4s - loss: 0.0163 63/102 [=================>............] - ETA: 3s - loss: 0.0165 64/102 [=================>............] - ETA: 3s - loss: 0.0163 65/102 [==================>...........] - ETA: 3s - loss: 0.0166 66/102 [==================>...........] - ETA: 3s - loss: 0.0165 67/102 [==================>...........] - ETA: 3s - loss: 0.0164 68/102 [===================>..........] - ETA: 3s - loss: 0.0162 69/102 [===================>..........] - ETA: 3s - loss: 0.0163 70/102 [===================>..........] - ETA: 3s - loss: 0.0163 71/102 [===================>..........] - ETA: 3s - loss: 0.0164 72/102 [====================>.........] - ETA: 2s - loss: 0.0164 73/102 [====================>.........] - ETA: 2s - loss: 0.0163 74/102 [====================>.........] - ETA: 2s - loss: 0.0163 75/102 [=====================>........] - ETA: 2s - loss: 0.0163 76/102 [=====================>........] - ETA: 2s - loss: 0.0169 77/102 [=====================>........] - ETA: 2s - loss: 0.0170 78/102 [=====================>........] - ETA: 2s - loss: 0.0170 79/102 [======================>.......] - ETA: 2s - loss: 0.0169 80/102 [======================>.......] - ETA: 2s - loss: 0.0170 81/102 [======================>.......] - ETA: 2s - loss: 0.0169 82/102 [=======================>......] - ETA: 1s - loss: 0.0169 83/102 [=======================>......] - ETA: 1s - loss: 0.0168 84/102 [=======================>......] - ETA: 1s - loss: 0.0168 85/102 [========================>.....] - ETA: 1s - loss: 0.0167 86/102 [========================>.....] - ETA: 1s - loss: 0.0168 87/102 [========================>.....] - ETA: 1s - loss: 0.0168 88/102 [========================>.....] - ETA: 1s - loss: 0.0171 89/102 [=========================>....] - ETA: 1s - loss: 0.0170 90/102 [=========================>....] - ETA: 1s - loss: 0.0169 91/102 [=========================>....] - ETA: 1s - loss: 0.0170 92/102 [==========================>...] - ETA: 0s - loss: 0.0170 93/102 [==========================>...] - ETA: 0s - loss: 0.0170 94/102 [==========================>...] - ETA: 0s - loss: 0.0169 95/102 [==========================>...] - ETA: 0s - loss: 0.0168 96/102 [===========================>..] - ETA: 0s - loss: 0.0167 97/102 [===========================>..] - ETA: 0s - loss: 0.0166 98/102 [===========================>..] - ETA: 0s - loss: 0.0167 99/102 [============================>.] - ETA: 0s - loss: 0.0169100/102 [============================>.] - ETA: 0s - loss: 0.0168101/102 [============================>.] - ETA: 0s - loss: 0.0168102/102 [==============================] - ETA: 0s - loss: 0.0168102/102 [==============================] - 11s 104ms/step - loss: 0.0168 - val_loss: 0.0134 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 10s - loss: 0.0164  2/102 [..............................] - ETA: 9s - loss: 0.0111   3/102 [..............................] - ETA: 9s - loss: 0.0089  4/102 [>.............................] - ETA: 9s - loss: 0.0118  5/102 [>.............................] - ETA: 9s - loss: 0.0137  6/102 [>.............................] - ETA: 9s - loss: 0.0162  7/102 [=>............................] - ETA: 9s - loss: 0.0157  8/102 [=>............................] - ETA: 9s - loss: 0.0144  9/102 [=>............................] - ETA: 9s - loss: 0.0162 10/102 [=>............................] - ETA: 9s - loss: 0.0157 11/102 [==>...........................] - ETA: 8s - loss: 0.0156 12/102 [==>...........................] - ETA: 8s - loss: 0.0149 13/102 [==>...........................] - ETA: 8s - loss: 0.0151 14/102 [===>..........................] - ETA: 8s - loss: 0.0159 15/102 [===>..........................] - ETA: 8s - loss: 0.0162 16/102 [===>..........................] - ETA: 8s - loss: 0.0159 17/102 [====>.........................] - ETA: 8s - loss: 0.0155 18/102 [====>.........................] - ETA: 8s - loss: 0.0158 19/102 [====>.........................] - ETA: 8s - loss: 0.0155 20/102 [====>.........................] - ETA: 8s - loss: 0.0151 21/102 [=====>........................] - ETA: 7s - loss: 0.0153 22/102 [=====>........................] - ETA: 7s - loss: 0.0153 23/102 [=====>........................] - ETA: 7s - loss: 0.0152 24/102 [======>.......................] - ETA: 7s - loss: 0.0151 25/102 [======>.......................] - ETA: 7s - loss: 0.0157 26/102 [======>.......................] - ETA: 7s - loss: 0.0154 27/102 [======>.......................] - ETA: 7s - loss: 0.0154 28/102 [=======>......................] - ETA: 7s - loss: 0.0154 29/102 [=======>......................] - ETA: 7s - loss: 0.0158 30/102 [=======>......................] - ETA: 7s - loss: 0.0159 31/102 [========>.....................] - ETA: 7s - loss: 0.0164 32/102 [========>.....................] - ETA: 6s - loss: 0.0166 33/102 [========>.....................] - ETA: 6s - loss: 0.0167 34/102 [=========>....................] - ETA: 6s - loss: 0.0169 35/102 [=========>....................] - ETA: 6s - loss: 0.0169 36/102 [=========>....................] - ETA: 6s - loss: 0.0169 37/102 [=========>....................] - ETA: 6s - loss: 0.0166 38/102 [==========>...................] - ETA: 6s - loss: 0.0165 39/102 [==========>...................] - ETA: 6s - loss: 0.0164 40/102 [==========>...................] - ETA: 6s - loss: 0.0164 41/102 [===========>..................] - ETA: 6s - loss: 0.0162 42/102 [===========>..................] - ETA: 5s - loss: 0.0168 43/102 [===========>..................] - ETA: 5s - loss: 0.0168 44/102 [===========>..................] - ETA: 5s - loss: 0.0167 45/102 [============>.................] - ETA: 5s - loss: 0.0166 46/102 [============>.................] - ETA: 5s - loss: 0.0163 47/102 [============>.................] - ETA: 5s - loss: 0.0161 48/102 [=============>................] - ETA: 5s - loss: 0.0160 49/102 [=============>................] - ETA: 5s - loss: 0.0159 50/102 [=============>................] - ETA: 5s - loss: 0.0161 51/102 [==============>...............] - ETA: 5s - loss: 0.0163 52/102 [==============>...............] - ETA: 4s - loss: 0.0162 53/102 [==============>...............] - ETA: 4s - loss: 0.0162 54/102 [==============>...............] - ETA: 4s - loss: 0.0162 55/102 [===============>..............] - ETA: 4s - loss: 0.0161 56/102 [===============>..............] - ETA: 4s - loss: 0.0160 57/102 [===============>..............] - ETA: 4s - loss: 0.0160 58/102 [================>.............] - ETA: 4s - loss: 0.0160 59/102 [================>.............] - ETA: 4s - loss: 0.0163 60/102 [================>.............] - ETA: 4s - loss: 0.0165 61/102 [================>.............] - ETA: 4s - loss: 0.0163 62/102 [=================>............] - ETA: 3s - loss: 0.0165 63/102 [=================>............] - ETA: 3s - loss: 0.0166 64/102 [=================>............] - ETA: 3s - loss: 0.0166 65/102 [==================>...........] - ETA: 3s - loss: 0.0166 66/102 [==================>...........] - ETA: 3s - loss: 0.0166 67/102 [==================>...........] - ETA: 3s - loss: 0.0166 68/102 [===================>..........] - ETA: 3s - loss: 0.0166 69/102 [===================>..........] - ETA: 3s - loss: 0.0168 70/102 [===================>..........] - ETA: 3s - loss: 0.0167 71/102 [===================>..........] - ETA: 3s - loss: 0.0166 72/102 [====================>.........] - ETA: 2s - loss: 0.0165 73/102 [====================>.........] - ETA: 2s - loss: 0.0164 74/102 [====================>.........] - ETA: 2s - loss: 0.0165 75/102 [=====================>........] - ETA: 2s - loss: 0.0164 76/102 [=====================>........] - ETA: 2s - loss: 0.0164 77/102 [=====================>........] - ETA: 2s - loss: 0.0164 78/102 [=====================>........] - ETA: 2s - loss: 0.0164 79/102 [======================>.......] - ETA: 2s - loss: 0.0166 80/102 [======================>.......] - ETA: 2s - loss: 0.0164 81/102 [======================>.......] - ETA: 2s - loss: 0.0165 82/102 [=======================>......] - ETA: 1s - loss: 0.0165 83/102 [=======================>......] - ETA: 1s - loss: 0.0163 84/102 [=======================>......] - ETA: 1s - loss: 0.0162 85/102 [========================>.....] - ETA: 1s - loss: 0.0162 86/102 [========================>.....] - ETA: 1s - loss: 0.0162 87/102 [========================>.....] - ETA: 1s - loss: 0.0161 88/102 [========================>.....] - ETA: 1s - loss: 0.0161 89/102 [=========================>....] - ETA: 1s - loss: 0.0162 90/102 [=========================>....] - ETA: 1s - loss: 0.0162 91/102 [=========================>....] - ETA: 1s - loss: 0.0162 92/102 [==========================>...] - ETA: 0s - loss: 0.0161 93/102 [==========================>...] - ETA: 0s - loss: 0.0161 94/102 [==========================>...] - ETA: 0s - loss: 0.0163 95/102 [==========================>...] - ETA: 0s - loss: 0.0162 96/102 [===========================>..] - ETA: 0s - loss: 0.0161 97/102 [===========================>..] - ETA: 0s - loss: 0.0162 98/102 [===========================>..] - ETA: 0s - loss: 0.0162 99/102 [============================>.] - ETA: 0s - loss: 0.0162100/102 [============================>.] - ETA: 0s - loss: 0.0163101/102 [============================>.] - ETA: 0s - loss: 0.0164102/102 [==============================] - ETA: 0s - loss: 0.0163102/102 [==============================] - 11s 107ms/step - loss: 0.0163 - val_loss: 0.0095 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.0215 5/16 [========>.....................] - ETA: 0s - loss: 0.0324 9/16 [===============>..............] - ETA: 0s - loss: 0.027913/16 [=======================>......] - ETA: 0s - loss: 0.029716/16 [==============================] - ETA: 0s - loss: 0.031816/16 [==============================] - 0s 15ms/step - loss: 0.0318
Test Loss: 0.03178032487630844
Saved model as forecasting_models_v5/model_lstm_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LSTM model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 899ms/step
Predicted QoE for the next time step: 76.59516792400217
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/lstm_basic.h5
Completed at Τετ 14 Μαΐ 2025 10:07:40 μμ EEST
=====================================================

=====================================================
Training lstm model with config: deep
Starting at Τετ 14 Μαΐ 2025 10:07:40 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type lstm                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --num_layers 3 --attention_units 128
2025-05-14 22:07:40.576554: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:07:40.739926: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:07:41.359204: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:07:41.359287: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:07:41.359299: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:07:48.363525: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:07:49.061480: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:07:49.061505: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:07:49.061650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5558 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 5, 96)             54528     
                                                                 
 lstm_1 (LSTM)               (None, 5, 96)             74112     
                                                                 
 lstm_2 (LSTM)               (None, 5, 96)             74112     
                                                                 
 lstm_3 (LSTM)               (None, 5, 96)             74112     
                                                                 
 self_attention (SelfAttenti  (None, 96)               12544     
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                2425      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 291,859
Trainable params: 291,859
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 15:05 - loss: 0.3982  2/102 [..............................] - ETA: 9s - loss: 0.3945     3/102 [..............................] - ETA: 9s - loss: 0.3782  4/102 [>.............................] - ETA: 9s - loss: 0.3588  5/102 [>.............................] - ETA: 9s - loss: 0.3421  6/102 [>.............................] - ETA: 9s - loss: 0.3306  7/102 [=>............................] - ETA: 9s - loss: 0.3205  8/102 [=>............................] - ETA: 9s - loss: 0.3137  9/102 [=>............................] - ETA: 9s - loss: 0.3039 10/102 [=>............................] - ETA: 8s - loss: 0.2892 11/102 [==>...........................] - ETA: 8s - loss: 0.2743 12/102 [==>...........................] - ETA: 8s - loss: 0.2562 13/102 [==>...........................] - ETA: 8s - loss: 0.2397 14/102 [===>..........................] - ETA: 8s - loss: 0.2325 15/102 [===>..........................] - ETA: 8s - loss: 0.2242 16/102 [===>..........................] - ETA: 8s - loss: 0.2140 17/102 [====>.........................] - ETA: 8s - loss: 0.2035 18/102 [====>.........................] - ETA: 8s - loss: 0.1941 19/102 [====>.........................] - ETA: 8s - loss: 0.1857 20/102 [====>.........................] - ETA: 8s - loss: 0.1784 21/102 [=====>........................] - ETA: 7s - loss: 0.1726 22/102 [=====>........................] - ETA: 7s - loss: 0.1671 23/102 [=====>........................] - ETA: 7s - loss: 0.1616 24/102 [======>.......................] - ETA: 7s - loss: 0.1567 25/102 [======>.......................] - ETA: 7s - loss: 0.1519 26/102 [======>.......................] - ETA: 7s - loss: 0.1471 27/102 [======>.......................] - ETA: 7s - loss: 0.1437 28/102 [=======>......................] - ETA: 7s - loss: 0.1402 29/102 [=======>......................] - ETA: 7s - loss: 0.1359 30/102 [=======>......................] - ETA: 7s - loss: 0.1324 31/102 [========>.....................] - ETA: 6s - loss: 0.1296 32/102 [========>.....................] - ETA: 6s - loss: 0.1268 33/102 [========>.....................] - ETA: 6s - loss: 0.1238 34/102 [=========>....................] - ETA: 6s - loss: 0.1213 35/102 [=========>....................] - ETA: 6s - loss: 0.1183 36/102 [=========>....................] - ETA: 6s - loss: 0.1159 37/102 [=========>....................] - ETA: 6s - loss: 0.1134 38/102 [==========>...................] - ETA: 6s - loss: 0.1110 39/102 [==========>...................] - ETA: 6s - loss: 0.1090 40/102 [==========>...................] - ETA: 6s - loss: 0.1068 41/102 [===========>..................] - ETA: 5s - loss: 0.1049 42/102 [===========>..................] - ETA: 5s - loss: 0.1037 43/102 [===========>..................] - ETA: 5s - loss: 0.1026 44/102 [===========>..................] - ETA: 5s - loss: 0.1012 45/102 [============>.................] - ETA: 5s - loss: 0.0994 46/102 [============>.................] - ETA: 5s - loss: 0.0976 47/102 [============>.................] - ETA: 5s - loss: 0.0960 48/102 [=============>................] - ETA: 5s - loss: 0.0944 49/102 [=============>................] - ETA: 5s - loss: 0.0929 50/102 [=============>................] - ETA: 5s - loss: 0.0914 51/102 [==============>...............] - ETA: 5s - loss: 0.0901 52/102 [==============>...............] - ETA: 4s - loss: 0.0884 53/102 [==============>...............] - ETA: 4s - loss: 0.0873 54/102 [==============>...............] - ETA: 4s - loss: 0.0863 55/102 [===============>..............] - ETA: 4s - loss: 0.0852 56/102 [===============>..............] - ETA: 4s - loss: 0.0838 57/102 [===============>..............] - ETA: 4s - loss: 0.0830 58/102 [================>.............] - ETA: 4s - loss: 0.0817 59/102 [================>.............] - ETA: 4s - loss: 0.0809 60/102 [================>.............] - ETA: 4s - loss: 0.0799 61/102 [================>.............] - ETA: 4s - loss: 0.0790 62/102 [=================>............] - ETA: 3s - loss: 0.0783 63/102 [=================>............] - ETA: 3s - loss: 0.0774 64/102 [=================>............] - ETA: 3s - loss: 0.0764 65/102 [==================>...........] - ETA: 3s - loss: 0.0754 66/102 [==================>...........] - ETA: 3s - loss: 0.0748 67/102 [==================>...........] - ETA: 3s - loss: 0.0738 68/102 [===================>..........] - ETA: 3s - loss: 0.0731 69/102 [===================>..........] - ETA: 3s - loss: 0.0722 70/102 [===================>..........] - ETA: 3s - loss: 0.0715 71/102 [===================>..........] - ETA: 3s - loss: 0.0707 72/102 [====================>.........] - ETA: 2s - loss: 0.0699 73/102 [====================>.........] - ETA: 2s - loss: 0.0693 74/102 [====================>.........] - ETA: 2s - loss: 0.0689 75/102 [=====================>........] - ETA: 2s - loss: 0.0683 76/102 [=====================>........] - ETA: 2s - loss: 0.0675 77/102 [=====================>........] - ETA: 2s - loss: 0.0669 78/102 [=====================>........] - ETA: 2s - loss: 0.0662 79/102 [======================>.......] - ETA: 2s - loss: 0.0655 80/102 [======================>.......] - ETA: 2s - loss: 0.0648 81/102 [======================>.......] - ETA: 2s - loss: 0.0643 82/102 [=======================>......] - ETA: 1s - loss: 0.0636 83/102 [=======================>......] - ETA: 1s - loss: 0.0630 84/102 [=======================>......] - ETA: 1s - loss: 0.0623 85/102 [========================>.....] - ETA: 1s - loss: 0.0618 86/102 [========================>.....] - ETA: 1s - loss: 0.0613 87/102 [========================>.....] - ETA: 1s - loss: 0.0609 88/102 [========================>.....] - ETA: 1s - loss: 0.0605 89/102 [=========================>....] - ETA: 1s - loss: 0.0600 90/102 [=========================>....] - ETA: 1s - loss: 0.0597 91/102 [=========================>....] - ETA: 1s - loss: 0.0593 92/102 [==========================>...] - ETA: 0s - loss: 0.0589 93/102 [==========================>...] - ETA: 0s - loss: 0.0585 94/102 [==========================>...] - ETA: 0s - loss: 0.0581 95/102 [==========================>...] - ETA: 0s - loss: 0.0579 96/102 [===========================>..] - ETA: 0s - loss: 0.0574 97/102 [===========================>..] - ETA: 0s - loss: 0.0570 98/102 [===========================>..] - ETA: 0s - loss: 0.0566 99/102 [============================>.] - ETA: 0s - loss: 0.0561100/102 [============================>.] - ETA: 0s - loss: 0.0558101/102 [============================>.] - ETA: 0s - loss: 0.0554102/102 [==============================] - ETA: 0s - loss: 0.0555102/102 [==============================] - 20s 112ms/step - loss: 0.0555 - val_loss: 0.0126 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 9s - loss: 0.0143  2/102 [..............................] - ETA: 9s - loss: 0.0102  3/102 [..............................] - ETA: 9s - loss: 0.0141  4/102 [>.............................] - ETA: 9s - loss: 0.0143  5/102 [>.............................] - ETA: 9s - loss: 0.0173  6/102 [>.............................] - ETA: 9s - loss: 0.0172  7/102 [=>............................] - ETA: 9s - loss: 0.0178  8/102 [=>............................] - ETA: 9s - loss: 0.0208  9/102 [=>............................] - ETA: 9s - loss: 0.0202 10/102 [=>............................] - ETA: 9s - loss: 0.0215 11/102 [==>...........................] - ETA: 8s - loss: 0.0211 12/102 [==>...........................] - ETA: 8s - loss: 0.0215 13/102 [==>...........................] - ETA: 8s - loss: 0.0215 14/102 [===>..........................] - ETA: 8s - loss: 0.0218 15/102 [===>..........................] - ETA: 8s - loss: 0.0220 16/102 [===>..........................] - ETA: 8s - loss: 0.0222 17/102 [====>.........................] - ETA: 8s - loss: 0.0219 18/102 [====>.........................] - ETA: 8s - loss: 0.0214 19/102 [====>.........................] - ETA: 8s - loss: 0.0211 20/102 [====>.........................] - ETA: 8s - loss: 0.0218 21/102 [=====>........................] - ETA: 8s - loss: 0.0215 22/102 [=====>........................] - ETA: 7s - loss: 0.0209 23/102 [=====>........................] - ETA: 7s - loss: 0.0206 24/102 [======>.......................] - ETA: 7s - loss: 0.0204 25/102 [======>.......................] - ETA: 7s - loss: 0.0204 26/102 [======>.......................] - ETA: 7s - loss: 0.0202 27/102 [======>.......................] - ETA: 7s - loss: 0.0199 28/102 [=======>......................] - ETA: 7s - loss: 0.0196 29/102 [=======>......................] - ETA: 7s - loss: 0.0195 30/102 [=======>......................] - ETA: 7s - loss: 0.0193 31/102 [========>.....................] - ETA: 7s - loss: 0.0192 32/102 [========>.....................] - ETA: 6s - loss: 0.0200 33/102 [========>.....................] - ETA: 6s - loss: 0.0209 34/102 [=========>....................] - ETA: 6s - loss: 0.0208 35/102 [=========>....................] - ETA: 6s - loss: 0.0212 36/102 [=========>....................] - ETA: 6s - loss: 0.0212 37/102 [=========>....................] - ETA: 6s - loss: 0.0215 38/102 [==========>...................] - ETA: 6s - loss: 0.0218 39/102 [==========>...................] - ETA: 6s - loss: 0.0215 40/102 [==========>...................] - ETA: 6s - loss: 0.0218 41/102 [===========>..................] - ETA: 6s - loss: 0.0215 42/102 [===========>..................] - ETA: 5s - loss: 0.0216 43/102 [===========>..................] - ETA: 5s - loss: 0.0220 44/102 [===========>..................] - ETA: 5s - loss: 0.0219 45/102 [============>.................] - ETA: 5s - loss: 0.0218 46/102 [============>.................] - ETA: 5s - loss: 0.0218 47/102 [============>.................] - ETA: 5s - loss: 0.0215 48/102 [=============>................] - ETA: 5s - loss: 0.0212 49/102 [=============>................] - ETA: 5s - loss: 0.0212 50/102 [=============>................] - ETA: 5s - loss: 0.0210 51/102 [==============>...............] - ETA: 5s - loss: 0.0208 52/102 [==============>...............] - ETA: 4s - loss: 0.0206 53/102 [==============>...............] - ETA: 4s - loss: 0.0204 54/102 [==============>...............] - ETA: 4s - loss: 0.0205 55/102 [===============>..............] - ETA: 4s - loss: 0.0205 56/102 [===============>..............] - ETA: 4s - loss: 0.0205 57/102 [===============>..............] - ETA: 4s - loss: 0.0204 58/102 [================>.............] - ETA: 4s - loss: 0.0203 59/102 [================>.............] - ETA: 4s - loss: 0.0202 60/102 [================>.............] - ETA: 4s - loss: 0.0200 61/102 [================>.............] - ETA: 4s - loss: 0.0199 62/102 [=================>............] - ETA: 3s - loss: 0.0201 63/102 [=================>............] - ETA: 3s - loss: 0.0201 64/102 [=================>............] - ETA: 3s - loss: 0.0201 65/102 [==================>...........] - ETA: 3s - loss: 0.0202 66/102 [==================>...........] - ETA: 3s - loss: 0.0202 67/102 [==================>...........] - ETA: 3s - loss: 0.0202 68/102 [===================>..........] - ETA: 3s - loss: 0.0201 69/102 [===================>..........] - ETA: 3s - loss: 0.0200 70/102 [===================>..........] - ETA: 3s - loss: 0.0200 71/102 [===================>..........] - ETA: 3s - loss: 0.0200 72/102 [====================>.........] - ETA: 2s - loss: 0.0198 73/102 [====================>.........] - ETA: 2s - loss: 0.0198 74/102 [====================>.........] - ETA: 2s - loss: 0.0199 75/102 [=====================>........] - ETA: 2s - loss: 0.0197 76/102 [=====================>........] - ETA: 2s - loss: 0.0196 77/102 [=====================>........] - ETA: 2s - loss: 0.0195 78/102 [=====================>........] - ETA: 2s - loss: 0.0195 79/102 [======================>.......] - ETA: 2s - loss: 0.0193 80/102 [======================>.......] - ETA: 2s - loss: 0.0191 81/102 [======================>.......] - ETA: 2s - loss: 0.0190 82/102 [=======================>......] - ETA: 1s - loss: 0.0193 83/102 [=======================>......] - ETA: 1s - loss: 0.0191 84/102 [=======================>......] - ETA: 1s - loss: 0.0194 85/102 [========================>.....] - ETA: 1s - loss: 0.0195 86/102 [========================>.....] - ETA: 1s - loss: 0.0195 87/102 [========================>.....] - ETA: 1s - loss: 0.0194 88/102 [========================>.....] - ETA: 1s - loss: 0.0195 89/102 [=========================>....] - ETA: 1s - loss: 0.0194 90/102 [=========================>....] - ETA: 1s - loss: 0.0193 91/102 [=========================>....] - ETA: 1s - loss: 0.0192 92/102 [==========================>...] - ETA: 0s - loss: 0.0192 93/102 [==========================>...] - ETA: 0s - loss: 0.0192 94/102 [==========================>...] - ETA: 0s - loss: 0.0191 95/102 [==========================>...] - ETA: 0s - loss: 0.0190 96/102 [===========================>..] - ETA: 0s - loss: 0.0191 97/102 [===========================>..] - ETA: 0s - loss: 0.0190 98/102 [===========================>..] - ETA: 0s - loss: 0.0190 99/102 [============================>.] - ETA: 0s - loss: 0.0189100/102 [============================>.] - ETA: 0s - loss: 0.0190101/102 [============================>.] - ETA: 0s - loss: 0.0189102/102 [==============================] - ETA: 0s - loss: 0.0189102/102 [==============================] - 10s 103ms/step - loss: 0.0189 - val_loss: 0.0083 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 12s - loss: 0.0129  2/102 [..............................] - ETA: 9s - loss: 0.0207   3/102 [..............................] - ETA: 9s - loss: 0.0222  4/102 [>.............................] - ETA: 9s - loss: 0.0217  5/102 [>.............................] - ETA: 9s - loss: 0.0269  6/102 [>.............................] - ETA: 9s - loss: 0.0250  7/102 [=>............................] - ETA: 9s - loss: 0.0227  8/102 [=>............................] - ETA: 9s - loss: 0.0248  9/102 [=>............................] - ETA: 9s - loss: 0.0236 10/102 [=>............................] - ETA: 9s - loss: 0.0223 11/102 [==>...........................] - ETA: 9s - loss: 0.0210 12/102 [==>...........................] - ETA: 9s - loss: 0.0211 13/102 [==>...........................] - ETA: 8s - loss: 0.0205 14/102 [===>..........................] - ETA: 8s - loss: 0.0197 15/102 [===>..........................] - ETA: 8s - loss: 0.0198 16/102 [===>..........................] - ETA: 8s - loss: 0.0203 17/102 [====>.........................] - ETA: 8s - loss: 0.0210 18/102 [====>.........................] - ETA: 8s - loss: 0.0206 19/102 [====>.........................] - ETA: 8s - loss: 0.0206 20/102 [====>.........................] - ETA: 8s - loss: 0.0202 21/102 [=====>........................] - ETA: 8s - loss: 0.0201 22/102 [=====>........................] - ETA: 7s - loss: 0.0205 23/102 [=====>........................] - ETA: 7s - loss: 0.0202 24/102 [======>.......................] - ETA: 7s - loss: 0.0199 25/102 [======>.......................] - ETA: 7s - loss: 0.0198 26/102 [======>.......................] - ETA: 7s - loss: 0.0194 27/102 [======>.......................] - ETA: 7s - loss: 0.0192 28/102 [=======>......................] - ETA: 7s - loss: 0.0193 29/102 [=======>......................] - ETA: 7s - loss: 0.0191 30/102 [=======>......................] - ETA: 7s - loss: 0.0198 31/102 [========>.....................] - ETA: 7s - loss: 0.0195 32/102 [========>.....................] - ETA: 6s - loss: 0.0195 33/102 [========>.....................] - ETA: 6s - loss: 0.0192 34/102 [=========>....................] - ETA: 6s - loss: 0.0189 35/102 [=========>....................] - ETA: 6s - loss: 0.0188 36/102 [=========>....................] - ETA: 6s - loss: 0.0186 37/102 [=========>....................] - ETA: 6s - loss: 0.0189 38/102 [==========>...................] - ETA: 6s - loss: 0.0190 39/102 [==========>...................] - ETA: 6s - loss: 0.0186 40/102 [==========>...................] - ETA: 6s - loss: 0.0187 41/102 [===========>..................] - ETA: 6s - loss: 0.0189 42/102 [===========>..................] - ETA: 5s - loss: 0.0191 43/102 [===========>..................] - ETA: 5s - loss: 0.0192 44/102 [===========>..................] - ETA: 5s - loss: 0.0196 45/102 [============>.................] - ETA: 5s - loss: 0.0194 46/102 [============>.................] - ETA: 5s - loss: 0.0193 47/102 [============>.................] - ETA: 5s - loss: 0.0192 48/102 [=============>................] - ETA: 5s - loss: 0.0199 49/102 [=============>................] - ETA: 5s - loss: 0.0198 50/102 [=============>................] - ETA: 5s - loss: 0.0196 51/102 [==============>...............] - ETA: 5s - loss: 0.0198 52/102 [==============>...............] - ETA: 4s - loss: 0.0196 53/102 [==============>...............] - ETA: 4s - loss: 0.0194 54/102 [==============>...............] - ETA: 4s - loss: 0.0193 55/102 [===============>..............] - ETA: 4s - loss: 0.0191 56/102 [===============>..............] - ETA: 4s - loss: 0.0191 57/102 [===============>..............] - ETA: 4s - loss: 0.0189 58/102 [================>.............] - ETA: 4s - loss: 0.0188 59/102 [================>.............] - ETA: 4s - loss: 0.0187 60/102 [================>.............] - ETA: 4s - loss: 0.0186 61/102 [================>.............] - ETA: 4s - loss: 0.0186 62/102 [=================>............] - ETA: 3s - loss: 0.0190 63/102 [=================>............] - ETA: 3s - loss: 0.0190 64/102 [=================>............] - ETA: 3s - loss: 0.0188 65/102 [==================>...........] - ETA: 3s - loss: 0.0188 66/102 [==================>...........] - ETA: 3s - loss: 0.0186 67/102 [==================>...........] - ETA: 3s - loss: 0.0187 68/102 [===================>..........] - ETA: 3s - loss: 0.0186 69/102 [===================>..........] - ETA: 3s - loss: 0.0186 70/102 [===================>..........] - ETA: 3s - loss: 0.0187 71/102 [===================>..........] - ETA: 3s - loss: 0.0186 72/102 [====================>.........] - ETA: 2s - loss: 0.0186 73/102 [====================>.........] - ETA: 2s - loss: 0.0184 74/102 [====================>.........] - ETA: 2s - loss: 0.0185 75/102 [=====================>........] - ETA: 2s - loss: 0.0184 76/102 [=====================>........] - ETA: 2s - loss: 0.0186 77/102 [=====================>........] - ETA: 2s - loss: 0.0184 78/102 [=====================>........] - ETA: 2s - loss: 0.0186 79/102 [======================>.......] - ETA: 2s - loss: 0.0185 80/102 [======================>.......] - ETA: 2s - loss: 0.0184 81/102 [======================>.......] - ETA: 2s - loss: 0.0183 82/102 [=======================>......] - ETA: 1s - loss: 0.0183 83/102 [=======================>......] - ETA: 1s - loss: 0.0183 84/102 [=======================>......] - ETA: 1s - loss: 0.0182 85/102 [========================>.....] - ETA: 1s - loss: 0.0182 86/102 [========================>.....] - ETA: 1s - loss: 0.0180 87/102 [========================>.....] - ETA: 1s - loss: 0.0181 88/102 [========================>.....] - ETA: 1s - loss: 0.0181 89/102 [=========================>....] - ETA: 1s - loss: 0.0180 90/102 [=========================>....] - ETA: 1s - loss: 0.0180 91/102 [=========================>....] - ETA: 1s - loss: 0.0180 92/102 [==========================>...] - ETA: 0s - loss: 0.0179 93/102 [==========================>...] - ETA: 0s - loss: 0.0180 94/102 [==========================>...] - ETA: 0s - loss: 0.0183 95/102 [==========================>...] - ETA: 0s - loss: 0.0182 96/102 [===========================>..] - ETA: 0s - loss: 0.0181 97/102 [===========================>..] - ETA: 0s - loss: 0.0181 98/102 [===========================>..] - ETA: 0s - loss: 0.0181 99/102 [============================>.] - ETA: 0s - loss: 0.0180100/102 [============================>.] - ETA: 0s - loss: 0.0182101/102 [============================>.] - ETA: 0s - loss: 0.0183102/102 [==============================] - ETA: 0s - loss: 0.0183102/102 [==============================] - 11s 104ms/step - loss: 0.0183 - val_loss: 0.0087 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 12s - loss: 0.0211  2/102 [..............................] - ETA: 10s - loss: 0.0339  3/102 [..............................] - ETA: 9s - loss: 0.0255   4/102 [>.............................] - ETA: 9s - loss: 0.0223  5/102 [>.............................] - ETA: 9s - loss: 0.0208  6/102 [>.............................] - ETA: 9s - loss: 0.0191  7/102 [=>............................] - ETA: 9s - loss: 0.0176  8/102 [=>............................] - ETA: 9s - loss: 0.0169  9/102 [=>............................] - ETA: 9s - loss: 0.0168 10/102 [=>............................] - ETA: 9s - loss: 0.0161 11/102 [==>...........................] - ETA: 8s - loss: 0.0160 12/102 [==>...........................] - ETA: 8s - loss: 0.0159 13/102 [==>...........................] - ETA: 8s - loss: 0.0165 14/102 [===>..........................] - ETA: 8s - loss: 0.0165 15/102 [===>..........................] - ETA: 8s - loss: 0.0167 16/102 [===>..........................] - ETA: 8s - loss: 0.0169 17/102 [====>.........................] - ETA: 8s - loss: 0.0173 18/102 [====>.........................] - ETA: 8s - loss: 0.0175 19/102 [====>.........................] - ETA: 8s - loss: 0.0170 20/102 [====>.........................] - ETA: 8s - loss: 0.0167 21/102 [=====>........................] - ETA: 7s - loss: 0.0170 22/102 [=====>........................] - ETA: 7s - loss: 0.0182 23/102 [=====>........................] - ETA: 7s - loss: 0.0184 24/102 [======>.......................] - ETA: 7s - loss: 0.0185 25/102 [======>.......................] - ETA: 7s - loss: 0.0182 26/102 [======>.......................] - ETA: 7s - loss: 0.0179 27/102 [======>.......................] - ETA: 7s - loss: 0.0175 28/102 [=======>......................] - ETA: 7s - loss: 0.0172 29/102 [=======>......................] - ETA: 7s - loss: 0.0169 30/102 [=======>......................] - ETA: 7s - loss: 0.0167 31/102 [========>.....................] - ETA: 7s - loss: 0.0167 32/102 [========>.....................] - ETA: 6s - loss: 0.0173 33/102 [========>.....................] - ETA: 6s - loss: 0.0174 34/102 [=========>....................] - ETA: 6s - loss: 0.0173 35/102 [=========>....................] - ETA: 6s - loss: 0.0169 36/102 [=========>....................] - ETA: 6s - loss: 0.0177 37/102 [=========>....................] - ETA: 6s - loss: 0.0173 38/102 [==========>...................] - ETA: 6s - loss: 0.0174 39/102 [==========>...................] - ETA: 6s - loss: 0.0171 40/102 [==========>...................] - ETA: 6s - loss: 0.0172 41/102 [===========>..................] - ETA: 6s - loss: 0.0174 42/102 [===========>..................] - ETA: 5s - loss: 0.0174 43/102 [===========>..................] - ETA: 5s - loss: 0.0172 44/102 [===========>..................] - ETA: 5s - loss: 0.0174 45/102 [============>.................] - ETA: 5s - loss: 0.0172 46/102 [============>.................] - ETA: 5s - loss: 0.0172 47/102 [============>.................] - ETA: 5s - loss: 0.0170 48/102 [=============>................] - ETA: 5s - loss: 0.0172 49/102 [=============>................] - ETA: 5s - loss: 0.0170 50/102 [=============>................] - ETA: 5s - loss: 0.0173 51/102 [==============>...............] - ETA: 5s - loss: 0.0174 52/102 [==============>...............] - ETA: 4s - loss: 0.0175 53/102 [==============>...............] - ETA: 4s - loss: 0.0175 54/102 [==============>...............] - ETA: 4s - loss: 0.0173 55/102 [===============>..............] - ETA: 4s - loss: 0.0174 56/102 [===============>..............] - ETA: 4s - loss: 0.0176 57/102 [===============>..............] - ETA: 4s - loss: 0.0174 58/102 [================>.............] - ETA: 4s - loss: 0.0175 59/102 [================>.............] - ETA: 4s - loss: 0.0175 60/102 [================>.............] - ETA: 4s - loss: 0.0176 61/102 [================>.............] - ETA: 4s - loss: 0.0176 62/102 [=================>............] - ETA: 3s - loss: 0.0175 63/102 [=================>............] - ETA: 3s - loss: 0.0177 64/102 [=================>............] - ETA: 3s - loss: 0.0179 65/102 [==================>...........] - ETA: 3s - loss: 0.0179 66/102 [==================>...........] - ETA: 3s - loss: 0.0179 67/102 [==================>...........] - ETA: 3s - loss: 0.0181 68/102 [===================>..........] - ETA: 3s - loss: 0.0179 69/102 [===================>..........] - ETA: 3s - loss: 0.0181 70/102 [===================>..........] - ETA: 3s - loss: 0.0182 71/102 [===================>..........] - ETA: 3s - loss: 0.0180 72/102 [====================>.........] - ETA: 2s - loss: 0.0180 73/102 [====================>.........] - ETA: 2s - loss: 0.0178 74/102 [====================>.........] - ETA: 2s - loss: 0.0180 75/102 [=====================>........] - ETA: 2s - loss: 0.0180 76/102 [=====================>........] - ETA: 2s - loss: 0.0178 77/102 [=====================>........] - ETA: 2s - loss: 0.0176 78/102 [=====================>........] - ETA: 2s - loss: 0.0175 79/102 [======================>.......] - ETA: 2s - loss: 0.0173 80/102 [======================>.......] - ETA: 2s - loss: 0.0172 81/102 [======================>.......] - ETA: 2s - loss: 0.0174 82/102 [=======================>......] - ETA: 1s - loss: 0.0173 83/102 [=======================>......] - ETA: 1s - loss: 0.0172 84/102 [=======================>......] - ETA: 1s - loss: 0.0173 85/102 [========================>.....] - ETA: 1s - loss: 0.0172 86/102 [========================>.....] - ETA: 1s - loss: 0.0174 87/102 [========================>.....] - ETA: 1s - loss: 0.0174 88/102 [========================>.....] - ETA: 1s - loss: 0.0176 89/102 [=========================>....] - ETA: 1s - loss: 0.0175 90/102 [=========================>....] - ETA: 1s - loss: 0.0176 91/102 [=========================>....] - ETA: 1s - loss: 0.0176 92/102 [==========================>...] - ETA: 0s - loss: 0.0177 93/102 [==========================>...] - ETA: 0s - loss: 0.0176 94/102 [==========================>...] - ETA: 0s - loss: 0.0176 95/102 [==========================>...] - ETA: 0s - loss: 0.0176 96/102 [===========================>..] - ETA: 0s - loss: 0.0176 97/102 [===========================>..] - ETA: 0s - loss: 0.0175 98/102 [===========================>..] - ETA: 0s - loss: 0.0175 99/102 [============================>.] - ETA: 0s - loss: 0.0174100/102 [============================>.] - ETA: 0s - loss: 0.0175101/102 [============================>.] - ETA: 0s - loss: 0.0175102/102 [==============================] - ETA: 0s - loss: 0.0175102/102 [==============================] - 11s 104ms/step - loss: 0.0175 - val_loss: 0.0088 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 11s - loss: 0.0130  2/102 [..............................] - ETA: 9s - loss: 0.0157   3/102 [..............................] - ETA: 9s - loss: 0.0148  4/102 [>.............................] - ETA: 9s - loss: 0.0174  5/102 [>.............................] - ETA: 9s - loss: 0.0198  6/102 [>.............................] - ETA: 9s - loss: 0.0176  7/102 [=>............................] - ETA: 9s - loss: 0.0185  8/102 [=>............................] - ETA: 9s - loss: 0.0197  9/102 [=>............................] - ETA: 9s - loss: 0.0195 10/102 [=>............................] - ETA: 9s - loss: 0.0198 11/102 [==>...........................] - ETA: 9s - loss: 0.0195 12/102 [==>...........................] - ETA: 8s - loss: 0.0187 13/102 [==>...........................] - ETA: 8s - loss: 0.0185 14/102 [===>..........................] - ETA: 8s - loss: 0.0186 15/102 [===>..........................] - ETA: 8s - loss: 0.0191 16/102 [===>..........................] - ETA: 8s - loss: 0.0192 17/102 [====>.........................] - ETA: 8s - loss: 0.0184 18/102 [====>.........................] - ETA: 8s - loss: 0.0181 19/102 [====>.........................] - ETA: 8s - loss: 0.0175 20/102 [====>.........................] - ETA: 8s - loss: 0.0174 21/102 [=====>........................] - ETA: 8s - loss: 0.0181 22/102 [=====>........................] - ETA: 7s - loss: 0.0179 23/102 [=====>........................] - ETA: 7s - loss: 0.0175 24/102 [======>.......................] - ETA: 7s - loss: 0.0176 25/102 [======>.......................] - ETA: 7s - loss: 0.0176 26/102 [======>.......................] - ETA: 7s - loss: 0.0171 27/102 [======>.......................] - ETA: 7s - loss: 0.0174 28/102 [=======>......................] - ETA: 7s - loss: 0.0175 29/102 [=======>......................] - ETA: 7s - loss: 0.0176 30/102 [=======>......................] - ETA: 7s - loss: 0.0178 31/102 [========>.....................] - ETA: 7s - loss: 0.0181 32/102 [========>.....................] - ETA: 6s - loss: 0.0178 33/102 [========>.....................] - ETA: 6s - loss: 0.0176 34/102 [=========>....................] - ETA: 6s - loss: 0.0176 35/102 [=========>....................] - ETA: 6s - loss: 0.0175 36/102 [=========>....................] - ETA: 6s - loss: 0.0173 37/102 [=========>....................] - ETA: 6s - loss: 0.0174 38/102 [==========>...................] - ETA: 6s - loss: 0.0171 39/102 [==========>...................] - ETA: 6s - loss: 0.0176 40/102 [==========>...................] - ETA: 6s - loss: 0.0182 41/102 [===========>..................] - ETA: 6s - loss: 0.0183 42/102 [===========>..................] - ETA: 5s - loss: 0.0181 43/102 [===========>..................] - ETA: 5s - loss: 0.0178 44/102 [===========>..................] - ETA: 5s - loss: 0.0176 45/102 [============>.................] - ETA: 5s - loss: 0.0175 46/102 [============>.................] - ETA: 5s - loss: 0.0178 47/102 [============>.................] - ETA: 5s - loss: 0.0181 48/102 [=============>................] - ETA: 5s - loss: 0.0183 49/102 [=============>................] - ETA: 5s - loss: 0.0181 50/102 [=============>................] - ETA: 5s - loss: 0.0184 51/102 [==============>...............] - ETA: 5s - loss: 0.0184 52/102 [==============>...............] - ETA: 4s - loss: 0.0186 53/102 [==============>...............] - ETA: 4s - loss: 0.0185 54/102 [==============>...............] - ETA: 4s - loss: 0.0186 55/102 [===============>..............] - ETA: 4s - loss: 0.0187 56/102 [===============>..............] - ETA: 4s - loss: 0.0187 57/102 [===============>..............] - ETA: 4s - loss: 0.0187 58/102 [================>.............] - ETA: 4s - loss: 0.0185 59/102 [================>.............] - ETA: 4s - loss: 0.0186 60/102 [================>.............] - ETA: 4s - loss: 0.0184 61/102 [================>.............] - ETA: 4s - loss: 0.0183 62/102 [=================>............] - ETA: 3s - loss: 0.0181 63/102 [=================>............] - ETA: 3s - loss: 0.0184 64/102 [=================>............] - ETA: 3s - loss: 0.0185 65/102 [==================>...........] - ETA: 3s - loss: 0.0184 66/102 [==================>...........] - ETA: 3s - loss: 0.0185 67/102 [==================>...........] - ETA: 3s - loss: 0.0183 68/102 [===================>..........] - ETA: 3s - loss: 0.0182 69/102 [===================>..........] - ETA: 3s - loss: 0.0181 70/102 [===================>..........] - ETA: 3s - loss: 0.0179 71/102 [===================>..........] - ETA: 3s - loss: 0.0178 72/102 [====================>.........] - ETA: 2s - loss: 0.0176 73/102 [====================>.........] - ETA: 2s - loss: 0.0177 74/102 [====================>.........] - ETA: 2s - loss: 0.0176 75/102 [=====================>........] - ETA: 2s - loss: 0.0179 76/102 [=====================>........] - ETA: 2s - loss: 0.0184 77/102 [=====================>........] - ETA: 2s - loss: 0.0188 78/102 [=====================>........] - ETA: 2s - loss: 0.0188 79/102 [======================>.......] - ETA: 2s - loss: 0.0187 80/102 [======================>.......] - ETA: 2s - loss: 0.0186 81/102 [======================>.......] - ETA: 2s - loss: 0.0187 82/102 [=======================>......] - ETA: 1s - loss: 0.0186 83/102 [=======================>......] - ETA: 1s - loss: 0.0186 84/102 [=======================>......] - ETA: 1s - loss: 0.0185 85/102 [========================>.....] - ETA: 1s - loss: 0.0184 86/102 [========================>.....] - ETA: 1s - loss: 0.0182 87/102 [========================>.....] - ETA: 1s - loss: 0.0181 88/102 [========================>.....] - ETA: 1s - loss: 0.0180 89/102 [=========================>....] - ETA: 1s - loss: 0.0180 90/102 [=========================>....] - ETA: 1s - loss: 0.0179 91/102 [=========================>....] - ETA: 1s - loss: 0.0178 92/102 [==========================>...] - ETA: 0s - loss: 0.0178 93/102 [==========================>...] - ETA: 0s - loss: 0.0177 94/102 [==========================>...] - ETA: 0s - loss: 0.0176 95/102 [==========================>...] - ETA: 0s - loss: 0.0175 96/102 [===========================>..] - ETA: 0s - loss: 0.0175 97/102 [===========================>..] - ETA: 0s - loss: 0.0174 98/102 [===========================>..] - ETA: 0s - loss: 0.0174 99/102 [============================>.] - ETA: 0s - loss: 0.0173100/102 [============================>.] - ETA: 0s - loss: 0.0172101/102 [============================>.] - ETA: 0s - loss: 0.0172102/102 [==============================] - ETA: 0s - loss: 0.0172102/102 [==============================] - 11s 104ms/step - loss: 0.0172 - val_loss: 0.0083 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.0256 5/16 [========>.....................] - ETA: 0s - loss: 0.0382 9/16 [===============>..............] - ETA: 0s - loss: 0.032513/16 [=======================>......] - ETA: 0s - loss: 0.034316/16 [==============================] - ETA: 0s - loss: 0.036416/16 [==============================] - 0s 16ms/step - loss: 0.0364
Test Loss: 0.03639093413949013
Saved model as forecasting_models_v5/model_lstm_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LSTM model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 879ms/step
Predicted QoE for the next time step: 79.45888473406201
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/lstm_deep.h5
Completed at Τετ 14 Μαΐ 2025 10:08:56 μμ EEST
=====================================================

=====================================================
Training lstm model with config: wide
Starting at Τετ 14 Μαΐ 2025 10:08:56 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type lstm                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --hidden_units 100 --attention_units 128
2025-05-14 22:08:57.073835: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:08:57.239588: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:08:57.934822: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:08:57.934915: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:08:57.934926: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:09:04.955345: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:09:05.667787: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:09:05.667812: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:09:05.667934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5558 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 5, 96)             54528     
                                                                 
 lstm_1 (LSTM)               (None, 5, 96)             74112     
                                                                 
 lstm_2 (LSTM)               (None, 5, 96)             74112     
                                                                 
 lstm_3 (LSTM)               (None, 5, 96)             74112     
                                                                 
 self_attention (SelfAttenti  (None, 96)               12544     
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                2425      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 291,859
Trainable params: 291,859
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 15:28 - loss: 0.2572  2/102 [..............................] - ETA: 8s - loss: 0.2962     3/102 [..............................] - ETA: 9s - loss: 0.3006  4/102 [>.............................] - ETA: 8s - loss: 0.3010  5/102 [>.............................] - ETA: 8s - loss: 0.3073  6/102 [>.............................] - ETA: 8s - loss: 0.3040  7/102 [=>............................] - ETA: 8s - loss: 0.2941  8/102 [=>............................] - ETA: 8s - loss: 0.2818  9/102 [=>............................] - ETA: 8s - loss: 0.2713 10/102 [=>............................] - ETA: 8s - loss: 0.2520 11/102 [==>...........................] - ETA: 8s - loss: 0.2337 12/102 [==>...........................] - ETA: 8s - loss: 0.2188 13/102 [==>...........................] - ETA: 8s - loss: 0.2071 14/102 [===>..........................] - ETA: 8s - loss: 0.2004 15/102 [===>..........................] - ETA: 8s - loss: 0.1898 16/102 [===>..........................] - ETA: 8s - loss: 0.1812 17/102 [====>.........................] - ETA: 8s - loss: 0.1723 18/102 [====>.........................] - ETA: 8s - loss: 0.1641 19/102 [====>.........................] - ETA: 8s - loss: 0.1574 20/102 [====>.........................] - ETA: 8s - loss: 0.1515 21/102 [=====>........................] - ETA: 7s - loss: 0.1469 22/102 [=====>........................] - ETA: 7s - loss: 0.1420 23/102 [=====>........................] - ETA: 7s - loss: 0.1376 24/102 [======>.......................] - ETA: 7s - loss: 0.1337 25/102 [======>.......................] - ETA: 7s - loss: 0.1294 26/102 [======>.......................] - ETA: 7s - loss: 0.1259 27/102 [======>.......................] - ETA: 7s - loss: 0.1222 28/102 [=======>......................] - ETA: 7s - loss: 0.1182 29/102 [=======>......................] - ETA: 7s - loss: 0.1147 30/102 [=======>......................] - ETA: 7s - loss: 0.1117 31/102 [========>.....................] - ETA: 6s - loss: 0.1105 32/102 [========>.....................] - ETA: 6s - loss: 0.1081 33/102 [========>.....................] - ETA: 6s - loss: 0.1065 34/102 [=========>....................] - ETA: 6s - loss: 0.1052 35/102 [=========>....................] - ETA: 6s - loss: 0.1026 36/102 [=========>....................] - ETA: 6s - loss: 0.1004 37/102 [=========>....................] - ETA: 6s - loss: 0.0989 38/102 [==========>...................] - ETA: 6s - loss: 0.0970 39/102 [==========>...................] - ETA: 6s - loss: 0.0954 40/102 [==========>...................] - ETA: 6s - loss: 0.0937 41/102 [===========>..................] - ETA: 6s - loss: 0.0920 42/102 [===========>..................] - ETA: 5s - loss: 0.0907 43/102 [===========>..................] - ETA: 5s - loss: 0.0892 44/102 [===========>..................] - ETA: 5s - loss: 0.0878 45/102 [============>.................] - ETA: 5s - loss: 0.0864 46/102 [============>.................] - ETA: 5s - loss: 0.0849 47/102 [============>.................] - ETA: 5s - loss: 0.0835 48/102 [=============>................] - ETA: 5s - loss: 0.0823 49/102 [=============>................] - ETA: 5s - loss: 0.0808 50/102 [=============>................] - ETA: 5s - loss: 0.0798 51/102 [==============>...............] - ETA: 5s - loss: 0.0786 52/102 [==============>...............] - ETA: 4s - loss: 0.0775 53/102 [==============>...............] - ETA: 4s - loss: 0.0763 54/102 [==============>...............] - ETA: 4s - loss: 0.0755 55/102 [===============>..............] - ETA: 4s - loss: 0.0743 56/102 [===============>..............] - ETA: 4s - loss: 0.0733 57/102 [===============>..............] - ETA: 4s - loss: 0.0722 58/102 [================>.............] - ETA: 4s - loss: 0.0711 59/102 [================>.............] - ETA: 4s - loss: 0.0705 60/102 [================>.............] - ETA: 4s - loss: 0.0700 61/102 [================>.............] - ETA: 4s - loss: 0.0692 62/102 [=================>............] - ETA: 3s - loss: 0.0684 63/102 [=================>............] - ETA: 3s - loss: 0.0677 64/102 [=================>............] - ETA: 3s - loss: 0.0668 65/102 [==================>...........] - ETA: 3s - loss: 0.0660 66/102 [==================>...........] - ETA: 3s - loss: 0.0655 67/102 [==================>...........] - ETA: 3s - loss: 0.0647 68/102 [===================>..........] - ETA: 3s - loss: 0.0640 69/102 [===================>..........] - ETA: 3s - loss: 0.0636 70/102 [===================>..........] - ETA: 3s - loss: 0.0629 71/102 [===================>..........] - ETA: 3s - loss: 0.0624 72/102 [====================>.........] - ETA: 2s - loss: 0.0619 73/102 [====================>.........] - ETA: 2s - loss: 0.0614 74/102 [====================>.........] - ETA: 2s - loss: 0.0608 75/102 [=====================>........] - ETA: 2s - loss: 0.0602 76/102 [=====================>........] - ETA: 2s - loss: 0.0597 77/102 [=====================>........] - ETA: 2s - loss: 0.0593 78/102 [=====================>........] - ETA: 2s - loss: 0.0587 79/102 [======================>.......] - ETA: 2s - loss: 0.0582 80/102 [======================>.......] - ETA: 2s - loss: 0.0576 81/102 [======================>.......] - ETA: 2s - loss: 0.0571 82/102 [=======================>......] - ETA: 1s - loss: 0.0565 83/102 [=======================>......] - ETA: 1s - loss: 0.0562 84/102 [=======================>......] - ETA: 1s - loss: 0.0557 85/102 [========================>.....] - ETA: 1s - loss: 0.0552 86/102 [========================>.....] - ETA: 1s - loss: 0.0548 87/102 [========================>.....] - ETA: 1s - loss: 0.0543 88/102 [========================>.....] - ETA: 1s - loss: 0.0538 89/102 [=========================>....] - ETA: 1s - loss: 0.0533 90/102 [=========================>....] - ETA: 1s - loss: 0.0532 91/102 [=========================>....] - ETA: 1s - loss: 0.0527 92/102 [==========================>...] - ETA: 0s - loss: 0.0522 93/102 [==========================>...] - ETA: 0s - loss: 0.0519 94/102 [==========================>...] - ETA: 0s - loss: 0.0515 95/102 [==========================>...] - ETA: 0s - loss: 0.0511 96/102 [===========================>..] - ETA: 0s - loss: 0.0507 97/102 [===========================>..] - ETA: 0s - loss: 0.0503 98/102 [===========================>..] - ETA: 0s - loss: 0.0501 99/102 [============================>.] - ETA: 0s - loss: 0.0497100/102 [============================>.] - ETA: 0s - loss: 0.0495101/102 [============================>.] - ETA: 0s - loss: 0.0493102/102 [==============================] - ETA: 0s - loss: 0.0493102/102 [==============================] - 21s 114ms/step - loss: 0.0493 - val_loss: 0.0103 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 9s - loss: 0.0074  2/102 [..............................] - ETA: 8s - loss: 0.0159  3/102 [..............................] - ETA: 9s - loss: 0.0197  4/102 [>.............................] - ETA: 9s - loss: 0.0227  5/102 [>.............................] - ETA: 9s - loss: 0.0210  6/102 [>.............................] - ETA: 9s - loss: 0.0203  7/102 [=>............................] - ETA: 9s - loss: 0.0201  8/102 [=>............................] - ETA: 9s - loss: 0.0202  9/102 [=>............................] - ETA: 9s - loss: 0.0189 10/102 [=>............................] - ETA: 9s - loss: 0.0180 11/102 [==>...........................] - ETA: 9s - loss: 0.0185 12/102 [==>...........................] - ETA: 8s - loss: 0.0182 13/102 [==>...........................] - ETA: 8s - loss: 0.0176 14/102 [===>..........................] - ETA: 8s - loss: 0.0181 15/102 [===>..........................] - ETA: 8s - loss: 0.0183 16/102 [===>..........................] - ETA: 8s - loss: 0.0192 17/102 [====>.........................] - ETA: 8s - loss: 0.0187 18/102 [====>.........................] - ETA: 8s - loss: 0.0180 19/102 [====>.........................] - ETA: 8s - loss: 0.0180 20/102 [====>.........................] - ETA: 8s - loss: 0.0191 21/102 [=====>........................] - ETA: 8s - loss: 0.0205 22/102 [=====>........................] - ETA: 7s - loss: 0.0200 23/102 [=====>........................] - ETA: 7s - loss: 0.0196 24/102 [======>.......................] - ETA: 7s - loss: 0.0192 25/102 [======>.......................] - ETA: 7s - loss: 0.0190 26/102 [======>.......................] - ETA: 7s - loss: 0.0186 27/102 [======>.......................] - ETA: 7s - loss: 0.0193 28/102 [=======>......................] - ETA: 7s - loss: 0.0200 29/102 [=======>......................] - ETA: 7s - loss: 0.0197 30/102 [=======>......................] - ETA: 7s - loss: 0.0198 31/102 [========>.....................] - ETA: 7s - loss: 0.0195 32/102 [========>.....................] - ETA: 6s - loss: 0.0198 33/102 [========>.....................] - ETA: 6s - loss: 0.0199 34/102 [=========>....................] - ETA: 6s - loss: 0.0195 35/102 [=========>....................] - ETA: 6s - loss: 0.0194 36/102 [=========>....................] - ETA: 6s - loss: 0.0198 37/102 [=========>....................] - ETA: 6s - loss: 0.0206 38/102 [==========>...................] - ETA: 6s - loss: 0.0203 39/102 [==========>...................] - ETA: 6s - loss: 0.0200 40/102 [==========>...................] - ETA: 6s - loss: 0.0199 41/102 [===========>..................] - ETA: 6s - loss: 0.0197 42/102 [===========>..................] - ETA: 5s - loss: 0.0197 43/102 [===========>..................] - ETA: 5s - loss: 0.0197 44/102 [===========>..................] - ETA: 5s - loss: 0.0198 45/102 [============>.................] - ETA: 5s - loss: 0.0200 46/102 [============>.................] - ETA: 5s - loss: 0.0199 47/102 [============>.................] - ETA: 5s - loss: 0.0204 48/102 [=============>................] - ETA: 5s - loss: 0.0202 49/102 [=============>................] - ETA: 5s - loss: 0.0201 50/102 [=============>................] - ETA: 5s - loss: 0.0199 51/102 [==============>...............] - ETA: 5s - loss: 0.0198 52/102 [==============>...............] - ETA: 4s - loss: 0.0195 53/102 [==============>...............] - ETA: 4s - loss: 0.0195 54/102 [==============>...............] - ETA: 4s - loss: 0.0195 55/102 [===============>..............] - ETA: 4s - loss: 0.0192 56/102 [===============>..............] - ETA: 4s - loss: 0.0194 57/102 [===============>..............] - ETA: 4s - loss: 0.0197 58/102 [================>.............] - ETA: 4s - loss: 0.0201 59/102 [================>.............] - ETA: 4s - loss: 0.0199 60/102 [================>.............] - ETA: 4s - loss: 0.0199 61/102 [================>.............] - ETA: 4s - loss: 0.0200 62/102 [=================>............] - ETA: 3s - loss: 0.0198 63/102 [=================>............] - ETA: 3s - loss: 0.0197 64/102 [=================>............] - ETA: 3s - loss: 0.0198 65/102 [==================>...........] - ETA: 3s - loss: 0.0196 66/102 [==================>...........] - ETA: 3s - loss: 0.0197 67/102 [==================>...........] - ETA: 3s - loss: 0.0195 68/102 [===================>..........] - ETA: 3s - loss: 0.0193 69/102 [===================>..........] - ETA: 3s - loss: 0.0196 70/102 [===================>..........] - ETA: 3s - loss: 0.0194 71/102 [===================>..........] - ETA: 3s - loss: 0.0193 72/102 [====================>.........] - ETA: 3s - loss: 0.0194 73/102 [====================>.........] - ETA: 2s - loss: 0.0194 74/102 [====================>.........] - ETA: 2s - loss: 0.0195 75/102 [=====================>........] - ETA: 2s - loss: 0.0193 76/102 [=====================>........] - ETA: 2s - loss: 0.0193 77/102 [=====================>........] - ETA: 2s - loss: 0.0192 78/102 [=====================>........] - ETA: 2s - loss: 0.0191 79/102 [======================>.......] - ETA: 2s - loss: 0.0192 80/102 [======================>.......] - ETA: 2s - loss: 0.0191 81/102 [======================>.......] - ETA: 2s - loss: 0.0191 82/102 [=======================>......] - ETA: 2s - loss: 0.0190 83/102 [=======================>......] - ETA: 1s - loss: 0.0190 84/102 [=======================>......] - ETA: 1s - loss: 0.0189 85/102 [========================>.....] - ETA: 1s - loss: 0.0188 86/102 [========================>.....] - ETA: 1s - loss: 0.0193 87/102 [========================>.....] - ETA: 1s - loss: 0.0195 88/102 [========================>.....] - ETA: 1s - loss: 0.0193 89/102 [=========================>....] - ETA: 1s - loss: 0.0193 90/102 [=========================>....] - ETA: 1s - loss: 0.0193 91/102 [=========================>....] - ETA: 1s - loss: 0.0194 92/102 [==========================>...] - ETA: 1s - loss: 0.0193 93/102 [==========================>...] - ETA: 0s - loss: 0.0192 94/102 [==========================>...] - ETA: 0s - loss: 0.0193 95/102 [==========================>...] - ETA: 0s - loss: 0.0193 96/102 [===========================>..] - ETA: 0s - loss: 0.0194 97/102 [===========================>..] - ETA: 0s - loss: 0.0193 98/102 [===========================>..] - ETA: 0s - loss: 0.0194 99/102 [============================>.] - ETA: 0s - loss: 0.0193100/102 [============================>.] - ETA: 0s - loss: 0.0195101/102 [============================>.] - ETA: 0s - loss: 0.0194102/102 [==============================] - ETA: 0s - loss: 0.0194102/102 [==============================] - 11s 105ms/step - loss: 0.0194 - val_loss: 0.0079 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 10s - loss: 0.0124  2/102 [..............................] - ETA: 9s - loss: 0.0154   3/102 [..............................] - ETA: 9s - loss: 0.0169  4/102 [>.............................] - ETA: 9s - loss: 0.0178  5/102 [>.............................] - ETA: 9s - loss: 0.0159  6/102 [>.............................] - ETA: 9s - loss: 0.0143  7/102 [=>............................] - ETA: 9s - loss: 0.0140  8/102 [=>............................] - ETA: 9s - loss: 0.0134  9/102 [=>............................] - ETA: 9s - loss: 0.0131 10/102 [=>............................] - ETA: 9s - loss: 0.0136 11/102 [==>...........................] - ETA: 9s - loss: 0.0144 12/102 [==>...........................] - ETA: 9s - loss: 0.0147 13/102 [==>...........................] - ETA: 8s - loss: 0.0145 14/102 [===>..........................] - ETA: 8s - loss: 0.0152 15/102 [===>..........................] - ETA: 8s - loss: 0.0153 16/102 [===>..........................] - ETA: 8s - loss: 0.0155 17/102 [====>.........................] - ETA: 8s - loss: 0.0154 18/102 [====>.........................] - ETA: 8s - loss: 0.0156 19/102 [====>.........................] - ETA: 8s - loss: 0.0161 20/102 [====>.........................] - ETA: 8s - loss: 0.0159 21/102 [=====>........................] - ETA: 8s - loss: 0.0158 22/102 [=====>........................] - ETA: 7s - loss: 0.0163 23/102 [=====>........................] - ETA: 7s - loss: 0.0165 24/102 [======>.......................] - ETA: 7s - loss: 0.0165 25/102 [======>.......................] - ETA: 7s - loss: 0.0174 26/102 [======>.......................] - ETA: 7s - loss: 0.0175 27/102 [======>.......................] - ETA: 7s - loss: 0.0171 28/102 [=======>......................] - ETA: 7s - loss: 0.0175 29/102 [=======>......................] - ETA: 7s - loss: 0.0173 30/102 [=======>......................] - ETA: 7s - loss: 0.0177 31/102 [========>.....................] - ETA: 7s - loss: 0.0181 32/102 [========>.....................] - ETA: 7s - loss: 0.0178 33/102 [========>.....................] - ETA: 6s - loss: 0.0179 34/102 [=========>....................] - ETA: 6s - loss: 0.0189 35/102 [=========>....................] - ETA: 6s - loss: 0.0188 36/102 [=========>....................] - ETA: 6s - loss: 0.0191 37/102 [=========>....................] - ETA: 6s - loss: 0.0195 38/102 [==========>...................] - ETA: 6s - loss: 0.0195 39/102 [==========>...................] - ETA: 6s - loss: 0.0194 40/102 [==========>...................] - ETA: 6s - loss: 0.0193 41/102 [===========>..................] - ETA: 6s - loss: 0.0194 42/102 [===========>..................] - ETA: 6s - loss: 0.0193 43/102 [===========>..................] - ETA: 5s - loss: 0.0192 44/102 [===========>..................] - ETA: 5s - loss: 0.0194 45/102 [============>.................] - ETA: 5s - loss: 0.0192 46/102 [============>.................] - ETA: 5s - loss: 0.0192 47/102 [============>.................] - ETA: 5s - loss: 0.0190 48/102 [=============>................] - ETA: 5s - loss: 0.0190 49/102 [=============>................] - ETA: 5s - loss: 0.0190 50/102 [=============>................] - ETA: 5s - loss: 0.0188 51/102 [==============>...............] - ETA: 5s - loss: 0.0189 52/102 [==============>...............] - ETA: 5s - loss: 0.0190 53/102 [==============>...............] - ETA: 4s - loss: 0.0191 54/102 [==============>...............] - ETA: 4s - loss: 0.0192 55/102 [===============>..............] - ETA: 4s - loss: 0.0193 56/102 [===============>..............] - ETA: 4s - loss: 0.0192 57/102 [===============>..............] - ETA: 4s - loss: 0.0191 58/102 [================>.............] - ETA: 4s - loss: 0.0189 59/102 [================>.............] - ETA: 4s - loss: 0.0189 60/102 [================>.............] - ETA: 4s - loss: 0.0187 61/102 [================>.............] - ETA: 4s - loss: 0.0187 62/102 [=================>............] - ETA: 4s - loss: 0.0185 63/102 [=================>............] - ETA: 3s - loss: 0.0183 64/102 [=================>............] - ETA: 3s - loss: 0.0185 65/102 [==================>...........] - ETA: 3s - loss: 0.0184 66/102 [==================>...........] - ETA: 3s - loss: 0.0183 67/102 [==================>...........] - ETA: 3s - loss: 0.0184 68/102 [===================>..........] - ETA: 3s - loss: 0.0185 69/102 [===================>..........] - ETA: 3s - loss: 0.0187 70/102 [===================>..........] - ETA: 3s - loss: 0.0186 71/102 [===================>..........] - ETA: 3s - loss: 0.0187 72/102 [====================>.........] - ETA: 3s - loss: 0.0186 73/102 [====================>.........] - ETA: 2s - loss: 0.0186 74/102 [====================>.........] - ETA: 2s - loss: 0.0188 75/102 [=====================>........] - ETA: 2s - loss: 0.0187 76/102 [=====================>........] - ETA: 2s - loss: 0.0189 77/102 [=====================>........] - ETA: 2s - loss: 0.0188 78/102 [=====================>........] - ETA: 2s - loss: 0.0189 79/102 [======================>.......] - ETA: 2s - loss: 0.0189 80/102 [======================>.......] - ETA: 2s - loss: 0.0190 81/102 [======================>.......] - ETA: 2s - loss: 0.0191 82/102 [=======================>......] - ETA: 2s - loss: 0.0191 83/102 [=======================>......] - ETA: 1s - loss: 0.0189 84/102 [=======================>......] - ETA: 1s - loss: 0.0188 85/102 [========================>.....] - ETA: 1s - loss: 0.0188 86/102 [========================>.....] - ETA: 1s - loss: 0.0188 87/102 [========================>.....] - ETA: 1s - loss: 0.0188 88/102 [========================>.....] - ETA: 1s - loss: 0.0187 89/102 [=========================>....] - ETA: 1s - loss: 0.0187 90/102 [=========================>....] - ETA: 1s - loss: 0.0187 91/102 [=========================>....] - ETA: 1s - loss: 0.0186 92/102 [==========================>...] - ETA: 1s - loss: 0.0185 93/102 [==========================>...] - ETA: 0s - loss: 0.0186 94/102 [==========================>...] - ETA: 0s - loss: 0.0187 95/102 [==========================>...] - ETA: 0s - loss: 0.0187 96/102 [===========================>..] - ETA: 0s - loss: 0.0186 97/102 [===========================>..] - ETA: 0s - loss: 0.0187 98/102 [===========================>..] - ETA: 0s - loss: 0.0186 99/102 [============================>.] - ETA: 0s - loss: 0.0186100/102 [============================>.] - ETA: 0s - loss: 0.0186101/102 [============================>.] - ETA: 0s - loss: 0.0187102/102 [==============================] - ETA: 0s - loss: 0.0187102/102 [==============================] - 11s 106ms/step - loss: 0.0187 - val_loss: 0.0083 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 10s - loss: 0.0072  2/102 [..............................] - ETA: 10s - loss: 0.0107  3/102 [..............................] - ETA: 9s - loss: 0.0137   4/102 [>.............................] - ETA: 9s - loss: 0.0137  5/102 [>.............................] - ETA: 9s - loss: 0.0126  6/102 [>.............................] - ETA: 9s - loss: 0.0128  7/102 [=>............................] - ETA: 9s - loss: 0.0126  8/102 [=>............................] - ETA: 9s - loss: 0.0117  9/102 [=>............................] - ETA: 9s - loss: 0.0111 10/102 [=>............................] - ETA: 8s - loss: 0.0114 11/102 [==>...........................] - ETA: 8s - loss: 0.0121 12/102 [==>...........................] - ETA: 8s - loss: 0.0131 13/102 [==>...........................] - ETA: 8s - loss: 0.0146 14/102 [===>..........................] - ETA: 8s - loss: 0.0141 15/102 [===>..........................] - ETA: 8s - loss: 0.0151 16/102 [===>..........................] - ETA: 8s - loss: 0.0156 17/102 [====>.........................] - ETA: 8s - loss: 0.0161 18/102 [====>.........................] - ETA: 8s - loss: 0.0173 19/102 [====>.........................] - ETA: 7s - loss: 0.0178 20/102 [====>.........................] - ETA: 7s - loss: 0.0177 21/102 [=====>........................] - ETA: 7s - loss: 0.0178 22/102 [=====>........................] - ETA: 7s - loss: 0.0179 23/102 [=====>........................] - ETA: 7s - loss: 0.0175 24/102 [======>.......................] - ETA: 7s - loss: 0.0174 25/102 [======>.......................] - ETA: 7s - loss: 0.0173 26/102 [======>.......................] - ETA: 7s - loss: 0.0169 27/102 [======>.......................] - ETA: 7s - loss: 0.0172 28/102 [=======>......................] - ETA: 7s - loss: 0.0167 29/102 [=======>......................] - ETA: 6s - loss: 0.0169 30/102 [=======>......................] - ETA: 6s - loss: 0.0167 31/102 [========>.....................] - ETA: 6s - loss: 0.0169 32/102 [========>.....................] - ETA: 6s - loss: 0.0167 33/102 [========>.....................] - ETA: 6s - loss: 0.0165 34/102 [=========>....................] - ETA: 6s - loss: 0.0164 35/102 [=========>....................] - ETA: 6s - loss: 0.0165 36/102 [=========>....................] - ETA: 6s - loss: 0.0169 37/102 [=========>....................] - ETA: 6s - loss: 0.0168 38/102 [==========>...................] - ETA: 6s - loss: 0.0169 39/102 [==========>...................] - ETA: 6s - loss: 0.0167 40/102 [==========>...................] - ETA: 5s - loss: 0.0167 41/102 [===========>..................] - ETA: 5s - loss: 0.0166 42/102 [===========>..................] - ETA: 5s - loss: 0.0164 43/102 [===========>..................] - ETA: 5s - loss: 0.0162 44/102 [===========>..................] - ETA: 5s - loss: 0.0163 45/102 [============>.................] - ETA: 5s - loss: 0.0163 46/102 [============>.................] - ETA: 5s - loss: 0.0165 47/102 [============>.................] - ETA: 5s - loss: 0.0163 48/102 [=============>................] - ETA: 5s - loss: 0.0161 49/102 [=============>................] - ETA: 5s - loss: 0.0169 50/102 [=============>................] - ETA: 4s - loss: 0.0170 51/102 [==============>...............] - ETA: 4s - loss: 0.0169 52/102 [==============>...............] - ETA: 4s - loss: 0.0167 53/102 [==============>...............] - ETA: 4s - loss: 0.0167 54/102 [==============>...............] - ETA: 4s - loss: 0.0166 55/102 [===============>..............] - ETA: 4s - loss: 0.0165 56/102 [===============>..............] - ETA: 4s - loss: 0.0163 57/102 [===============>..............] - ETA: 4s - loss: 0.0166 58/102 [================>.............] - ETA: 4s - loss: 0.0165 59/102 [================>.............] - ETA: 4s - loss: 0.0163 60/102 [================>.............] - ETA: 4s - loss: 0.0165 61/102 [================>.............] - ETA: 3s - loss: 0.0164 62/102 [=================>............] - ETA: 3s - loss: 0.0162 63/102 [=================>............] - ETA: 3s - loss: 0.0166 64/102 [=================>............] - ETA: 3s - loss: 0.0165 65/102 [==================>...........] - ETA: 3s - loss: 0.0165 66/102 [==================>...........] - ETA: 3s - loss: 0.0164 67/102 [==================>...........] - ETA: 3s - loss: 0.0163 68/102 [===================>..........] - ETA: 3s - loss: 0.0163 69/102 [===================>..........] - ETA: 3s - loss: 0.0166 70/102 [===================>..........] - ETA: 3s - loss: 0.0168 71/102 [===================>..........] - ETA: 2s - loss: 0.0167 72/102 [====================>.........] - ETA: 2s - loss: 0.0167 73/102 [====================>.........] - ETA: 2s - loss: 0.0168 74/102 [====================>.........] - ETA: 2s - loss: 0.0167 75/102 [=====================>........] - ETA: 2s - loss: 0.0166 76/102 [=====================>........] - ETA: 2s - loss: 0.0167 77/102 [=====================>........] - ETA: 2s - loss: 0.0168 78/102 [=====================>........] - ETA: 2s - loss: 0.0166 79/102 [======================>.......] - ETA: 2s - loss: 0.0167 80/102 [======================>.......] - ETA: 2s - loss: 0.0168 81/102 [======================>.......] - ETA: 2s - loss: 0.0168 82/102 [=======================>......] - ETA: 1s - loss: 0.0168 83/102 [=======================>......] - ETA: 1s - loss: 0.0169 84/102 [=======================>......] - ETA: 1s - loss: 0.0169 85/102 [========================>.....] - ETA: 1s - loss: 0.0170 86/102 [========================>.....] - ETA: 1s - loss: 0.0169 87/102 [========================>.....] - ETA: 1s - loss: 0.0170 88/102 [========================>.....] - ETA: 1s - loss: 0.0172 89/102 [=========================>....] - ETA: 1s - loss: 0.0171 90/102 [=========================>....] - ETA: 1s - loss: 0.0170 91/102 [=========================>....] - ETA: 1s - loss: 0.0171 92/102 [==========================>...] - ETA: 0s - loss: 0.0172 93/102 [==========================>...] - ETA: 0s - loss: 0.0172 94/102 [==========================>...] - ETA: 0s - loss: 0.0171 95/102 [==========================>...] - ETA: 0s - loss: 0.0170 96/102 [===========================>..] - ETA: 0s - loss: 0.0170 97/102 [===========================>..] - ETA: 0s - loss: 0.0170 98/102 [===========================>..] - ETA: 0s - loss: 0.0171 99/102 [============================>.] - ETA: 0s - loss: 0.0174100/102 [============================>.] - ETA: 0s - loss: 0.0174101/102 [============================>.] - ETA: 0s - loss: 0.0173102/102 [==============================] - ETA: 0s - loss: 0.0173102/102 [==============================] - 10s 100ms/step - loss: 0.0173 - val_loss: 0.0094 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 10s - loss: 0.0110  2/102 [..............................] - ETA: 9s - loss: 0.0164   3/102 [..............................] - ETA: 9s - loss: 0.0154  4/102 [>.............................] - ETA: 9s - loss: 0.0145  5/102 [>.............................] - ETA: 9s - loss: 0.0132  6/102 [>.............................] - ETA: 9s - loss: 0.0133  7/102 [=>............................] - ETA: 9s - loss: 0.0135  8/102 [=>............................] - ETA: 8s - loss: 0.0143  9/102 [=>............................] - ETA: 8s - loss: 0.0134 10/102 [=>............................] - ETA: 8s - loss: 0.0128 11/102 [==>...........................] - ETA: 8s - loss: 0.0126 12/102 [==>...........................] - ETA: 8s - loss: 0.0136 13/102 [==>...........................] - ETA: 8s - loss: 0.0135 14/102 [===>..........................] - ETA: 8s - loss: 0.0130 15/102 [===>..........................] - ETA: 8s - loss: 0.0128 16/102 [===>..........................] - ETA: 8s - loss: 0.0122 17/102 [====>.........................] - ETA: 8s - loss: 0.0118 18/102 [====>.........................] - ETA: 8s - loss: 0.0122 19/102 [====>.........................] - ETA: 7s - loss: 0.0121 20/102 [====>.........................] - ETA: 7s - loss: 0.0133 21/102 [=====>........................] - ETA: 7s - loss: 0.0132 22/102 [=====>........................] - ETA: 7s - loss: 0.0129 23/102 [=====>........................] - ETA: 7s - loss: 0.0127 24/102 [======>.......................] - ETA: 7s - loss: 0.0133 25/102 [======>.......................] - ETA: 7s - loss: 0.0131 26/102 [======>.......................] - ETA: 7s - loss: 0.0133 27/102 [======>.......................] - ETA: 7s - loss: 0.0136 28/102 [=======>......................] - ETA: 7s - loss: 0.0139 29/102 [=======>......................] - ETA: 6s - loss: 0.0146 30/102 [=======>......................] - ETA: 6s - loss: 0.0142 31/102 [========>.....................] - ETA: 6s - loss: 0.0151 32/102 [========>.....................] - ETA: 6s - loss: 0.0149 33/102 [========>.....................] - ETA: 6s - loss: 0.0150 34/102 [=========>....................] - ETA: 6s - loss: 0.0153 35/102 [=========>....................] - ETA: 6s - loss: 0.0150 36/102 [=========>....................] - ETA: 6s - loss: 0.0150 37/102 [=========>....................] - ETA: 6s - loss: 0.0149 38/102 [==========>...................] - ETA: 6s - loss: 0.0151 39/102 [==========>...................] - ETA: 6s - loss: 0.0150 40/102 [==========>...................] - ETA: 6s - loss: 0.0152 41/102 [===========>..................] - ETA: 5s - loss: 0.0153 42/102 [===========>..................] - ETA: 5s - loss: 0.0151 43/102 [===========>..................] - ETA: 5s - loss: 0.0149 44/102 [===========>..................] - ETA: 5s - loss: 0.0154 45/102 [============>.................] - ETA: 5s - loss: 0.0155 46/102 [============>.................] - ETA: 5s - loss: 0.0155 47/102 [============>.................] - ETA: 5s - loss: 0.0154 48/102 [=============>................] - ETA: 5s - loss: 0.0156 49/102 [=============>................] - ETA: 5s - loss: 0.0154 50/102 [=============>................] - ETA: 5s - loss: 0.0157 51/102 [==============>...............] - ETA: 5s - loss: 0.0155 52/102 [==============>...............] - ETA: 4s - loss: 0.0156 53/102 [==============>...............] - ETA: 4s - loss: 0.0155 54/102 [==============>...............] - ETA: 4s - loss: 0.0154 55/102 [===============>..............] - ETA: 4s - loss: 0.0154 56/102 [===============>..............] - ETA: 4s - loss: 0.0153 57/102 [===============>..............] - ETA: 4s - loss: 0.0161 58/102 [================>.............] - ETA: 4s - loss: 0.0165 59/102 [================>.............] - ETA: 4s - loss: 0.0167 60/102 [================>.............] - ETA: 4s - loss: 0.0168 61/102 [================>.............] - ETA: 4s - loss: 0.0167 62/102 [=================>............] - ETA: 3s - loss: 0.0166 63/102 [=================>............] - ETA: 3s - loss: 0.0166 64/102 [=================>............] - ETA: 3s - loss: 0.0166 65/102 [==================>...........] - ETA: 3s - loss: 0.0165 66/102 [==================>...........] - ETA: 3s - loss: 0.0167 67/102 [==================>...........] - ETA: 3s - loss: 0.0167 68/102 [===================>..........] - ETA: 3s - loss: 0.0170 69/102 [===================>..........] - ETA: 3s - loss: 0.0168 70/102 [===================>..........] - ETA: 3s - loss: 0.0169 71/102 [===================>..........] - ETA: 3s - loss: 0.0170 72/102 [====================>.........] - ETA: 2s - loss: 0.0168 73/102 [====================>.........] - ETA: 2s - loss: 0.0171 74/102 [====================>.........] - ETA: 2s - loss: 0.0170 75/102 [=====================>........] - ETA: 2s - loss: 0.0171 76/102 [=====================>........] - ETA: 2s - loss: 0.0169 77/102 [=====================>........] - ETA: 2s - loss: 0.0170 78/102 [=====================>........] - ETA: 2s - loss: 0.0172 79/102 [======================>.......] - ETA: 2s - loss: 0.0170 80/102 [======================>.......] - ETA: 2s - loss: 0.0170 81/102 [======================>.......] - ETA: 2s - loss: 0.0171 82/102 [=======================>......] - ETA: 1s - loss: 0.0170 83/102 [=======================>......] - ETA: 1s - loss: 0.0170 84/102 [=======================>......] - ETA: 1s - loss: 0.0172 85/102 [========================>.....] - ETA: 1s - loss: 0.0171 86/102 [========================>.....] - ETA: 1s - loss: 0.0169 87/102 [========================>.....] - ETA: 1s - loss: 0.0169 88/102 [========================>.....] - ETA: 1s - loss: 0.0168 89/102 [=========================>....] - ETA: 1s - loss: 0.0167 90/102 [=========================>....] - ETA: 1s - loss: 0.0168 91/102 [=========================>....] - ETA: 1s - loss: 0.0169 92/102 [==========================>...] - ETA: 0s - loss: 0.0169 93/102 [==========================>...] - ETA: 0s - loss: 0.0169 94/102 [==========================>...] - ETA: 0s - loss: 0.0170 95/102 [==========================>...] - ETA: 0s - loss: 0.0169 96/102 [===========================>..] - ETA: 0s - loss: 0.0169 97/102 [===========================>..] - ETA: 0s - loss: 0.0169 98/102 [===========================>..] - ETA: 0s - loss: 0.0171 99/102 [============================>.] - ETA: 0s - loss: 0.0170100/102 [============================>.] - ETA: 0s - loss: 0.0170101/102 [============================>.] - ETA: 0s - loss: 0.0170102/102 [==============================] - ETA: 0s - loss: 0.0170102/102 [==============================] - 10s 101ms/step - loss: 0.0170 - val_loss: 0.0103 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.0201 5/16 [========>.....................] - ETA: 0s - loss: 0.0328 9/16 [===============>..............] - ETA: 0s - loss: 0.028713/16 [=======================>......] - ETA: 0s - loss: 0.029616/16 [==============================] - 0s 16ms/step - loss: 0.0316
Test Loss: 0.031641390174627304
Saved model as forecasting_models_v5/model_lstm_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LSTM model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 831ms/step
Predicted QoE for the next time step: 77.73619223888308
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/lstm_wide.h5
Completed at Τετ 14 Μαΐ 2025 10:10:13 μμ EEST
=====================================================

=====================================================
Training lstm model with config: bidirectional
Starting at Τετ 14 Μαΐ 2025 10:10:13 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type lstm                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --bidirectional --attention_units 128
2025-05-14 22:10:13.755265: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:10:13.905282: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:10:14.491447: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:10:14.491528: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:10:14.491537: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:10:21.093379: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:10:21.792717: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:10:21.792740: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:10:21.792892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5564 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Traceback (most recent call last):
  File "timeseries_forecasting_models_v5.py", line 889, in <module>
    main()
  File "timeseries_forecasting_models_v5.py", line 672, in main
    model.summary()
  File "/home/dimitris/.local/lib/python3.8/site-packages/keras/engine/training.py", line 3214, in summary
    raise ValueError(
ValueError: This model has not yet been built. Build the model first by calling `build()` or by calling the model on a batch of data.
Warning: Original model file not found at /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/model_lstm_with_attention.h5
Directory contents:
total 11944
drwxrwxr-x  2 dimitris dimitris    4096 Μαΐ  14 22:10 .
drwxrwxr-x 25 dimitris dimitris    4096 Μαΐ  14 22:00 ..
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  14 22:05 dnn_basic.h5
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  14 22:05 dnn_deep.h5
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  14 22:05 dnn_with_elu.h5
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  14 22:06 dnn_with_high_dropout.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  14 22:03 linear_basic.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  14 22:04 linear_with_elastic_net.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  14 22:04 linear_with_l1_reg.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  14 22:04 linear_with_l2_reg.h5
-rw-rw-r--  1 dimitris dimitris 3585456 Μαΐ  14 22:07 lstm_basic.h5
-rw-rw-r--  1 dimitris dimitris 3585456 Μαΐ  14 22:08 lstm_deep.h5
-rw-rw-r--  1 dimitris dimitris 3585456 Μαΐ  14 22:10 lstm_wide.h5
-rw-rw-r--  1 dimitris dimitris    3463 Μαΐ  14 22:10 scaler.save
-rw-rw-r--  1 dimitris dimitris  397332 Μαΐ  14 22:10 training_log.txt
Completed at Τετ 14 Μαΐ 2025 10:10:24 μμ EEST
=====================================================

=====================================================
Training lstm model with config: with_stats
Starting at Τετ 14 Μαΐ 2025 10:10:24 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type lstm                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --attention_units 128
2025-05-14 22:10:24.859685: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:10:25.013129: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:10:25.585571: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:10:25.585648: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:10:25.585658: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:10:32.010755: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:10:32.690768: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:10:32.690791: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:10:32.690926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5564 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 5, 96)             54528     
                                                                 
 lstm_1 (LSTM)               (None, 5, 96)             74112     
                                                                 
 lstm_2 (LSTM)               (None, 5, 96)             74112     
                                                                 
 lstm_3 (LSTM)               (None, 5, 96)             74112     
                                                                 
 self_attention (SelfAttenti  (None, 96)               12544     
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                2425      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 291,859
Trainable params: 291,859
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 13:52 - loss: 0.3042  2/102 [..............................] - ETA: 9s - loss: 0.3320     3/102 [..............................] - ETA: 8s - loss: 0.3285  4/102 [>.............................] - ETA: 8s - loss: 0.3287  5/102 [>.............................] - ETA: 8s - loss: 0.3174  6/102 [>.............................] - ETA: 8s - loss: 0.3091  7/102 [=>............................] - ETA: 8s - loss: 0.2997  8/102 [=>............................] - ETA: 8s - loss: 0.2842  9/102 [=>............................] - ETA: 8s - loss: 0.2677 10/102 [=>............................] - ETA: 8s - loss: 0.2499 11/102 [==>...........................] - ETA: 8s - loss: 0.2320 12/102 [==>...........................] - ETA: 8s - loss: 0.2153 13/102 [==>...........................] - ETA: 8s - loss: 0.2114 14/102 [===>..........................] - ETA: 8s - loss: 0.2095 15/102 [===>..........................] - ETA: 8s - loss: 0.2018 16/102 [===>..........................] - ETA: 8s - loss: 0.1912 17/102 [====>.........................] - ETA: 8s - loss: 0.1821 18/102 [====>.........................] - ETA: 7s - loss: 0.1737 19/102 [====>.........................] - ETA: 7s - loss: 0.1672 20/102 [====>.........................] - ETA: 7s - loss: 0.1610 21/102 [=====>........................] - ETA: 7s - loss: 0.1569 22/102 [=====>........................] - ETA: 7s - loss: 0.1532 23/102 [=====>........................] - ETA: 7s - loss: 0.1495 24/102 [======>.......................] - ETA: 7s - loss: 0.1469 25/102 [======>.......................] - ETA: 7s - loss: 0.1433 26/102 [======>.......................] - ETA: 7s - loss: 0.1402 27/102 [======>.......................] - ETA: 7s - loss: 0.1367 28/102 [=======>......................] - ETA: 7s - loss: 0.1329 29/102 [=======>......................] - ETA: 6s - loss: 0.1298 30/102 [=======>......................] - ETA: 6s - loss: 0.1268 31/102 [========>.....................] - ETA: 6s - loss: 0.1239 32/102 [========>.....................] - ETA: 6s - loss: 0.1210 33/102 [========>.....................] - ETA: 6s - loss: 0.1185 34/102 [=========>....................] - ETA: 6s - loss: 0.1164 35/102 [=========>....................] - ETA: 6s - loss: 0.1136 36/102 [=========>....................] - ETA: 6s - loss: 0.1112 37/102 [=========>....................] - ETA: 6s - loss: 0.1088 38/102 [==========>...................] - ETA: 6s - loss: 0.1065 39/102 [==========>...................] - ETA: 6s - loss: 0.1047 40/102 [==========>...................] - ETA: 5s - loss: 0.1030 41/102 [===========>..................] - ETA: 5s - loss: 0.1007 42/102 [===========>..................] - ETA: 5s - loss: 0.0988 43/102 [===========>..................] - ETA: 5s - loss: 0.0971 44/102 [===========>..................] - ETA: 5s - loss: 0.0954 45/102 [============>.................] - ETA: 5s - loss: 0.0939 46/102 [============>.................] - ETA: 5s - loss: 0.0922 47/102 [============>.................] - ETA: 5s - loss: 0.0910 48/102 [=============>................] - ETA: 5s - loss: 0.0898 49/102 [=============>................] - ETA: 5s - loss: 0.0886 50/102 [=============>................] - ETA: 4s - loss: 0.0872 51/102 [==============>...............] - ETA: 4s - loss: 0.0858 52/102 [==============>...............] - ETA: 4s - loss: 0.0844 53/102 [==============>...............] - ETA: 4s - loss: 0.0832 54/102 [==============>...............] - ETA: 4s - loss: 0.0822 55/102 [===============>..............] - ETA: 4s - loss: 0.0810 56/102 [===============>..............] - ETA: 4s - loss: 0.0802 57/102 [===============>..............] - ETA: 4s - loss: 0.0790 58/102 [================>.............] - ETA: 4s - loss: 0.0779 59/102 [================>.............] - ETA: 4s - loss: 0.0767 60/102 [================>.............] - ETA: 3s - loss: 0.0760 61/102 [================>.............] - ETA: 3s - loss: 0.0749 62/102 [=================>............] - ETA: 3s - loss: 0.0741 63/102 [=================>............] - ETA: 3s - loss: 0.0735 64/102 [=================>............] - ETA: 3s - loss: 0.0726 65/102 [==================>...........] - ETA: 3s - loss: 0.0715 66/102 [==================>...........] - ETA: 3s - loss: 0.0706 67/102 [==================>...........] - ETA: 3s - loss: 0.0698 68/102 [===================>..........] - ETA: 3s - loss: 0.0690 69/102 [===================>..........] - ETA: 3s - loss: 0.0682 70/102 [===================>..........] - ETA: 3s - loss: 0.0676 71/102 [===================>..........] - ETA: 2s - loss: 0.0670 72/102 [====================>.........] - ETA: 2s - loss: 0.0663 73/102 [====================>.........] - ETA: 2s - loss: 0.0657 74/102 [====================>.........] - ETA: 2s - loss: 0.0652 75/102 [=====================>........] - ETA: 2s - loss: 0.0645 76/102 [=====================>........] - ETA: 2s - loss: 0.0642 77/102 [=====================>........] - ETA: 2s - loss: 0.0636 78/102 [=====================>........] - ETA: 2s - loss: 0.0631 79/102 [======================>.......] - ETA: 2s - loss: 0.0627 80/102 [======================>.......] - ETA: 2s - loss: 0.0625 81/102 [======================>.......] - ETA: 1s - loss: 0.0621 82/102 [=======================>......] - ETA: 1s - loss: 0.0614 83/102 [=======================>......] - ETA: 1s - loss: 0.0610 84/102 [=======================>......] - ETA: 1s - loss: 0.0604 85/102 [========================>.....] - ETA: 1s - loss: 0.0599 86/102 [========================>.....] - ETA: 1s - loss: 0.0593 87/102 [========================>.....] - ETA: 1s - loss: 0.0589 88/102 [========================>.....] - ETA: 1s - loss: 0.0585 89/102 [=========================>....] - ETA: 1s - loss: 0.0580 90/102 [=========================>....] - ETA: 1s - loss: 0.0575 91/102 [=========================>....] - ETA: 1s - loss: 0.0570 92/102 [==========================>...] - ETA: 0s - loss: 0.0566 93/102 [==========================>...] - ETA: 0s - loss: 0.0563 94/102 [==========================>...] - ETA: 0s - loss: 0.0559 95/102 [==========================>...] - ETA: 0s - loss: 0.0555 96/102 [===========================>..] - ETA: 0s - loss: 0.0552 97/102 [===========================>..] - ETA: 0s - loss: 0.0549 98/102 [===========================>..] - ETA: 0s - loss: 0.0547 99/102 [============================>.] - ETA: 0s - loss: 0.0543100/102 [============================>.] - ETA: 0s - loss: 0.0538101/102 [============================>.] - ETA: 0s - loss: 0.0535102/102 [==============================] - ETA: 0s - loss: 0.0535102/102 [==============================] - 19s 108ms/step - loss: 0.0535 - val_loss: 0.0085 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 10s - loss: 0.0173  2/102 [..............................] - ETA: 9s - loss: 0.0180   3/102 [..............................] - ETA: 9s - loss: 0.0207  4/102 [>.............................] - ETA: 9s - loss: 0.0188  5/102 [>.............................] - ETA: 9s - loss: 0.0187  6/102 [>.............................] - ETA: 9s - loss: 0.0199  7/102 [=>............................] - ETA: 9s - loss: 0.0191  8/102 [=>............................] - ETA: 9s - loss: 0.0195  9/102 [=>............................] - ETA: 9s - loss: 0.0179 10/102 [=>............................] - ETA: 8s - loss: 0.0206 11/102 [==>...........................] - ETA: 8s - loss: 0.0198 12/102 [==>...........................] - ETA: 8s - loss: 0.0192 13/102 [==>...........................] - ETA: 8s - loss: 0.0190 14/102 [===>..........................] - ETA: 8s - loss: 0.0183 15/102 [===>..........................] - ETA: 8s - loss: 0.0179 16/102 [===>..........................] - ETA: 8s - loss: 0.0172 17/102 [====>.........................] - ETA: 8s - loss: 0.0190 18/102 [====>.........................] - ETA: 8s - loss: 0.0197 19/102 [====>.........................] - ETA: 8s - loss: 0.0201 20/102 [====>.........................] - ETA: 7s - loss: 0.0197 21/102 [=====>........................] - ETA: 7s - loss: 0.0198 22/102 [=====>........................] - ETA: 7s - loss: 0.0197 23/102 [=====>........................] - ETA: 7s - loss: 0.0193 24/102 [======>.......................] - ETA: 7s - loss: 0.0190 25/102 [======>.......................] - ETA: 7s - loss: 0.0190 26/102 [======>.......................] - ETA: 7s - loss: 0.0190 27/102 [======>.......................] - ETA: 7s - loss: 0.0186 28/102 [=======>......................] - ETA: 7s - loss: 0.0190 29/102 [=======>......................] - ETA: 7s - loss: 0.0187 30/102 [=======>......................] - ETA: 6s - loss: 0.0186 31/102 [========>.....................] - ETA: 6s - loss: 0.0188 32/102 [========>.....................] - ETA: 6s - loss: 0.0184 33/102 [========>.....................] - ETA: 6s - loss: 0.0185 34/102 [=========>....................] - ETA: 6s - loss: 0.0183 35/102 [=========>....................] - ETA: 6s - loss: 0.0183 36/102 [=========>....................] - ETA: 6s - loss: 0.0185 37/102 [=========>....................] - ETA: 6s - loss: 0.0182 38/102 [==========>...................] - ETA: 6s - loss: 0.0186 39/102 [==========>...................] - ETA: 6s - loss: 0.0183 40/102 [==========>...................] - ETA: 6s - loss: 0.0182 41/102 [===========>..................] - ETA: 5s - loss: 0.0179 42/102 [===========>..................] - ETA: 5s - loss: 0.0186 43/102 [===========>..................] - ETA: 5s - loss: 0.0186 44/102 [===========>..................] - ETA: 5s - loss: 0.0185 45/102 [============>.................] - ETA: 5s - loss: 0.0182 46/102 [============>.................] - ETA: 5s - loss: 0.0188 47/102 [============>.................] - ETA: 5s - loss: 0.0186 48/102 [=============>................] - ETA: 5s - loss: 0.0185 49/102 [=============>................] - ETA: 5s - loss: 0.0187 50/102 [=============>................] - ETA: 5s - loss: 0.0185 51/102 [==============>...............] - ETA: 4s - loss: 0.0187 52/102 [==============>...............] - ETA: 4s - loss: 0.0189 53/102 [==============>...............] - ETA: 4s - loss: 0.0189 54/102 [==============>...............] - ETA: 4s - loss: 0.0191 55/102 [===============>..............] - ETA: 4s - loss: 0.0192 56/102 [===============>..............] - ETA: 4s - loss: 0.0191 57/102 [===============>..............] - ETA: 4s - loss: 0.0195 58/102 [================>.............] - ETA: 4s - loss: 0.0196 59/102 [================>.............] - ETA: 4s - loss: 0.0198 60/102 [================>.............] - ETA: 4s - loss: 0.0197 61/102 [================>.............] - ETA: 3s - loss: 0.0196 62/102 [=================>............] - ETA: 3s - loss: 0.0195 63/102 [=================>............] - ETA: 3s - loss: 0.0196 64/102 [=================>............] - ETA: 3s - loss: 0.0197 65/102 [==================>...........] - ETA: 3s - loss: 0.0196 66/102 [==================>...........] - ETA: 3s - loss: 0.0201 67/102 [==================>...........] - ETA: 3s - loss: 0.0202 68/102 [===================>..........] - ETA: 3s - loss: 0.0200 69/102 [===================>..........] - ETA: 3s - loss: 0.0200 70/102 [===================>..........] - ETA: 3s - loss: 0.0197 71/102 [===================>..........] - ETA: 3s - loss: 0.0197 72/102 [====================>.........] - ETA: 2s - loss: 0.0200 73/102 [====================>.........] - ETA: 2s - loss: 0.0201 74/102 [====================>.........] - ETA: 2s - loss: 0.0199 75/102 [=====================>........] - ETA: 2s - loss: 0.0198 76/102 [=====================>........] - ETA: 2s - loss: 0.0198 77/102 [=====================>........] - ETA: 2s - loss: 0.0198 78/102 [=====================>........] - ETA: 2s - loss: 0.0196 79/102 [======================>.......] - ETA: 2s - loss: 0.0196 80/102 [======================>.......] - ETA: 2s - loss: 0.0196 81/102 [======================>.......] - ETA: 2s - loss: 0.0198 82/102 [=======================>......] - ETA: 1s - loss: 0.0198 83/102 [=======================>......] - ETA: 1s - loss: 0.0198 84/102 [=======================>......] - ETA: 1s - loss: 0.0197 85/102 [========================>.....] - ETA: 1s - loss: 0.0196 86/102 [========================>.....] - ETA: 1s - loss: 0.0196 87/102 [========================>.....] - ETA: 1s - loss: 0.0196 88/102 [========================>.....] - ETA: 1s - loss: 0.0196 89/102 [=========================>....] - ETA: 1s - loss: 0.0196 90/102 [=========================>....] - ETA: 1s - loss: 0.0195 91/102 [=========================>....] - ETA: 1s - loss: 0.0194 92/102 [==========================>...] - ETA: 0s - loss: 0.0193 93/102 [==========================>...] - ETA: 0s - loss: 0.0193 94/102 [==========================>...] - ETA: 0s - loss: 0.0194 95/102 [==========================>...] - ETA: 0s - loss: 0.0197 96/102 [===========================>..] - ETA: 0s - loss: 0.0197 97/102 [===========================>..] - ETA: 0s - loss: 0.0197 98/102 [===========================>..] - ETA: 0s - loss: 0.0197 99/102 [============================>.] - ETA: 0s - loss: 0.0197100/102 [============================>.] - ETA: 0s - loss: 0.0197101/102 [============================>.] - ETA: 0s - loss: 0.0197102/102 [==============================] - ETA: 0s - loss: 0.0197102/102 [==============================] - 10s 101ms/step - loss: 0.0197 - val_loss: 0.0078 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 9s - loss: 0.0155  2/102 [..............................] - ETA: 9s - loss: 0.0177  3/102 [..............................] - ETA: 9s - loss: 0.0199  4/102 [>.............................] - ETA: 9s - loss: 0.0192  5/102 [>.............................] - ETA: 9s - loss: 0.0168  6/102 [>.............................] - ETA: 8s - loss: 0.0164  7/102 [=>............................] - ETA: 8s - loss: 0.0164  8/102 [=>............................] - ETA: 8s - loss: 0.0167  9/102 [=>............................] - ETA: 8s - loss: 0.0178 10/102 [=>............................] - ETA: 8s - loss: 0.0200 11/102 [==>...........................] - ETA: 8s - loss: 0.0187 12/102 [==>...........................] - ETA: 8s - loss: 0.0203 13/102 [==>...........................] - ETA: 8s - loss: 0.0198 14/102 [===>..........................] - ETA: 8s - loss: 0.0191 15/102 [===>..........................] - ETA: 8s - loss: 0.0194 16/102 [===>..........................] - ETA: 8s - loss: 0.0198 17/102 [====>.........................] - ETA: 7s - loss: 0.0192 18/102 [====>.........................] - ETA: 7s - loss: 0.0190 19/102 [====>.........................] - ETA: 7s - loss: 0.0190 20/102 [====>.........................] - ETA: 7s - loss: 0.0191 21/102 [=====>........................] - ETA: 7s - loss: 0.0189 22/102 [=====>........................] - ETA: 7s - loss: 0.0192 23/102 [=====>........................] - ETA: 7s - loss: 0.0188 24/102 [======>.......................] - ETA: 7s - loss: 0.0187 25/102 [======>.......................] - ETA: 7s - loss: 0.0186 26/102 [======>.......................] - ETA: 7s - loss: 0.0188 27/102 [======>.......................] - ETA: 7s - loss: 0.0182 28/102 [=======>......................] - ETA: 7s - loss: 0.0186 29/102 [=======>......................] - ETA: 6s - loss: 0.0188 30/102 [=======>......................] - ETA: 6s - loss: 0.0188 31/102 [========>.....................] - ETA: 6s - loss: 0.0192 32/102 [========>.....................] - ETA: 6s - loss: 0.0191 33/102 [========>.....................] - ETA: 6s - loss: 0.0190 34/102 [=========>....................] - ETA: 6s - loss: 0.0191 35/102 [=========>....................] - ETA: 6s - loss: 0.0193 36/102 [=========>....................] - ETA: 6s - loss: 0.0192 37/102 [=========>....................] - ETA: 6s - loss: 0.0193 38/102 [==========>...................] - ETA: 6s - loss: 0.0199 39/102 [==========>...................] - ETA: 6s - loss: 0.0196 40/102 [==========>...................] - ETA: 5s - loss: 0.0195 41/102 [===========>..................] - ETA: 5s - loss: 0.0193 42/102 [===========>..................] - ETA: 5s - loss: 0.0193 43/102 [===========>..................] - ETA: 5s - loss: 0.0192 44/102 [===========>..................] - ETA: 5s - loss: 0.0190 45/102 [============>.................] - ETA: 5s - loss: 0.0193 46/102 [============>.................] - ETA: 5s - loss: 0.0192 47/102 [============>.................] - ETA: 5s - loss: 0.0201 48/102 [=============>................] - ETA: 5s - loss: 0.0200 49/102 [=============>................] - ETA: 5s - loss: 0.0199 50/102 [=============>................] - ETA: 4s - loss: 0.0202 51/102 [==============>...............] - ETA: 4s - loss: 0.0202 52/102 [==============>...............] - ETA: 4s - loss: 0.0200 53/102 [==============>...............] - ETA: 4s - loss: 0.0199 54/102 [==============>...............] - ETA: 4s - loss: 0.0198 55/102 [===============>..............] - ETA: 4s - loss: 0.0197 56/102 [===============>..............] - ETA: 4s - loss: 0.0198 57/102 [===============>..............] - ETA: 4s - loss: 0.0197 58/102 [================>.............] - ETA: 4s - loss: 0.0197 59/102 [================>.............] - ETA: 4s - loss: 0.0197 60/102 [================>.............] - ETA: 3s - loss: 0.0196 61/102 [================>.............] - ETA: 3s - loss: 0.0196 62/102 [=================>............] - ETA: 3s - loss: 0.0194 63/102 [=================>............] - ETA: 3s - loss: 0.0195 64/102 [=================>............] - ETA: 3s - loss: 0.0193 65/102 [==================>...........] - ETA: 3s - loss: 0.0191 66/102 [==================>...........] - ETA: 3s - loss: 0.0191 67/102 [==================>...........] - ETA: 3s - loss: 0.0190 68/102 [===================>..........] - ETA: 3s - loss: 0.0189 69/102 [===================>..........] - ETA: 3s - loss: 0.0191 70/102 [===================>..........] - ETA: 3s - loss: 0.0191 71/102 [===================>..........] - ETA: 2s - loss: 0.0189 72/102 [====================>.........] - ETA: 2s - loss: 0.0188 73/102 [====================>.........] - ETA: 2s - loss: 0.0188 74/102 [====================>.........] - ETA: 2s - loss: 0.0188 75/102 [=====================>........] - ETA: 2s - loss: 0.0189 76/102 [=====================>........] - ETA: 2s - loss: 0.0188 77/102 [=====================>........] - ETA: 2s - loss: 0.0188 78/102 [=====================>........] - ETA: 2s - loss: 0.0187 79/102 [======================>.......] - ETA: 2s - loss: 0.0187 80/102 [======================>.......] - ETA: 2s - loss: 0.0187 81/102 [======================>.......] - ETA: 1s - loss: 0.0186 82/102 [=======================>......] - ETA: 1s - loss: 0.0191 83/102 [=======================>......] - ETA: 1s - loss: 0.0189 84/102 [=======================>......] - ETA: 1s - loss: 0.0191 85/102 [========================>.....] - ETA: 1s - loss: 0.0193 86/102 [========================>.....] - ETA: 1s - loss: 0.0192 87/102 [========================>.....] - ETA: 1s - loss: 0.0193 88/102 [========================>.....] - ETA: 1s - loss: 0.0191 89/102 [=========================>....] - ETA: 1s - loss: 0.0193 90/102 [=========================>....] - ETA: 1s - loss: 0.0192 91/102 [=========================>....] - ETA: 1s - loss: 0.0191 92/102 [==========================>...] - ETA: 0s - loss: 0.0192 93/102 [==========================>...] - ETA: 0s - loss: 0.0192 94/102 [==========================>...] - ETA: 0s - loss: 0.0192 95/102 [==========================>...] - ETA: 0s - loss: 0.0192 96/102 [===========================>..] - ETA: 0s - loss: 0.0190 97/102 [===========================>..] - ETA: 0s - loss: 0.0189 98/102 [===========================>..] - ETA: 0s - loss: 0.0188 99/102 [============================>.] - ETA: 0s - loss: 0.0188100/102 [============================>.] - ETA: 0s - loss: 0.0188101/102 [============================>.] - ETA: 0s - loss: 0.0187102/102 [==============================] - ETA: 0s - loss: 0.0187102/102 [==============================] - 10s 99ms/step - loss: 0.0187 - val_loss: 0.0087 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 9s - loss: 0.0171  2/102 [..............................] - ETA: 9s - loss: 0.0228  3/102 [..............................] - ETA: 9s - loss: 0.0212  4/102 [>.............................] - ETA: 9s - loss: 0.0214  5/102 [>.............................] - ETA: 9s - loss: 0.0202  6/102 [>.............................] - ETA: 9s - loss: 0.0188  7/102 [=>............................] - ETA: 9s - loss: 0.0181  8/102 [=>............................] - ETA: 8s - loss: 0.0178  9/102 [=>............................] - ETA: 8s - loss: 0.0199 10/102 [=>............................] - ETA: 8s - loss: 0.0222 11/102 [==>...........................] - ETA: 8s - loss: 0.0210 12/102 [==>...........................] - ETA: 8s - loss: 0.0207 13/102 [==>...........................] - ETA: 8s - loss: 0.0196 14/102 [===>..........................] - ETA: 8s - loss: 0.0189 15/102 [===>..........................] - ETA: 8s - loss: 0.0189 16/102 [===>..........................] - ETA: 8s - loss: 0.0191 17/102 [====>.........................] - ETA: 8s - loss: 0.0190 18/102 [====>.........................] - ETA: 8s - loss: 0.0196 19/102 [====>.........................] - ETA: 8s - loss: 0.0195 20/102 [====>.........................] - ETA: 7s - loss: 0.0194 21/102 [=====>........................] - ETA: 7s - loss: 0.0200 22/102 [=====>........................] - ETA: 7s - loss: 0.0195 23/102 [=====>........................] - ETA: 7s - loss: 0.0191 24/102 [======>.......................] - ETA: 7s - loss: 0.0191 25/102 [======>.......................] - ETA: 7s - loss: 0.0187 26/102 [======>.......................] - ETA: 7s - loss: 0.0188 27/102 [======>.......................] - ETA: 7s - loss: 0.0184 28/102 [=======>......................] - ETA: 7s - loss: 0.0185 29/102 [=======>......................] - ETA: 7s - loss: 0.0181 30/102 [=======>......................] - ETA: 6s - loss: 0.0188 31/102 [========>.....................] - ETA: 6s - loss: 0.0187 32/102 [========>.....................] - ETA: 6s - loss: 0.0185 33/102 [========>.....................] - ETA: 6s - loss: 0.0184 34/102 [=========>....................] - ETA: 6s - loss: 0.0180 35/102 [=========>....................] - ETA: 6s - loss: 0.0180 36/102 [=========>....................] - ETA: 6s - loss: 0.0178 37/102 [=========>....................] - ETA: 6s - loss: 0.0186 38/102 [==========>...................] - ETA: 6s - loss: 0.0183 39/102 [==========>...................] - ETA: 6s - loss: 0.0181 40/102 [==========>...................] - ETA: 5s - loss: 0.0184 41/102 [===========>..................] - ETA: 5s - loss: 0.0183 42/102 [===========>..................] - ETA: 5s - loss: 0.0181 43/102 [===========>..................] - ETA: 5s - loss: 0.0184 44/102 [===========>..................] - ETA: 5s - loss: 0.0184 45/102 [============>.................] - ETA: 5s - loss: 0.0184 46/102 [============>.................] - ETA: 5s - loss: 0.0185 47/102 [============>.................] - ETA: 5s - loss: 0.0183 48/102 [=============>................] - ETA: 5s - loss: 0.0185 49/102 [=============>................] - ETA: 5s - loss: 0.0187 50/102 [=============>................] - ETA: 4s - loss: 0.0188 51/102 [==============>...............] - ETA: 4s - loss: 0.0186 52/102 [==============>...............] - ETA: 4s - loss: 0.0184 53/102 [==============>...............] - ETA: 4s - loss: 0.0183 54/102 [==============>...............] - ETA: 4s - loss: 0.0184 55/102 [===============>..............] - ETA: 4s - loss: 0.0186 56/102 [===============>..............] - ETA: 4s - loss: 0.0185 57/102 [===============>..............] - ETA: 4s - loss: 0.0183 58/102 [================>.............] - ETA: 4s - loss: 0.0181 59/102 [================>.............] - ETA: 4s - loss: 0.0180 60/102 [================>.............] - ETA: 4s - loss: 0.0178 61/102 [================>.............] - ETA: 3s - loss: 0.0176 62/102 [=================>............] - ETA: 3s - loss: 0.0174 63/102 [=================>............] - ETA: 3s - loss: 0.0177 64/102 [=================>............] - ETA: 3s - loss: 0.0176 65/102 [==================>...........] - ETA: 3s - loss: 0.0175 66/102 [==================>...........] - ETA: 3s - loss: 0.0178 67/102 [==================>...........] - ETA: 3s - loss: 0.0177 68/102 [===================>..........] - ETA: 3s - loss: 0.0177 69/102 [===================>..........] - ETA: 3s - loss: 0.0177 70/102 [===================>..........] - ETA: 3s - loss: 0.0177 71/102 [===================>..........] - ETA: 2s - loss: 0.0176 72/102 [====================>.........] - ETA: 2s - loss: 0.0175 73/102 [====================>.........] - ETA: 2s - loss: 0.0174 74/102 [====================>.........] - ETA: 2s - loss: 0.0174 75/102 [=====================>........] - ETA: 2s - loss: 0.0173 76/102 [=====================>........] - ETA: 2s - loss: 0.0172 77/102 [=====================>........] - ETA: 2s - loss: 0.0173 78/102 [=====================>........] - ETA: 2s - loss: 0.0172 79/102 [======================>.......] - ETA: 2s - loss: 0.0172 80/102 [======================>.......] - ETA: 2s - loss: 0.0170 81/102 [======================>.......] - ETA: 2s - loss: 0.0169 82/102 [=======================>......] - ETA: 1s - loss: 0.0170 83/102 [=======================>......] - ETA: 1s - loss: 0.0173 84/102 [=======================>......] - ETA: 1s - loss: 0.0172 85/102 [========================>.....] - ETA: 1s - loss: 0.0172 86/102 [========================>.....] - ETA: 1s - loss: 0.0171 87/102 [========================>.....] - ETA: 1s - loss: 0.0171 88/102 [========================>.....] - ETA: 1s - loss: 0.0173 89/102 [=========================>....] - ETA: 1s - loss: 0.0173 90/102 [=========================>....] - ETA: 1s - loss: 0.0174 91/102 [=========================>....] - ETA: 1s - loss: 0.0173 92/102 [==========================>...] - ETA: 0s - loss: 0.0174 93/102 [==========================>...] - ETA: 0s - loss: 0.0174 94/102 [==========================>...] - ETA: 0s - loss: 0.0175 95/102 [==========================>...] - ETA: 0s - loss: 0.0176 96/102 [===========================>..] - ETA: 0s - loss: 0.0174 97/102 [===========================>..] - ETA: 0s - loss: 0.0174 98/102 [===========================>..] - ETA: 0s - loss: 0.0173 99/102 [============================>.] - ETA: 0s - loss: 0.0174100/102 [============================>.] - ETA: 0s - loss: 0.0173101/102 [============================>.] - ETA: 0s - loss: 0.0174102/102 [==============================] - ETA: 0s - loss: 0.0174102/102 [==============================] - 10s 99ms/step - loss: 0.0174 - val_loss: 0.0098 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 9s - loss: 0.0055  2/102 [..............................] - ETA: 9s - loss: 0.0068  3/102 [..............................] - ETA: 9s - loss: 0.0125  4/102 [>.............................] - ETA: 9s - loss: 0.0149  5/102 [>.............................] - ETA: 9s - loss: 0.0160  6/102 [>.............................] - ETA: 8s - loss: 0.0185  7/102 [=>............................] - ETA: 8s - loss: 0.0172  8/102 [=>............................] - ETA: 8s - loss: 0.0165  9/102 [=>............................] - ETA: 8s - loss: 0.0170 10/102 [=>............................] - ETA: 8s - loss: 0.0173 11/102 [==>...........................] - ETA: 8s - loss: 0.0160 12/102 [==>...........................] - ETA: 8s - loss: 0.0156 13/102 [==>...........................] - ETA: 8s - loss: 0.0164 14/102 [===>..........................] - ETA: 8s - loss: 0.0163 15/102 [===>..........................] - ETA: 8s - loss: 0.0162 16/102 [===>..........................] - ETA: 8s - loss: 0.0158 17/102 [====>.........................] - ETA: 8s - loss: 0.0158 18/102 [====>.........................] - ETA: 7s - loss: 0.0152 19/102 [====>.........................] - ETA: 7s - loss: 0.0156 20/102 [====>.........................] - ETA: 7s - loss: 0.0156 21/102 [=====>........................] - ETA: 7s - loss: 0.0153 22/102 [=====>........................] - ETA: 7s - loss: 0.0154 23/102 [=====>........................] - ETA: 7s - loss: 0.0156 24/102 [======>.......................] - ETA: 7s - loss: 0.0156 25/102 [======>.......................] - ETA: 7s - loss: 0.0165 26/102 [======>.......................] - ETA: 7s - loss: 0.0177 27/102 [======>.......................] - ETA: 7s - loss: 0.0176 28/102 [=======>......................] - ETA: 7s - loss: 0.0174 29/102 [=======>......................] - ETA: 6s - loss: 0.0173 30/102 [=======>......................] - ETA: 6s - loss: 0.0176 31/102 [========>.....................] - ETA: 6s - loss: 0.0178 32/102 [========>.....................] - ETA: 6s - loss: 0.0178 33/102 [========>.....................] - ETA: 6s - loss: 0.0175 34/102 [=========>....................] - ETA: 6s - loss: 0.0177 35/102 [=========>....................] - ETA: 6s - loss: 0.0178 36/102 [=========>....................] - ETA: 6s - loss: 0.0177 37/102 [=========>....................] - ETA: 6s - loss: 0.0176 38/102 [==========>...................] - ETA: 6s - loss: 0.0174 39/102 [==========>...................] - ETA: 5s - loss: 0.0172 40/102 [==========>...................] - ETA: 5s - loss: 0.0172 41/102 [===========>..................] - ETA: 5s - loss: 0.0178 42/102 [===========>..................] - ETA: 5s - loss: 0.0178 43/102 [===========>..................] - ETA: 5s - loss: 0.0180 44/102 [===========>..................] - ETA: 5s - loss: 0.0179 45/102 [============>.................] - ETA: 5s - loss: 0.0184 46/102 [============>.................] - ETA: 5s - loss: 0.0182 47/102 [============>.................] - ETA: 5s - loss: 0.0182 48/102 [=============>................] - ETA: 5s - loss: 0.0181 49/102 [=============>................] - ETA: 5s - loss: 0.0186 50/102 [=============>................] - ETA: 4s - loss: 0.0186 51/102 [==============>...............] - ETA: 4s - loss: 0.0187 52/102 [==============>...............] - ETA: 4s - loss: 0.0186 53/102 [==============>...............] - ETA: 4s - loss: 0.0185 54/102 [==============>...............] - ETA: 4s - loss: 0.0186 55/102 [===============>..............] - ETA: 4s - loss: 0.0185 56/102 [===============>..............] - ETA: 4s - loss: 0.0184 57/102 [===============>..............] - ETA: 4s - loss: 0.0184 58/102 [================>.............] - ETA: 4s - loss: 0.0183 59/102 [================>.............] - ETA: 4s - loss: 0.0182 60/102 [================>.............] - ETA: 3s - loss: 0.0185 61/102 [================>.............] - ETA: 3s - loss: 0.0183 62/102 [=================>............] - ETA: 3s - loss: 0.0182 63/102 [=================>............] - ETA: 3s - loss: 0.0180 64/102 [=================>............] - ETA: 3s - loss: 0.0179 65/102 [==================>...........] - ETA: 3s - loss: 0.0178 66/102 [==================>...........] - ETA: 3s - loss: 0.0177 67/102 [==================>...........] - ETA: 3s - loss: 0.0176 68/102 [===================>..........] - ETA: 3s - loss: 0.0176 69/102 [===================>..........] - ETA: 3s - loss: 0.0176 70/102 [===================>..........] - ETA: 3s - loss: 0.0175 71/102 [===================>..........] - ETA: 2s - loss: 0.0177 72/102 [====================>.........] - ETA: 2s - loss: 0.0179 73/102 [====================>.........] - ETA: 2s - loss: 0.0181 74/102 [====================>.........] - ETA: 2s - loss: 0.0180 75/102 [=====================>........] - ETA: 2s - loss: 0.0180 76/102 [=====================>........] - ETA: 2s - loss: 0.0179 77/102 [=====================>........] - ETA: 2s - loss: 0.0180 78/102 [=====================>........] - ETA: 2s - loss: 0.0179 79/102 [======================>.......] - ETA: 2s - loss: 0.0179 80/102 [======================>.......] - ETA: 2s - loss: 0.0180 81/102 [======================>.......] - ETA: 1s - loss: 0.0180 82/102 [=======================>......] - ETA: 1s - loss: 0.0179 83/102 [=======================>......] - ETA: 1s - loss: 0.0178 84/102 [=======================>......] - ETA: 1s - loss: 0.0176 85/102 [========================>.....] - ETA: 1s - loss: 0.0175 86/102 [========================>.....] - ETA: 1s - loss: 0.0174 87/102 [========================>.....] - ETA: 1s - loss: 0.0174 88/102 [========================>.....] - ETA: 1s - loss: 0.0177 89/102 [=========================>....] - ETA: 1s - loss: 0.0175 90/102 [=========================>....] - ETA: 1s - loss: 0.0174 91/102 [=========================>....] - ETA: 1s - loss: 0.0173 92/102 [==========================>...] - ETA: 0s - loss: 0.0173 93/102 [==========================>...] - ETA: 0s - loss: 0.0172 94/102 [==========================>...] - ETA: 0s - loss: 0.0172 95/102 [==========================>...] - ETA: 0s - loss: 0.0174 96/102 [===========================>..] - ETA: 0s - loss: 0.0172 97/102 [===========================>..] - ETA: 0s - loss: 0.0172 98/102 [===========================>..] - ETA: 0s - loss: 0.0171 99/102 [============================>.] - ETA: 0s - loss: 0.0171100/102 [============================>.] - ETA: 0s - loss: 0.0169101/102 [============================>.] - ETA: 0s - loss: 0.0168102/102 [==============================] - ETA: 0s - loss: 0.0168102/102 [==============================] - 10s 99ms/step - loss: 0.0168 - val_loss: 0.0087 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.0217 5/16 [========>.....................] - ETA: 0s - loss: 0.0344 9/16 [===============>..............] - ETA: 0s - loss: 0.029713/16 [=======================>......] - ETA: 0s - loss: 0.030416/16 [==============================] - 0s 16ms/step - loss: 0.0323
Test Loss: 0.03226611390709877
Saved model as forecasting_models_v5/model_lstm_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LSTM model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 828ms/step
Predicted QoE for the next time step: 77.69469600432872
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/lstm_with_stats.h5
Completed at Τετ 14 Μαΐ 2025 10:11:37 μμ EEST
=====================================================

=====================================================
Training gru model with config: basic
Starting at Τετ 14 Μαΐ 2025 10:11:37 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type gru                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --attention_units 128
2025-05-14 22:11:37.749404: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:11:37.890985: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:11:38.467360: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:11:38.467444: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:11:38.467453: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:11:45.118395: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:11:45.774920: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:11:45.774944: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:11:45.775080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5579 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 5, 96)             41184     
                                                                 
 gru_1 (GRU)                 (None, 5, 96)             55872     
                                                                 
 gru_2 (GRU)                 (None, 5, 96)             55872     
                                                                 
 gru_3 (GRU)                 (None, 5, 96)             55872     
                                                                 
 self_attention (SelfAttenti  (None, 96)               12544     
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                2425      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 223,795
Trainable params: 223,795
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 13:05 - loss: 0.3741  2/102 [..............................] - ETA: 8s - loss: 0.3433     3/102 [..............................] - ETA: 8s - loss: 0.3110  4/102 [>.............................] - ETA: 8s - loss: 0.2787  5/102 [>.............................] - ETA: 8s - loss: 0.2526  6/102 [>.............................] - ETA: 7s - loss: 0.2176  7/102 [=>............................] - ETA: 7s - loss: 0.1910  8/102 [=>............................] - ETA: 7s - loss: 0.1762  9/102 [=>............................] - ETA: 7s - loss: 0.1642 10/102 [=>............................] - ETA: 7s - loss: 0.1568 11/102 [==>...........................] - ETA: 7s - loss: 0.1486 12/102 [==>...........................] - ETA: 7s - loss: 0.1376 13/102 [==>...........................] - ETA: 7s - loss: 0.1302 14/102 [===>..........................] - ETA: 7s - loss: 0.1233 15/102 [===>..........................] - ETA: 7s - loss: 0.1174 16/102 [===>..........................] - ETA: 7s - loss: 0.1135 17/102 [====>.........................] - ETA: 7s - loss: 0.1099 18/102 [====>.........................] - ETA: 7s - loss: 0.1072 19/102 [====>.........................] - ETA: 7s - loss: 0.1035 20/102 [====>.........................] - ETA: 6s - loss: 0.0998 21/102 [=====>........................] - ETA: 6s - loss: 0.0971 22/102 [=====>........................] - ETA: 6s - loss: 0.0940 23/102 [=====>........................] - ETA: 6s - loss: 0.0915 24/102 [======>.......................] - ETA: 6s - loss: 0.0885 25/102 [======>.......................] - ETA: 6s - loss: 0.0866 26/102 [======>.......................] - ETA: 6s - loss: 0.0848 27/102 [======>.......................] - ETA: 6s - loss: 0.0826 28/102 [=======>......................] - ETA: 6s - loss: 0.0809 29/102 [=======>......................] - ETA: 6s - loss: 0.0791 30/102 [=======>......................] - ETA: 6s - loss: 0.0772 31/102 [========>.....................] - ETA: 6s - loss: 0.0759 32/102 [========>.....................] - ETA: 5s - loss: 0.0742 33/102 [========>.....................] - ETA: 5s - loss: 0.0727 34/102 [=========>....................] - ETA: 5s - loss: 0.0709 35/102 [=========>....................] - ETA: 5s - loss: 0.0698 36/102 [=========>....................] - ETA: 5s - loss: 0.0682 37/102 [=========>....................] - ETA: 5s - loss: 0.0672 38/102 [==========>...................] - ETA: 5s - loss: 0.0661 39/102 [==========>...................] - ETA: 5s - loss: 0.0648 40/102 [==========>...................] - ETA: 5s - loss: 0.0637 41/102 [===========>..................] - ETA: 5s - loss: 0.0627 42/102 [===========>..................] - ETA: 5s - loss: 0.0623 43/102 [===========>..................] - ETA: 5s - loss: 0.0612 44/102 [===========>..................] - ETA: 4s - loss: 0.0609 45/102 [============>.................] - ETA: 4s - loss: 0.0607 46/102 [============>.................] - ETA: 4s - loss: 0.0597 47/102 [============>.................] - ETA: 4s - loss: 0.0589 48/102 [=============>................] - ETA: 4s - loss: 0.0583 49/102 [=============>................] - ETA: 4s - loss: 0.0578 50/102 [=============>................] - ETA: 4s - loss: 0.0573 51/102 [==============>...............] - ETA: 4s - loss: 0.0565 52/102 [==============>...............] - ETA: 4s - loss: 0.0558 53/102 [==============>...............] - ETA: 4s - loss: 0.0551 54/102 [==============>...............] - ETA: 4s - loss: 0.0544 55/102 [===============>..............] - ETA: 4s - loss: 0.0538 56/102 [===============>..............] - ETA: 3s - loss: 0.0532 57/102 [===============>..............] - ETA: 3s - loss: 0.0525 58/102 [================>.............] - ETA: 3s - loss: 0.0518 59/102 [================>.............] - ETA: 3s - loss: 0.0512 60/102 [================>.............] - ETA: 3s - loss: 0.0507 61/102 [================>.............] - ETA: 3s - loss: 0.0500 62/102 [=================>............] - ETA: 3s - loss: 0.0495 63/102 [=================>............] - ETA: 3s - loss: 0.0494 64/102 [=================>............] - ETA: 3s - loss: 0.0490 65/102 [==================>...........] - ETA: 3s - loss: 0.0487 66/102 [==================>...........] - ETA: 3s - loss: 0.0484 67/102 [==================>...........] - ETA: 2s - loss: 0.0478 68/102 [===================>..........] - ETA: 2s - loss: 0.0475 69/102 [===================>..........] - ETA: 2s - loss: 0.0469 70/102 [===================>..........] - ETA: 2s - loss: 0.0464 71/102 [===================>..........] - ETA: 2s - loss: 0.0460 72/102 [====================>.........] - ETA: 2s - loss: 0.0456 73/102 [====================>.........] - ETA: 2s - loss: 0.0452 74/102 [====================>.........] - ETA: 2s - loss: 0.0448 75/102 [=====================>........] - ETA: 2s - loss: 0.0445 76/102 [=====================>........] - ETA: 2s - loss: 0.0441 77/102 [=====================>........] - ETA: 2s - loss: 0.0440 78/102 [=====================>........] - ETA: 2s - loss: 0.0437 79/102 [======================>.......] - ETA: 1s - loss: 0.0433 80/102 [======================>.......] - ETA: 1s - loss: 0.0430 81/102 [======================>.......] - ETA: 1s - loss: 0.0427 82/102 [=======================>......] - ETA: 1s - loss: 0.0425 83/102 [=======================>......] - ETA: 1s - loss: 0.0421 84/102 [=======================>......] - ETA: 1s - loss: 0.0418 85/102 [========================>.....] - ETA: 1s - loss: 0.0415 86/102 [========================>.....] - ETA: 1s - loss: 0.0413 87/102 [========================>.....] - ETA: 1s - loss: 0.0409 88/102 [========================>.....] - ETA: 1s - loss: 0.0406 89/102 [=========================>....] - ETA: 1s - loss: 0.0404 90/102 [=========================>....] - ETA: 1s - loss: 0.0403 91/102 [=========================>....] - ETA: 0s - loss: 0.0400 92/102 [==========================>...] - ETA: 0s - loss: 0.0399 93/102 [==========================>...] - ETA: 0s - loss: 0.0396 94/102 [==========================>...] - ETA: 0s - loss: 0.0394 95/102 [==========================>...] - ETA: 0s - loss: 0.0391 96/102 [===========================>..] - ETA: 0s - loss: 0.0389 97/102 [===========================>..] - ETA: 0s - loss: 0.0388 98/102 [===========================>..] - ETA: 0s - loss: 0.0386 99/102 [============================>.] - ETA: 0s - loss: 0.0384100/102 [============================>.] - ETA: 0s - loss: 0.0385101/102 [============================>.] - ETA: 0s - loss: 0.0383102/102 [==============================] - ETA: 0s - loss: 0.0384102/102 [==============================] - 18s 100ms/step - loss: 0.0384 - val_loss: 0.0081 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 8s - loss: 0.0284  2/102 [..............................] - ETA: 7s - loss: 0.0200  3/102 [..............................] - ETA: 8s - loss: 0.0190  4/102 [>.............................] - ETA: 8s - loss: 0.0178  5/102 [>.............................] - ETA: 7s - loss: 0.0168  6/102 [>.............................] - ETA: 8s - loss: 0.0175  7/102 [=>............................] - ETA: 8s - loss: 0.0181  8/102 [=>............................] - ETA: 7s - loss: 0.0172  9/102 [=>............................] - ETA: 7s - loss: 0.0181 10/102 [=>............................] - ETA: 7s - loss: 0.0187 11/102 [==>...........................] - ETA: 7s - loss: 0.0193 12/102 [==>...........................] - ETA: 7s - loss: 0.0190 13/102 [==>...........................] - ETA: 7s - loss: 0.0187 14/102 [===>..........................] - ETA: 7s - loss: 0.0193 15/102 [===>..........................] - ETA: 7s - loss: 0.0198 16/102 [===>..........................] - ETA: 7s - loss: 0.0197 17/102 [====>.........................] - ETA: 7s - loss: 0.0192 18/102 [====>.........................] - ETA: 7s - loss: 0.0192 19/102 [====>.........................] - ETA: 7s - loss: 0.0186 20/102 [====>.........................] - ETA: 7s - loss: 0.0184 21/102 [=====>........................] - ETA: 6s - loss: 0.0184 22/102 [=====>........................] - ETA: 6s - loss: 0.0186 23/102 [=====>........................] - ETA: 6s - loss: 0.0186 24/102 [======>.......................] - ETA: 6s - loss: 0.0190 25/102 [======>.......................] - ETA: 6s - loss: 0.0187 26/102 [======>.......................] - ETA: 6s - loss: 0.0192 27/102 [======>.......................] - ETA: 6s - loss: 0.0196 28/102 [=======>......................] - ETA: 6s - loss: 0.0193 29/102 [=======>......................] - ETA: 6s - loss: 0.0193 30/102 [=======>......................] - ETA: 6s - loss: 0.0194 31/102 [========>.....................] - ETA: 6s - loss: 0.0194 32/102 [========>.....................] - ETA: 6s - loss: 0.0193 33/102 [========>.....................] - ETA: 5s - loss: 0.0191 34/102 [=========>....................] - ETA: 5s - loss: 0.0189 35/102 [=========>....................] - ETA: 5s - loss: 0.0186 36/102 [=========>....................] - ETA: 5s - loss: 0.0194 37/102 [=========>....................] - ETA: 5s - loss: 0.0194 38/102 [==========>...................] - ETA: 5s - loss: 0.0190 39/102 [==========>...................] - ETA: 5s - loss: 0.0191 40/102 [==========>...................] - ETA: 5s - loss: 0.0193 41/102 [===========>..................] - ETA: 5s - loss: 0.0193 42/102 [===========>..................] - ETA: 5s - loss: 0.0197 43/102 [===========>..................] - ETA: 5s - loss: 0.0200 44/102 [===========>..................] - ETA: 4s - loss: 0.0203 45/102 [============>.................] - ETA: 4s - loss: 0.0205 46/102 [============>.................] - ETA: 4s - loss: 0.0207 47/102 [============>.................] - ETA: 4s - loss: 0.0211 48/102 [=============>................] - ETA: 4s - loss: 0.0211 49/102 [=============>................] - ETA: 4s - loss: 0.0211 50/102 [=============>................] - ETA: 4s - loss: 0.0210 51/102 [==============>...............] - ETA: 4s - loss: 0.0209 52/102 [==============>...............] - ETA: 4s - loss: 0.0209 53/102 [==============>...............] - ETA: 4s - loss: 0.0211 54/102 [==============>...............] - ETA: 4s - loss: 0.0211 55/102 [===============>..............] - ETA: 4s - loss: 0.0211 56/102 [===============>..............] - ETA: 3s - loss: 0.0209 57/102 [===============>..............] - ETA: 3s - loss: 0.0208 58/102 [================>.............] - ETA: 3s - loss: 0.0206 59/102 [================>.............] - ETA: 3s - loss: 0.0204 60/102 [================>.............] - ETA: 3s - loss: 0.0202 61/102 [================>.............] - ETA: 3s - loss: 0.0203 62/102 [=================>............] - ETA: 3s - loss: 0.0202 63/102 [=================>............] - ETA: 3s - loss: 0.0200 64/102 [=================>............] - ETA: 3s - loss: 0.0201 65/102 [==================>...........] - ETA: 3s - loss: 0.0199 66/102 [==================>...........] - ETA: 3s - loss: 0.0199 67/102 [==================>...........] - ETA: 3s - loss: 0.0198 68/102 [===================>..........] - ETA: 2s - loss: 0.0199 69/102 [===================>..........] - ETA: 2s - loss: 0.0197 70/102 [===================>..........] - ETA: 2s - loss: 0.0196 71/102 [===================>..........] - ETA: 2s - loss: 0.0195 72/102 [====================>.........] - ETA: 2s - loss: 0.0195 73/102 [====================>.........] - ETA: 2s - loss: 0.0196 74/102 [====================>.........] - ETA: 2s - loss: 0.0195 75/102 [=====================>........] - ETA: 2s - loss: 0.0194 76/102 [=====================>........] - ETA: 2s - loss: 0.0194 77/102 [=====================>........] - ETA: 2s - loss: 0.0195 78/102 [=====================>........] - ETA: 2s - loss: 0.0198 79/102 [======================>.......] - ETA: 1s - loss: 0.0197 80/102 [======================>.......] - ETA: 1s - loss: 0.0196 81/102 [======================>.......] - ETA: 1s - loss: 0.0197 82/102 [=======================>......] - ETA: 1s - loss: 0.0197 83/102 [=======================>......] - ETA: 1s - loss: 0.0199 84/102 [=======================>......] - ETA: 1s - loss: 0.0198 85/102 [========================>.....] - ETA: 1s - loss: 0.0197 86/102 [========================>.....] - ETA: 1s - loss: 0.0197 87/102 [========================>.....] - ETA: 1s - loss: 0.0196 88/102 [========================>.....] - ETA: 1s - loss: 0.0194 89/102 [=========================>....] - ETA: 1s - loss: 0.0195 90/102 [=========================>....] - ETA: 1s - loss: 0.0194 91/102 [=========================>....] - ETA: 0s - loss: 0.0195 92/102 [==========================>...] - ETA: 0s - loss: 0.0196 93/102 [==========================>...] - ETA: 0s - loss: 0.0197 94/102 [==========================>...] - ETA: 0s - loss: 0.0196 95/102 [==========================>...] - ETA: 0s - loss: 0.0195 96/102 [===========================>..] - ETA: 0s - loss: 0.0194 97/102 [===========================>..] - ETA: 0s - loss: 0.0194 98/102 [===========================>..] - ETA: 0s - loss: 0.0194 99/102 [============================>.] - ETA: 0s - loss: 0.0195100/102 [============================>.] - ETA: 0s - loss: 0.0194101/102 [============================>.] - ETA: 0s - loss: 0.0194102/102 [==============================] - ETA: 0s - loss: 0.0194102/102 [==============================] - 9s 90ms/step - loss: 0.0194 - val_loss: 0.0087 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 8s - loss: 0.0132  2/102 [..............................] - ETA: 8s - loss: 0.0138  3/102 [..............................] - ETA: 8s - loss: 0.0129  4/102 [>.............................] - ETA: 8s - loss: 0.0115  5/102 [>.............................] - ETA: 8s - loss: 0.0162  6/102 [>.............................] - ETA: 8s - loss: 0.0159  7/102 [=>............................] - ETA: 8s - loss: 0.0181  8/102 [=>............................] - ETA: 8s - loss: 0.0177  9/102 [=>............................] - ETA: 8s - loss: 0.0169 10/102 [=>............................] - ETA: 8s - loss: 0.0165 11/102 [==>...........................] - ETA: 7s - loss: 0.0177 12/102 [==>...........................] - ETA: 7s - loss: 0.0195 13/102 [==>...........................] - ETA: 7s - loss: 0.0190 14/102 [===>..........................] - ETA: 7s - loss: 0.0181 15/102 [===>..........................] - ETA: 7s - loss: 0.0184 16/102 [===>..........................] - ETA: 7s - loss: 0.0181 17/102 [====>.........................] - ETA: 7s - loss: 0.0178 18/102 [====>.........................] - ETA: 7s - loss: 0.0174 19/102 [====>.........................] - ETA: 7s - loss: 0.0183 20/102 [====>.........................] - ETA: 7s - loss: 0.0186 21/102 [=====>........................] - ETA: 6s - loss: 0.0186 22/102 [=====>........................] - ETA: 6s - loss: 0.0192 23/102 [=====>........................] - ETA: 6s - loss: 0.0196 24/102 [======>.......................] - ETA: 6s - loss: 0.0198 25/102 [======>.......................] - ETA: 6s - loss: 0.0200 26/102 [======>.......................] - ETA: 6s - loss: 0.0202 27/102 [======>.......................] - ETA: 6s - loss: 0.0211 28/102 [=======>......................] - ETA: 6s - loss: 0.0214 29/102 [=======>......................] - ETA: 6s - loss: 0.0213 30/102 [=======>......................] - ETA: 6s - loss: 0.0210 31/102 [========>.....................] - ETA: 6s - loss: 0.0208 32/102 [========>.....................] - ETA: 6s - loss: 0.0209 33/102 [========>.....................] - ETA: 6s - loss: 0.0205 34/102 [=========>....................] - ETA: 5s - loss: 0.0203 35/102 [=========>....................] - ETA: 5s - loss: 0.0206 36/102 [=========>....................] - ETA: 5s - loss: 0.0203 37/102 [=========>....................] - ETA: 5s - loss: 0.0204 38/102 [==========>...................] - ETA: 5s - loss: 0.0202 39/102 [==========>...................] - ETA: 5s - loss: 0.0199 40/102 [==========>...................] - ETA: 5s - loss: 0.0197 41/102 [===========>..................] - ETA: 5s - loss: 0.0200 42/102 [===========>..................] - ETA: 5s - loss: 0.0196 43/102 [===========>..................] - ETA: 5s - loss: 0.0199 44/102 [===========>..................] - ETA: 4s - loss: 0.0197 45/102 [============>.................] - ETA: 4s - loss: 0.0198 46/102 [============>.................] - ETA: 4s - loss: 0.0198 47/102 [============>.................] - ETA: 4s - loss: 0.0195 48/102 [=============>................] - ETA: 4s - loss: 0.0196 49/102 [=============>................] - ETA: 4s - loss: 0.0199 50/102 [=============>................] - ETA: 4s - loss: 0.0197 51/102 [==============>...............] - ETA: 4s - loss: 0.0199 52/102 [==============>...............] - ETA: 4s - loss: 0.0199 53/102 [==============>...............] - ETA: 4s - loss: 0.0199 54/102 [==============>...............] - ETA: 4s - loss: 0.0203 55/102 [===============>..............] - ETA: 4s - loss: 0.0202 56/102 [===============>..............] - ETA: 3s - loss: 0.0200 57/102 [===============>..............] - ETA: 3s - loss: 0.0198 58/102 [================>.............] - ETA: 3s - loss: 0.0198 59/102 [================>.............] - ETA: 3s - loss: 0.0195 60/102 [================>.............] - ETA: 3s - loss: 0.0194 61/102 [================>.............] - ETA: 3s - loss: 0.0192 62/102 [=================>............] - ETA: 3s - loss: 0.0192 63/102 [=================>............] - ETA: 3s - loss: 0.0192 64/102 [=================>............] - ETA: 3s - loss: 0.0194 65/102 [==================>...........] - ETA: 3s - loss: 0.0192 66/102 [==================>...........] - ETA: 3s - loss: 0.0192 67/102 [==================>...........] - ETA: 3s - loss: 0.0195 68/102 [===================>..........] - ETA: 2s - loss: 0.0193 69/102 [===================>..........] - ETA: 2s - loss: 0.0192 70/102 [===================>..........] - ETA: 2s - loss: 0.0191 71/102 [===================>..........] - ETA: 2s - loss: 0.0193 72/102 [====================>.........] - ETA: 2s - loss: 0.0191 73/102 [====================>.........] - ETA: 2s - loss: 0.0192 74/102 [====================>.........] - ETA: 2s - loss: 0.0191 75/102 [=====================>........] - ETA: 2s - loss: 0.0193 76/102 [=====================>........] - ETA: 2s - loss: 0.0192 77/102 [=====================>........] - ETA: 2s - loss: 0.0191 78/102 [=====================>........] - ETA: 2s - loss: 0.0190 79/102 [======================>.......] - ETA: 2s - loss: 0.0189 80/102 [======================>.......] - ETA: 1s - loss: 0.0188 81/102 [======================>.......] - ETA: 1s - loss: 0.0189 82/102 [=======================>......] - ETA: 1s - loss: 0.0188 83/102 [=======================>......] - ETA: 1s - loss: 0.0187 84/102 [=======================>......] - ETA: 1s - loss: 0.0187 85/102 [========================>.....] - ETA: 1s - loss: 0.0187 86/102 [========================>.....] - ETA: 1s - loss: 0.0188 87/102 [========================>.....] - ETA: 1s - loss: 0.0187 88/102 [========================>.....] - ETA: 1s - loss: 0.0187 89/102 [=========================>....] - ETA: 1s - loss: 0.0187 90/102 [=========================>....] - ETA: 1s - loss: 0.0188 91/102 [=========================>....] - ETA: 0s - loss: 0.0188 92/102 [==========================>...] - ETA: 0s - loss: 0.0188 93/102 [==========================>...] - ETA: 0s - loss: 0.0189 94/102 [==========================>...] - ETA: 0s - loss: 0.0188 95/102 [==========================>...] - ETA: 0s - loss: 0.0188 96/102 [===========================>..] - ETA: 0s - loss: 0.0188 97/102 [===========================>..] - ETA: 0s - loss: 0.0187 98/102 [===========================>..] - ETA: 0s - loss: 0.0187 99/102 [============================>.] - ETA: 0s - loss: 0.0186100/102 [============================>.] - ETA: 0s - loss: 0.0185101/102 [============================>.] - ETA: 0s - loss: 0.0184102/102 [==============================] - ETA: 0s - loss: 0.0184102/102 [==============================] - 9s 91ms/step - loss: 0.0184 - val_loss: 0.0086 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 8s - loss: 0.0245  2/102 [..............................] - ETA: 8s - loss: 0.0208  3/102 [..............................] - ETA: 8s - loss: 0.0253  4/102 [>.............................] - ETA: 8s - loss: 0.0224  5/102 [>.............................] - ETA: 8s - loss: 0.0222  6/102 [>.............................] - ETA: 8s - loss: 0.0235  7/102 [=>............................] - ETA: 7s - loss: 0.0208  8/102 [=>............................] - ETA: 7s - loss: 0.0229  9/102 [=>............................] - ETA: 7s - loss: 0.0214 10/102 [=>............................] - ETA: 7s - loss: 0.0201 11/102 [==>...........................] - ETA: 7s - loss: 0.0190 12/102 [==>...........................] - ETA: 7s - loss: 0.0186 13/102 [==>...........................] - ETA: 7s - loss: 0.0193 14/102 [===>..........................] - ETA: 7s - loss: 0.0188 15/102 [===>..........................] - ETA: 7s - loss: 0.0194 16/102 [===>..........................] - ETA: 7s - loss: 0.0199 17/102 [====>.........................] - ETA: 7s - loss: 0.0193 18/102 [====>.........................] - ETA: 7s - loss: 0.0199 19/102 [====>.........................] - ETA: 7s - loss: 0.0193 20/102 [====>.........................] - ETA: 6s - loss: 0.0191 21/102 [=====>........................] - ETA: 6s - loss: 0.0189 22/102 [=====>........................] - ETA: 6s - loss: 0.0194 23/102 [=====>........................] - ETA: 6s - loss: 0.0204 24/102 [======>.......................] - ETA: 6s - loss: 0.0199 25/102 [======>.......................] - ETA: 6s - loss: 0.0203 26/102 [======>.......................] - ETA: 6s - loss: 0.0202 27/102 [======>.......................] - ETA: 6s - loss: 0.0198 28/102 [=======>......................] - ETA: 6s - loss: 0.0197 29/102 [=======>......................] - ETA: 6s - loss: 0.0193 30/102 [=======>......................] - ETA: 6s - loss: 0.0189 31/102 [========>.....................] - ETA: 6s - loss: 0.0187 32/102 [========>.....................] - ETA: 5s - loss: 0.0183 33/102 [========>.....................] - ETA: 5s - loss: 0.0180 34/102 [=========>....................] - ETA: 5s - loss: 0.0180 35/102 [=========>....................] - ETA: 5s - loss: 0.0180 36/102 [=========>....................] - ETA: 5s - loss: 0.0177 37/102 [=========>....................] - ETA: 5s - loss: 0.0182 38/102 [==========>...................] - ETA: 5s - loss: 0.0180 39/102 [==========>...................] - ETA: 5s - loss: 0.0177 40/102 [==========>...................] - ETA: 5s - loss: 0.0177 41/102 [===========>..................] - ETA: 5s - loss: 0.0178 42/102 [===========>..................] - ETA: 5s - loss: 0.0178 43/102 [===========>..................] - ETA: 5s - loss: 0.0177 44/102 [===========>..................] - ETA: 5s - loss: 0.0176 45/102 [============>.................] - ETA: 4s - loss: 0.0180 46/102 [============>.................] - ETA: 4s - loss: 0.0180 47/102 [============>.................] - ETA: 4s - loss: 0.0184 48/102 [=============>................] - ETA: 4s - loss: 0.0183 49/102 [=============>................] - ETA: 4s - loss: 0.0181 50/102 [=============>................] - ETA: 4s - loss: 0.0179 51/102 [==============>...............] - ETA: 4s - loss: 0.0179 52/102 [==============>...............] - ETA: 4s - loss: 0.0177 53/102 [==============>...............] - ETA: 4s - loss: 0.0178 54/102 [==============>...............] - ETA: 4s - loss: 0.0178 55/102 [===============>..............] - ETA: 4s - loss: 0.0177 56/102 [===============>..............] - ETA: 3s - loss: 0.0177 57/102 [===============>..............] - ETA: 3s - loss: 0.0176 58/102 [================>.............] - ETA: 3s - loss: 0.0176 59/102 [================>.............] - ETA: 3s - loss: 0.0177 60/102 [================>.............] - ETA: 3s - loss: 0.0176 61/102 [================>.............] - ETA: 3s - loss: 0.0175 62/102 [=================>............] - ETA: 3s - loss: 0.0174 63/102 [=================>............] - ETA: 3s - loss: 0.0174 64/102 [=================>............] - ETA: 3s - loss: 0.0172 65/102 [==================>...........] - ETA: 3s - loss: 0.0171 66/102 [==================>...........] - ETA: 3s - loss: 0.0170 67/102 [==================>...........] - ETA: 3s - loss: 0.0171 68/102 [===================>..........] - ETA: 2s - loss: 0.0174 69/102 [===================>..........] - ETA: 2s - loss: 0.0174 70/102 [===================>..........] - ETA: 2s - loss: 0.0172 71/102 [===================>..........] - ETA: 2s - loss: 0.0173 72/102 [====================>.........] - ETA: 2s - loss: 0.0172 73/102 [====================>.........] - ETA: 2s - loss: 0.0172 74/102 [====================>.........] - ETA: 2s - loss: 0.0171 75/102 [=====================>........] - ETA: 2s - loss: 0.0171 76/102 [=====================>........] - ETA: 2s - loss: 0.0173 77/102 [=====================>........] - ETA: 2s - loss: 0.0172 78/102 [=====================>........] - ETA: 2s - loss: 0.0172 79/102 [======================>.......] - ETA: 1s - loss: 0.0172 80/102 [======================>.......] - ETA: 1s - loss: 0.0171 81/102 [======================>.......] - ETA: 1s - loss: 0.0169 82/102 [=======================>......] - ETA: 1s - loss: 0.0168 83/102 [=======================>......] - ETA: 1s - loss: 0.0169 84/102 [=======================>......] - ETA: 1s - loss: 0.0170 85/102 [========================>.....] - ETA: 1s - loss: 0.0173 86/102 [========================>.....] - ETA: 1s - loss: 0.0172 87/102 [========================>.....] - ETA: 1s - loss: 0.0172 88/102 [========================>.....] - ETA: 1s - loss: 0.0172 89/102 [=========================>....] - ETA: 1s - loss: 0.0172 90/102 [=========================>....] - ETA: 1s - loss: 0.0171 91/102 [=========================>....] - ETA: 0s - loss: 0.0171 92/102 [==========================>...] - ETA: 0s - loss: 0.0172 93/102 [==========================>...] - ETA: 0s - loss: 0.0171 94/102 [==========================>...] - ETA: 0s - loss: 0.0171 95/102 [==========================>...] - ETA: 0s - loss: 0.0174 96/102 [===========================>..] - ETA: 0s - loss: 0.0173 97/102 [===========================>..] - ETA: 0s - loss: 0.0174 98/102 [===========================>..] - ETA: 0s - loss: 0.0174 99/102 [============================>.] - ETA: 0s - loss: 0.0175100/102 [============================>.] - ETA: 0s - loss: 0.0174101/102 [============================>.] - ETA: 0s - loss: 0.0175102/102 [==============================] - ETA: 0s - loss: 0.0175102/102 [==============================] - 9s 91ms/step - loss: 0.0175 - val_loss: 0.0095 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.0260 5/16 [========>.....................] - ETA: 0s - loss: 0.0458 9/16 [===============>..............] - ETA: 0s - loss: 0.040513/16 [=======================>......] - ETA: 0s - loss: 0.042316/16 [==============================] - 0s 15ms/step - loss: 0.0465
Test Loss: 0.04654466360807419
Saved model as forecasting_models_v5/model_gru_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for GRU model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 930ms/step
Predicted QoE for the next time step: 87.92799512567568
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/gru_basic.h5
Completed at Τετ 14 Μαΐ 2025 10:12:36 μμ EEST
=====================================================

=====================================================
Training gru model with config: deep
Starting at Τετ 14 Μαΐ 2025 10:12:36 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type gru                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --num_layers 3 --attention_units 128
2025-05-14 22:12:36.788528: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:12:36.932825: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:12:37.513966: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:12:37.514056: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:12:37.514067: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:12:44.003726: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:12:44.670300: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:12:44.670325: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:12:44.670454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5572 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 5, 96)             41184     
                                                                 
 gru_1 (GRU)                 (None, 5, 96)             55872     
                                                                 
 gru_2 (GRU)                 (None, 5, 96)             55872     
                                                                 
 gru_3 (GRU)                 (None, 5, 96)             55872     
                                                                 
 self_attention (SelfAttenti  (None, 96)               12544     
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                2425      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 223,795
Trainable params: 223,795
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 13:03 - loss: 0.3243  2/102 [..............................] - ETA: 8s - loss: 0.2674     3/102 [..............................] - ETA: 8s - loss: 0.2347  4/102 [>.............................] - ETA: 8s - loss: 0.1971  5/102 [>.............................] - ETA: 7s - loss: 0.1628  6/102 [>.............................] - ETA: 7s - loss: 0.1484  7/102 [=>............................] - ETA: 7s - loss: 0.1343  8/102 [=>............................] - ETA: 7s - loss: 0.1223  9/102 [=>............................] - ETA: 7s - loss: 0.1119 10/102 [=>............................] - ETA: 7s - loss: 0.1032 11/102 [==>...........................] - ETA: 7s - loss: 0.0982 12/102 [==>...........................] - ETA: 7s - loss: 0.0931 13/102 [==>...........................] - ETA: 7s - loss: 0.0905 14/102 [===>..........................] - ETA: 7s - loss: 0.0875 15/102 [===>..........................] - ETA: 7s - loss: 0.0845 16/102 [===>..........................] - ETA: 7s - loss: 0.0807 17/102 [====>.........................] - ETA: 7s - loss: 0.0789 18/102 [====>.........................] - ETA: 7s - loss: 0.0757 19/102 [====>.........................] - ETA: 6s - loss: 0.0738 20/102 [====>.........................] - ETA: 6s - loss: 0.0710 21/102 [=====>........................] - ETA: 6s - loss: 0.0693 22/102 [=====>........................] - ETA: 6s - loss: 0.0684 23/102 [=====>........................] - ETA: 6s - loss: 0.0667 24/102 [======>.......................] - ETA: 6s - loss: 0.0649 25/102 [======>.......................] - ETA: 6s - loss: 0.0627 26/102 [======>.......................] - ETA: 6s - loss: 0.0611 27/102 [======>.......................] - ETA: 6s - loss: 0.0594 28/102 [=======>......................] - ETA: 6s - loss: 0.0583 29/102 [=======>......................] - ETA: 6s - loss: 0.0573 30/102 [=======>......................] - ETA: 6s - loss: 0.0570 31/102 [========>.....................] - ETA: 6s - loss: 0.0560 32/102 [========>.....................] - ETA: 5s - loss: 0.0551 33/102 [========>.....................] - ETA: 5s - loss: 0.0545 34/102 [=========>....................] - ETA: 5s - loss: 0.0537 35/102 [=========>....................] - ETA: 5s - loss: 0.0526 36/102 [=========>....................] - ETA: 5s - loss: 0.0518 37/102 [=========>....................] - ETA: 5s - loss: 0.0508 38/102 [==========>...................] - ETA: 5s - loss: 0.0506 39/102 [==========>...................] - ETA: 5s - loss: 0.0495 40/102 [==========>...................] - ETA: 5s - loss: 0.0488 41/102 [===========>..................] - ETA: 5s - loss: 0.0480 42/102 [===========>..................] - ETA: 5s - loss: 0.0472 43/102 [===========>..................] - ETA: 5s - loss: 0.0465 44/102 [===========>..................] - ETA: 4s - loss: 0.0461 45/102 [============>.................] - ETA: 4s - loss: 0.0454 46/102 [============>.................] - ETA: 4s - loss: 0.0448 47/102 [============>.................] - ETA: 4s - loss: 0.0442 48/102 [=============>................] - ETA: 4s - loss: 0.0442 49/102 [=============>................] - ETA: 4s - loss: 0.0440 50/102 [=============>................] - ETA: 4s - loss: 0.0437 51/102 [==============>...............] - ETA: 4s - loss: 0.0436 52/102 [==============>...............] - ETA: 4s - loss: 0.0431 53/102 [==============>...............] - ETA: 4s - loss: 0.0429 54/102 [==============>...............] - ETA: 4s - loss: 0.0428 55/102 [===============>..............] - ETA: 4s - loss: 0.0422 56/102 [===============>..............] - ETA: 3s - loss: 0.0418 57/102 [===============>..............] - ETA: 3s - loss: 0.0413 58/102 [================>.............] - ETA: 3s - loss: 0.0410 59/102 [================>.............] - ETA: 3s - loss: 0.0405 60/102 [================>.............] - ETA: 3s - loss: 0.0402 61/102 [================>.............] - ETA: 3s - loss: 0.0399 62/102 [=================>............] - ETA: 3s - loss: 0.0395 63/102 [=================>............] - ETA: 3s - loss: 0.0394 64/102 [=================>............] - ETA: 3s - loss: 0.0391 65/102 [==================>...........] - ETA: 3s - loss: 0.0387 66/102 [==================>...........] - ETA: 3s - loss: 0.0385 67/102 [==================>...........] - ETA: 3s - loss: 0.0382 68/102 [===================>..........] - ETA: 2s - loss: 0.0381 69/102 [===================>..........] - ETA: 2s - loss: 0.0379 70/102 [===================>..........] - ETA: 2s - loss: 0.0377 71/102 [===================>..........] - ETA: 2s - loss: 0.0374 72/102 [====================>.........] - ETA: 2s - loss: 0.0372 73/102 [====================>.........] - ETA: 2s - loss: 0.0369 74/102 [====================>.........] - ETA: 2s - loss: 0.0366 75/102 [=====================>........] - ETA: 2s - loss: 0.0363 76/102 [=====================>........] - ETA: 2s - loss: 0.0360 77/102 [=====================>........] - ETA: 2s - loss: 0.0357 78/102 [=====================>........] - ETA: 2s - loss: 0.0355 79/102 [======================>.......] - ETA: 1s - loss: 0.0353 80/102 [======================>.......] - ETA: 1s - loss: 0.0352 81/102 [======================>.......] - ETA: 1s - loss: 0.0350 82/102 [=======================>......] - ETA: 1s - loss: 0.0348 83/102 [=======================>......] - ETA: 1s - loss: 0.0344 84/102 [=======================>......] - ETA: 1s - loss: 0.0346 85/102 [========================>.....] - ETA: 1s - loss: 0.0345 86/102 [========================>.....] - ETA: 1s - loss: 0.0343 87/102 [========================>.....] - ETA: 1s - loss: 0.0341 88/102 [========================>.....] - ETA: 1s - loss: 0.0340 89/102 [=========================>....] - ETA: 1s - loss: 0.0339 90/102 [=========================>....] - ETA: 1s - loss: 0.0340 91/102 [=========================>....] - ETA: 0s - loss: 0.0339 92/102 [==========================>...] - ETA: 0s - loss: 0.0336 93/102 [==========================>...] - ETA: 0s - loss: 0.0334 94/102 [==========================>...] - ETA: 0s - loss: 0.0331 95/102 [==========================>...] - ETA: 0s - loss: 0.0329 96/102 [===========================>..] - ETA: 0s - loss: 0.0327 97/102 [===========================>..] - ETA: 0s - loss: 0.0325 98/102 [===========================>..] - ETA: 0s - loss: 0.0324 99/102 [============================>.] - ETA: 0s - loss: 0.0324100/102 [============================>.] - ETA: 0s - loss: 0.0323101/102 [============================>.] - ETA: 0s - loss: 0.0323102/102 [==============================] - ETA: 0s - loss: 0.0322102/102 [==============================] - 18s 101ms/step - loss: 0.0322 - val_loss: 0.0090 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 8s - loss: 0.0465  2/102 [..............................] - ETA: 8s - loss: 0.0354  3/102 [..............................] - ETA: 8s - loss: 0.0302  4/102 [>.............................] - ETA: 8s - loss: 0.0281  5/102 [>.............................] - ETA: 8s - loss: 0.0272  6/102 [>.............................] - ETA: 8s - loss: 0.0245  7/102 [=>............................] - ETA: 8s - loss: 0.0260  8/102 [=>............................] - ETA: 8s - loss: 0.0241  9/102 [=>............................] - ETA: 8s - loss: 0.0236 10/102 [=>............................] - ETA: 7s - loss: 0.0222 11/102 [==>...........................] - ETA: 7s - loss: 0.0221 12/102 [==>...........................] - ETA: 7s - loss: 0.0211 13/102 [==>...........................] - ETA: 7s - loss: 0.0206 14/102 [===>..........................] - ETA: 7s - loss: 0.0203 15/102 [===>..........................] - ETA: 7s - loss: 0.0206 16/102 [===>..........................] - ETA: 7s - loss: 0.0223 17/102 [====>.........................] - ETA: 7s - loss: 0.0221 18/102 [====>.........................] - ETA: 7s - loss: 0.0221 19/102 [====>.........................] - ETA: 7s - loss: 0.0222 20/102 [====>.........................] - ETA: 7s - loss: 0.0233 21/102 [=====>........................] - ETA: 7s - loss: 0.0233 22/102 [=====>........................] - ETA: 6s - loss: 0.0228 23/102 [=====>........................] - ETA: 6s - loss: 0.0225 24/102 [======>.......................] - ETA: 6s - loss: 0.0221 25/102 [======>.......................] - ETA: 6s - loss: 0.0215 26/102 [======>.......................] - ETA: 6s - loss: 0.0213 27/102 [======>.......................] - ETA: 6s - loss: 0.0218 28/102 [=======>......................] - ETA: 6s - loss: 0.0222 29/102 [=======>......................] - ETA: 6s - loss: 0.0229 30/102 [=======>......................] - ETA: 6s - loss: 0.0228 31/102 [========>.....................] - ETA: 6s - loss: 0.0226 32/102 [========>.....................] - ETA: 6s - loss: 0.0232 33/102 [========>.....................] - ETA: 6s - loss: 0.0228 34/102 [=========>....................] - ETA: 5s - loss: 0.0226 35/102 [=========>....................] - ETA: 5s - loss: 0.0226 36/102 [=========>....................] - ETA: 5s - loss: 0.0232 37/102 [=========>....................] - ETA: 5s - loss: 0.0231 38/102 [==========>...................] - ETA: 5s - loss: 0.0230 39/102 [==========>...................] - ETA: 5s - loss: 0.0227 40/102 [==========>...................] - ETA: 5s - loss: 0.0226 41/102 [===========>..................] - ETA: 5s - loss: 0.0226 42/102 [===========>..................] - ETA: 5s - loss: 0.0225 43/102 [===========>..................] - ETA: 5s - loss: 0.0222 44/102 [===========>..................] - ETA: 5s - loss: 0.0225 45/102 [============>.................] - ETA: 4s - loss: 0.0228 46/102 [============>.................] - ETA: 4s - loss: 0.0225 47/102 [============>.................] - ETA: 4s - loss: 0.0222 48/102 [=============>................] - ETA: 4s - loss: 0.0221 49/102 [=============>................] - ETA: 4s - loss: 0.0219 50/102 [=============>................] - ETA: 4s - loss: 0.0221 51/102 [==============>...............] - ETA: 4s - loss: 0.0220 52/102 [==============>...............] - ETA: 4s - loss: 0.0220 53/102 [==============>...............] - ETA: 4s - loss: 0.0220 54/102 [==============>...............] - ETA: 4s - loss: 0.0221 55/102 [===============>..............] - ETA: 4s - loss: 0.0221 56/102 [===============>..............] - ETA: 4s - loss: 0.0221 57/102 [===============>..............] - ETA: 3s - loss: 0.0222 58/102 [================>.............] - ETA: 3s - loss: 0.0220 59/102 [================>.............] - ETA: 3s - loss: 0.0220 60/102 [================>.............] - ETA: 3s - loss: 0.0220 61/102 [================>.............] - ETA: 3s - loss: 0.0221 62/102 [=================>............] - ETA: 3s - loss: 0.0219 63/102 [=================>............] - ETA: 3s - loss: 0.0218 64/102 [=================>............] - ETA: 3s - loss: 0.0217 65/102 [==================>...........] - ETA: 3s - loss: 0.0215 66/102 [==================>...........] - ETA: 3s - loss: 0.0214 67/102 [==================>...........] - ETA: 3s - loss: 0.0212 68/102 [===================>..........] - ETA: 2s - loss: 0.0217 69/102 [===================>..........] - ETA: 2s - loss: 0.0217 70/102 [===================>..........] - ETA: 2s - loss: 0.0217 71/102 [===================>..........] - ETA: 2s - loss: 0.0215 72/102 [====================>.........] - ETA: 2s - loss: 0.0214 73/102 [====================>.........] - ETA: 2s - loss: 0.0215 74/102 [====================>.........] - ETA: 2s - loss: 0.0215 75/102 [=====================>........] - ETA: 2s - loss: 0.0214 76/102 [=====================>........] - ETA: 2s - loss: 0.0216 77/102 [=====================>........] - ETA: 2s - loss: 0.0214 78/102 [=====================>........] - ETA: 2s - loss: 0.0215 79/102 [======================>.......] - ETA: 2s - loss: 0.0217 80/102 [======================>.......] - ETA: 1s - loss: 0.0216 81/102 [======================>.......] - ETA: 1s - loss: 0.0218 82/102 [=======================>......] - ETA: 1s - loss: 0.0217 83/102 [=======================>......] - ETA: 1s - loss: 0.0217 84/102 [=======================>......] - ETA: 1s - loss: 0.0215 85/102 [========================>.....] - ETA: 1s - loss: 0.0215 86/102 [========================>.....] - ETA: 1s - loss: 0.0214 87/102 [========================>.....] - ETA: 1s - loss: 0.0212 88/102 [========================>.....] - ETA: 1s - loss: 0.0211 89/102 [=========================>....] - ETA: 1s - loss: 0.0210 90/102 [=========================>....] - ETA: 1s - loss: 0.0211 91/102 [=========================>....] - ETA: 0s - loss: 0.0211 92/102 [==========================>...] - ETA: 0s - loss: 0.0210 93/102 [==========================>...] - ETA: 0s - loss: 0.0208 94/102 [==========================>...] - ETA: 0s - loss: 0.0208 95/102 [==========================>...] - ETA: 0s - loss: 0.0207 96/102 [===========================>..] - ETA: 0s - loss: 0.0206 97/102 [===========================>..] - ETA: 0s - loss: 0.0204 98/102 [===========================>..] - ETA: 0s - loss: 0.0203 99/102 [============================>.] - ETA: 0s - loss: 0.0203100/102 [============================>.] - ETA: 0s - loss: 0.0203101/102 [============================>.] - ETA: 0s - loss: 0.0204102/102 [==============================] - ETA: 0s - loss: 0.0204102/102 [==============================] - 9s 91ms/step - loss: 0.0204 - val_loss: 0.0080 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 9s - loss: 0.0322  2/102 [..............................] - ETA: 8s - loss: 0.0203  3/102 [..............................] - ETA: 9s - loss: 0.0190  4/102 [>.............................] - ETA: 8s - loss: 0.0186  5/102 [>.............................] - ETA: 8s - loss: 0.0216  6/102 [>.............................] - ETA: 8s - loss: 0.0239  7/102 [=>............................] - ETA: 8s - loss: 0.0236  8/102 [=>............................] - ETA: 8s - loss: 0.0231  9/102 [=>............................] - ETA: 8s - loss: 0.0222 10/102 [=>............................] - ETA: 8s - loss: 0.0233 11/102 [==>...........................] - ETA: 8s - loss: 0.0228 12/102 [==>...........................] - ETA: 8s - loss: 0.0231 13/102 [==>...........................] - ETA: 7s - loss: 0.0240 14/102 [===>..........................] - ETA: 7s - loss: 0.0227 15/102 [===>..........................] - ETA: 7s - loss: 0.0219 16/102 [===>..........................] - ETA: 7s - loss: 0.0219 17/102 [====>.........................] - ETA: 7s - loss: 0.0214 18/102 [====>.........................] - ETA: 7s - loss: 0.0208 19/102 [====>.........................] - ETA: 7s - loss: 0.0212 20/102 [====>.........................] - ETA: 7s - loss: 0.0209 21/102 [=====>........................] - ETA: 7s - loss: 0.0224 22/102 [=====>........................] - ETA: 7s - loss: 0.0225 23/102 [=====>........................] - ETA: 7s - loss: 0.0219 24/102 [======>.......................] - ETA: 6s - loss: 0.0214 25/102 [======>.......................] - ETA: 6s - loss: 0.0216 26/102 [======>.......................] - ETA: 6s - loss: 0.0214 27/102 [======>.......................] - ETA: 6s - loss: 0.0211 28/102 [=======>......................] - ETA: 6s - loss: 0.0208 29/102 [=======>......................] - ETA: 6s - loss: 0.0214 30/102 [=======>......................] - ETA: 6s - loss: 0.0211 31/102 [========>.....................] - ETA: 6s - loss: 0.0207 32/102 [========>.....................] - ETA: 6s - loss: 0.0204 33/102 [========>.....................] - ETA: 6s - loss: 0.0201 34/102 [=========>....................] - ETA: 5s - loss: 0.0198 35/102 [=========>....................] - ETA: 5s - loss: 0.0196 36/102 [=========>....................] - ETA: 5s - loss: 0.0197 37/102 [=========>....................] - ETA: 5s - loss: 0.0193 38/102 [==========>...................] - ETA: 5s - loss: 0.0191 39/102 [==========>...................] - ETA: 5s - loss: 0.0192 40/102 [==========>...................] - ETA: 5s - loss: 0.0191 41/102 [===========>..................] - ETA: 5s - loss: 0.0188 42/102 [===========>..................] - ETA: 5s - loss: 0.0188 43/102 [===========>..................] - ETA: 5s - loss: 0.0185 44/102 [===========>..................] - ETA: 5s - loss: 0.0183 45/102 [============>.................] - ETA: 4s - loss: 0.0183 46/102 [============>.................] - ETA: 4s - loss: 0.0187 47/102 [============>.................] - ETA: 4s - loss: 0.0185 48/102 [=============>................] - ETA: 4s - loss: 0.0187 49/102 [=============>................] - ETA: 4s - loss: 0.0188 50/102 [=============>................] - ETA: 4s - loss: 0.0186 51/102 [==============>...............] - ETA: 4s - loss: 0.0187 52/102 [==============>...............] - ETA: 4s - loss: 0.0185 53/102 [==============>...............] - ETA: 4s - loss: 0.0187 54/102 [==============>...............] - ETA: 4s - loss: 0.0185 55/102 [===============>..............] - ETA: 4s - loss: 0.0184 56/102 [===============>..............] - ETA: 4s - loss: 0.0185 57/102 [===============>..............] - ETA: 3s - loss: 0.0186 58/102 [================>.............] - ETA: 3s - loss: 0.0187 59/102 [================>.............] - ETA: 3s - loss: 0.0189 60/102 [================>.............] - ETA: 3s - loss: 0.0191 61/102 [================>.............] - ETA: 3s - loss: 0.0190 62/102 [=================>............] - ETA: 3s - loss: 0.0190 63/102 [=================>............] - ETA: 3s - loss: 0.0191 64/102 [=================>............] - ETA: 3s - loss: 0.0190 65/102 [==================>...........] - ETA: 3s - loss: 0.0191 66/102 [==================>...........] - ETA: 3s - loss: 0.0190 67/102 [==================>...........] - ETA: 3s - loss: 0.0189 68/102 [===================>..........] - ETA: 2s - loss: 0.0188 69/102 [===================>..........] - ETA: 2s - loss: 0.0188 70/102 [===================>..........] - ETA: 2s - loss: 0.0191 71/102 [===================>..........] - ETA: 2s - loss: 0.0189 72/102 [====================>.........] - ETA: 2s - loss: 0.0187 73/102 [====================>.........] - ETA: 2s - loss: 0.0186 74/102 [====================>.........] - ETA: 2s - loss: 0.0184 75/102 [=====================>........] - ETA: 2s - loss: 0.0185 76/102 [=====================>........] - ETA: 2s - loss: 0.0184 77/102 [=====================>........] - ETA: 2s - loss: 0.0186 78/102 [=====================>........] - ETA: 2s - loss: 0.0184 79/102 [======================>.......] - ETA: 2s - loss: 0.0183 80/102 [======================>.......] - ETA: 1s - loss: 0.0184 81/102 [======================>.......] - ETA: 1s - loss: 0.0183 82/102 [=======================>......] - ETA: 1s - loss: 0.0182 83/102 [=======================>......] - ETA: 1s - loss: 0.0184 84/102 [=======================>......] - ETA: 1s - loss: 0.0183 85/102 [========================>.....] - ETA: 1s - loss: 0.0181 86/102 [========================>.....] - ETA: 1s - loss: 0.0181 87/102 [========================>.....] - ETA: 1s - loss: 0.0182 88/102 [========================>.....] - ETA: 1s - loss: 0.0181 89/102 [=========================>....] - ETA: 1s - loss: 0.0181 90/102 [=========================>....] - ETA: 1s - loss: 0.0182 91/102 [=========================>....] - ETA: 0s - loss: 0.0182 92/102 [==========================>...] - ETA: 0s - loss: 0.0182 93/102 [==========================>...] - ETA: 0s - loss: 0.0182 94/102 [==========================>...] - ETA: 0s - loss: 0.0181 95/102 [==========================>...] - ETA: 0s - loss: 0.0181 96/102 [===========================>..] - ETA: 0s - loss: 0.0182 97/102 [===========================>..] - ETA: 0s - loss: 0.0181 98/102 [===========================>..] - ETA: 0s - loss: 0.0182 99/102 [============================>.] - ETA: 0s - loss: 0.0183100/102 [============================>.] - ETA: 0s - loss: 0.0182101/102 [============================>.] - ETA: 0s - loss: 0.0182102/102 [==============================] - ETA: 0s - loss: 0.0182102/102 [==============================] - 9s 91ms/step - loss: 0.0182 - val_loss: 0.0084 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 9s - loss: 0.0594  2/102 [..............................] - ETA: 8s - loss: 0.0401  3/102 [..............................] - ETA: 8s - loss: 0.0311  4/102 [>.............................] - ETA: 8s - loss: 0.0243  5/102 [>.............................] - ETA: 8s - loss: 0.0248  6/102 [>.............................] - ETA: 8s - loss: 0.0228  7/102 [=>............................] - ETA: 8s - loss: 0.0216  8/102 [=>............................] - ETA: 8s - loss: 0.0198  9/102 [=>............................] - ETA: 7s - loss: 0.0197 10/102 [=>............................] - ETA: 7s - loss: 0.0187 11/102 [==>...........................] - ETA: 7s - loss: 0.0181 12/102 [==>...........................] - ETA: 7s - loss: 0.0183 13/102 [==>...........................] - ETA: 7s - loss: 0.0190 14/102 [===>..........................] - ETA: 7s - loss: 0.0188 15/102 [===>..........................] - ETA: 7s - loss: 0.0185 16/102 [===>..........................] - ETA: 7s - loss: 0.0182 17/102 [====>.........................] - ETA: 7s - loss: 0.0178 18/102 [====>.........................] - ETA: 7s - loss: 0.0185 19/102 [====>.........................] - ETA: 7s - loss: 0.0178 20/102 [====>.........................] - ETA: 7s - loss: 0.0175 21/102 [=====>........................] - ETA: 6s - loss: 0.0178 22/102 [=====>........................] - ETA: 6s - loss: 0.0179 23/102 [=====>........................] - ETA: 6s - loss: 0.0176 24/102 [======>.......................] - ETA: 6s - loss: 0.0173 25/102 [======>.......................] - ETA: 6s - loss: 0.0177 26/102 [======>.......................] - ETA: 6s - loss: 0.0178 27/102 [======>.......................] - ETA: 6s - loss: 0.0175 28/102 [=======>......................] - ETA: 6s - loss: 0.0176 29/102 [=======>......................] - ETA: 6s - loss: 0.0178 30/102 [=======>......................] - ETA: 6s - loss: 0.0176 31/102 [========>.....................] - ETA: 6s - loss: 0.0176 32/102 [========>.....................] - ETA: 6s - loss: 0.0174 33/102 [========>.....................] - ETA: 5s - loss: 0.0180 34/102 [=========>....................] - ETA: 5s - loss: 0.0177 35/102 [=========>....................] - ETA: 5s - loss: 0.0177 36/102 [=========>....................] - ETA: 5s - loss: 0.0177 37/102 [=========>....................] - ETA: 5s - loss: 0.0177 38/102 [==========>...................] - ETA: 5s - loss: 0.0177 39/102 [==========>...................] - ETA: 5s - loss: 0.0176 40/102 [==========>...................] - ETA: 5s - loss: 0.0174 41/102 [===========>..................] - ETA: 5s - loss: 0.0172 42/102 [===========>..................] - ETA: 5s - loss: 0.0174 43/102 [===========>..................] - ETA: 5s - loss: 0.0175 44/102 [===========>..................] - ETA: 5s - loss: 0.0175 45/102 [============>.................] - ETA: 4s - loss: 0.0174 46/102 [============>.................] - ETA: 4s - loss: 0.0173 47/102 [============>.................] - ETA: 4s - loss: 0.0171 48/102 [=============>................] - ETA: 4s - loss: 0.0170 49/102 [=============>................] - ETA: 4s - loss: 0.0175 50/102 [=============>................] - ETA: 4s - loss: 0.0177 51/102 [==============>...............] - ETA: 4s - loss: 0.0175 52/102 [==============>...............] - ETA: 4s - loss: 0.0174 53/102 [==============>...............] - ETA: 4s - loss: 0.0174 54/102 [==============>...............] - ETA: 4s - loss: 0.0174 55/102 [===============>..............] - ETA: 4s - loss: 0.0175 56/102 [===============>..............] - ETA: 4s - loss: 0.0174 57/102 [===============>..............] - ETA: 3s - loss: 0.0172 58/102 [================>.............] - ETA: 3s - loss: 0.0171 59/102 [================>.............] - ETA: 3s - loss: 0.0170 60/102 [================>.............] - ETA: 3s - loss: 0.0169 61/102 [================>.............] - ETA: 3s - loss: 0.0168 62/102 [=================>............] - ETA: 3s - loss: 0.0170 63/102 [=================>............] - ETA: 3s - loss: 0.0170 64/102 [=================>............] - ETA: 3s - loss: 0.0169 65/102 [==================>...........] - ETA: 3s - loss: 0.0168 66/102 [==================>...........] - ETA: 3s - loss: 0.0169 67/102 [==================>...........] - ETA: 3s - loss: 0.0170 68/102 [===================>..........] - ETA: 2s - loss: 0.0171 69/102 [===================>..........] - ETA: 2s - loss: 0.0169 70/102 [===================>..........] - ETA: 2s - loss: 0.0168 71/102 [===================>..........] - ETA: 2s - loss: 0.0168 72/102 [====================>.........] - ETA: 2s - loss: 0.0170 73/102 [====================>.........] - ETA: 2s - loss: 0.0169 74/102 [====================>.........] - ETA: 2s - loss: 0.0171 75/102 [=====================>........] - ETA: 2s - loss: 0.0170 76/102 [=====================>........] - ETA: 2s - loss: 0.0172 77/102 [=====================>........] - ETA: 2s - loss: 0.0173 78/102 [=====================>........] - ETA: 2s - loss: 0.0173 79/102 [======================>.......] - ETA: 2s - loss: 0.0173 80/102 [======================>.......] - ETA: 1s - loss: 0.0172 81/102 [======================>.......] - ETA: 1s - loss: 0.0174 82/102 [=======================>......] - ETA: 1s - loss: 0.0173 83/102 [=======================>......] - ETA: 1s - loss: 0.0174 84/102 [=======================>......] - ETA: 1s - loss: 0.0174 85/102 [========================>.....] - ETA: 1s - loss: 0.0173 86/102 [========================>.....] - ETA: 1s - loss: 0.0174 87/102 [========================>.....] - ETA: 1s - loss: 0.0174 88/102 [========================>.....] - ETA: 1s - loss: 0.0173 89/102 [=========================>....] - ETA: 1s - loss: 0.0172 90/102 [=========================>....] - ETA: 1s - loss: 0.0171 91/102 [=========================>....] - ETA: 0s - loss: 0.0171 92/102 [==========================>...] - ETA: 0s - loss: 0.0171 93/102 [==========================>...] - ETA: 0s - loss: 0.0169 94/102 [==========================>...] - ETA: 0s - loss: 0.0171 95/102 [==========================>...] - ETA: 0s - loss: 0.0171 96/102 [===========================>..] - ETA: 0s - loss: 0.0171 97/102 [===========================>..] - ETA: 0s - loss: 0.0170 98/102 [===========================>..] - ETA: 0s - loss: 0.0171 99/102 [============================>.] - ETA: 0s - loss: 0.0171100/102 [============================>.] - ETA: 0s - loss: 0.0171101/102 [============================>.] - ETA: 0s - loss: 0.0170102/102 [==============================] - ETA: 0s - loss: 0.0170102/102 [==============================] - 9s 92ms/step - loss: 0.0170 - val_loss: 0.0100 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 10s - loss: 0.0211  2/102 [..............................] - ETA: 8s - loss: 0.0159   3/102 [..............................] - ETA: 8s - loss: 0.0165  4/102 [>.............................] - ETA: 8s - loss: 0.0163  5/102 [>.............................] - ETA: 8s - loss: 0.0143  6/102 [>.............................] - ETA: 8s - loss: 0.0131  7/102 [=>............................] - ETA: 8s - loss: 0.0128  8/102 [=>............................] - ETA: 8s - loss: 0.0138  9/102 [=>............................] - ETA: 8s - loss: 0.0144 10/102 [=>............................] - ETA: 8s - loss: 0.0150 11/102 [==>...........................] - ETA: 7s - loss: 0.0166 12/102 [==>...........................] - ETA: 7s - loss: 0.0157 13/102 [==>...........................] - ETA: 7s - loss: 0.0152 14/102 [===>..........................] - ETA: 7s - loss: 0.0147 15/102 [===>..........................] - ETA: 7s - loss: 0.0143 16/102 [===>..........................] - ETA: 7s - loss: 0.0147 17/102 [====>.........................] - ETA: 7s - loss: 0.0145 18/102 [====>.........................] - ETA: 7s - loss: 0.0154 19/102 [====>.........................] - ETA: 7s - loss: 0.0148 20/102 [====>.........................] - ETA: 7s - loss: 0.0152 21/102 [=====>........................] - ETA: 7s - loss: 0.0147 22/102 [=====>........................] - ETA: 6s - loss: 0.0142 23/102 [=====>........................] - ETA: 6s - loss: 0.0141 24/102 [======>.......................] - ETA: 6s - loss: 0.0140 25/102 [======>.......................] - ETA: 6s - loss: 0.0139 26/102 [======>.......................] - ETA: 6s - loss: 0.0138 27/102 [======>.......................] - ETA: 6s - loss: 0.0134 28/102 [=======>......................] - ETA: 6s - loss: 0.0134 29/102 [=======>......................] - ETA: 6s - loss: 0.0136 30/102 [=======>......................] - ETA: 6s - loss: 0.0141 31/102 [========>.....................] - ETA: 6s - loss: 0.0138 32/102 [========>.....................] - ETA: 6s - loss: 0.0139 33/102 [========>.....................] - ETA: 6s - loss: 0.0142 34/102 [=========>....................] - ETA: 5s - loss: 0.0140 35/102 [=========>....................] - ETA: 5s - loss: 0.0141 36/102 [=========>....................] - ETA: 5s - loss: 0.0138 37/102 [=========>....................] - ETA: 5s - loss: 0.0139 38/102 [==========>...................] - ETA: 5s - loss: 0.0142 39/102 [==========>...................] - ETA: 5s - loss: 0.0148 40/102 [==========>...................] - ETA: 5s - loss: 0.0148 41/102 [===========>..................] - ETA: 5s - loss: 0.0151 42/102 [===========>..................] - ETA: 5s - loss: 0.0150 43/102 [===========>..................] - ETA: 5s - loss: 0.0148 44/102 [===========>..................] - ETA: 5s - loss: 0.0149 45/102 [============>.................] - ETA: 4s - loss: 0.0150 46/102 [============>.................] - ETA: 4s - loss: 0.0155 47/102 [============>.................] - ETA: 4s - loss: 0.0158 48/102 [=============>................] - ETA: 4s - loss: 0.0163 49/102 [=============>................] - ETA: 4s - loss: 0.0162 50/102 [=============>................] - ETA: 4s - loss: 0.0161 51/102 [==============>...............] - ETA: 4s - loss: 0.0161 52/102 [==============>...............] - ETA: 4s - loss: 0.0160 53/102 [==============>...............] - ETA: 4s - loss: 0.0159 54/102 [==============>...............] - ETA: 4s - loss: 0.0158 55/102 [===============>..............] - ETA: 4s - loss: 0.0159 56/102 [===============>..............] - ETA: 4s - loss: 0.0158 57/102 [===============>..............] - ETA: 3s - loss: 0.0160 58/102 [================>.............] - ETA: 3s - loss: 0.0161 59/102 [================>.............] - ETA: 3s - loss: 0.0165 60/102 [================>.............] - ETA: 3s - loss: 0.0165 61/102 [================>.............] - ETA: 3s - loss: 0.0165 62/102 [=================>............] - ETA: 3s - loss: 0.0164 63/102 [=================>............] - ETA: 3s - loss: 0.0163 64/102 [=================>............] - ETA: 3s - loss: 0.0164 65/102 [==================>...........] - ETA: 3s - loss: 0.0167 66/102 [==================>...........] - ETA: 3s - loss: 0.0169 67/102 [==================>...........] - ETA: 3s - loss: 0.0167 68/102 [===================>..........] - ETA: 2s - loss: 0.0166 69/102 [===================>..........] - ETA: 2s - loss: 0.0166 70/102 [===================>..........] - ETA: 2s - loss: 0.0165 71/102 [===================>..........] - ETA: 2s - loss: 0.0168 72/102 [====================>.........] - ETA: 2s - loss: 0.0168 73/102 [====================>.........] - ETA: 2s - loss: 0.0168 74/102 [====================>.........] - ETA: 2s - loss: 0.0167 75/102 [=====================>........] - ETA: 2s - loss: 0.0165 76/102 [=====================>........] - ETA: 2s - loss: 0.0164 77/102 [=====================>........] - ETA: 2s - loss: 0.0165 78/102 [=====================>........] - ETA: 2s - loss: 0.0166 79/102 [======================>.......] - ETA: 2s - loss: 0.0166 80/102 [======================>.......] - ETA: 1s - loss: 0.0165 81/102 [======================>.......] - ETA: 1s - loss: 0.0163 82/102 [=======================>......] - ETA: 1s - loss: 0.0163 83/102 [=======================>......] - ETA: 1s - loss: 0.0163 84/102 [=======================>......] - ETA: 1s - loss: 0.0163 85/102 [========================>.....] - ETA: 1s - loss: 0.0164 86/102 [========================>.....] - ETA: 1s - loss: 0.0166 87/102 [========================>.....] - ETA: 1s - loss: 0.0167 88/102 [========================>.....] - ETA: 1s - loss: 0.0166 89/102 [=========================>....] - ETA: 1s - loss: 0.0167 90/102 [=========================>....] - ETA: 1s - loss: 0.0167 91/102 [=========================>....] - ETA: 0s - loss: 0.0166 92/102 [==========================>...] - ETA: 0s - loss: 0.0166 93/102 [==========================>...] - ETA: 0s - loss: 0.0166 94/102 [==========================>...] - ETA: 0s - loss: 0.0166 95/102 [==========================>...] - ETA: 0s - loss: 0.0166 96/102 [===========================>..] - ETA: 0s - loss: 0.0167 97/102 [===========================>..] - ETA: 0s - loss: 0.0168 98/102 [===========================>..] - ETA: 0s - loss: 0.0167 99/102 [============================>.] - ETA: 0s - loss: 0.0166100/102 [============================>.] - ETA: 0s - loss: 0.0165101/102 [============================>.] - ETA: 0s - loss: 0.0164102/102 [==============================] - ETA: 0s - loss: 0.0164102/102 [==============================] - 9s 92ms/step - loss: 0.0164 - val_loss: 0.0085 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.0224 5/16 [========>.....................] - ETA: 0s - loss: 0.0347 9/16 [===============>..............] - ETA: 0s - loss: 0.029913/16 [=======================>......] - ETA: 0s - loss: 0.031416/16 [==============================] - 0s 15ms/step - loss: 0.0337
Test Loss: 0.033669911324977875
Saved model as forecasting_models_v5/model_gru_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for GRU model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 918ms/step
Predicted QoE for the next time step: 79.43264648323971
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/gru_deep.h5
Completed at Τετ 14 Μαΐ 2025 10:13:45 μμ EEST
=====================================================

=====================================================
Training gru model with config: wide
Starting at Τετ 14 Μαΐ 2025 10:13:45 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type gru                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --hidden_units 100 --attention_units 128
2025-05-14 22:13:45.462474: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:13:45.619469: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:13:46.216338: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:13:46.216416: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:13:46.216436: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:13:52.577873: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:13:53.268126: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:13:53.268150: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:13:53.268309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5571 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 5, 96)             41184     
                                                                 
 gru_1 (GRU)                 (None, 5, 96)             55872     
                                                                 
 gru_2 (GRU)                 (None, 5, 96)             55872     
                                                                 
 gru_3 (GRU)                 (None, 5, 96)             55872     
                                                                 
 self_attention (SelfAttenti  (None, 96)               12544     
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                2425      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 223,795
Trainable params: 223,795
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 12:56 - loss: 0.3828  2/102 [..............................] - ETA: 8s - loss: 0.3262     3/102 [..............................] - ETA: 8s - loss: 0.3012  4/102 [>.............................] - ETA: 8s - loss: 0.2722  5/102 [>.............................] - ETA: 8s - loss: 0.2417  6/102 [>.............................] - ETA: 8s - loss: 0.2160  7/102 [=>............................] - ETA: 7s - loss: 0.1912  8/102 [=>............................] - ETA: 7s - loss: 0.1712  9/102 [=>............................] - ETA: 7s - loss: 0.1623 10/102 [=>............................] - ETA: 7s - loss: 0.1590 11/102 [==>...........................] - ETA: 7s - loss: 0.1517 12/102 [==>...........................] - ETA: 7s - loss: 0.1409 13/102 [==>...........................] - ETA: 7s - loss: 0.1336 14/102 [===>..........................] - ETA: 7s - loss: 0.1276 15/102 [===>..........................] - ETA: 7s - loss: 0.1219 16/102 [===>..........................] - ETA: 7s - loss: 0.1182 17/102 [====>.........................] - ETA: 7s - loss: 0.1145 18/102 [====>.........................] - ETA: 7s - loss: 0.1108 19/102 [====>.........................] - ETA: 7s - loss: 0.1072 20/102 [====>.........................] - ETA: 7s - loss: 0.1045 21/102 [=====>........................] - ETA: 6s - loss: 0.1013 22/102 [=====>........................] - ETA: 6s - loss: 0.0987 23/102 [=====>........................] - ETA: 6s - loss: 0.0954 24/102 [======>.......................] - ETA: 6s - loss: 0.0926 25/102 [======>.......................] - ETA: 6s - loss: 0.0897 26/102 [======>.......................] - ETA: 6s - loss: 0.0868 27/102 [======>.......................] - ETA: 6s - loss: 0.0850 28/102 [=======>......................] - ETA: 6s - loss: 0.0838 29/102 [=======>......................] - ETA: 6s - loss: 0.0816 30/102 [=======>......................] - ETA: 6s - loss: 0.0801 31/102 [========>.....................] - ETA: 6s - loss: 0.0784 32/102 [========>.....................] - ETA: 6s - loss: 0.0768 33/102 [========>.....................] - ETA: 6s - loss: 0.0747 34/102 [=========>....................] - ETA: 5s - loss: 0.0734 35/102 [=========>....................] - ETA: 5s - loss: 0.0720 36/102 [=========>....................] - ETA: 5s - loss: 0.0706 37/102 [=========>....................] - ETA: 5s - loss: 0.0696 38/102 [==========>...................] - ETA: 5s - loss: 0.0688 39/102 [==========>...................] - ETA: 5s - loss: 0.0678 40/102 [==========>...................] - ETA: 5s - loss: 0.0666 41/102 [===========>..................] - ETA: 5s - loss: 0.0654 42/102 [===========>..................] - ETA: 5s - loss: 0.0641 43/102 [===========>..................] - ETA: 5s - loss: 0.0633 44/102 [===========>..................] - ETA: 5s - loss: 0.0625 45/102 [============>.................] - ETA: 5s - loss: 0.0613 46/102 [============>.................] - ETA: 4s - loss: 0.0602 47/102 [============>.................] - ETA: 4s - loss: 0.0607 48/102 [=============>................] - ETA: 4s - loss: 0.0601 49/102 [=============>................] - ETA: 4s - loss: 0.0593 50/102 [=============>................] - ETA: 4s - loss: 0.0589 51/102 [==============>...............] - ETA: 4s - loss: 0.0580 52/102 [==============>...............] - ETA: 4s - loss: 0.0573 53/102 [==============>...............] - ETA: 4s - loss: 0.0566 54/102 [==============>...............] - ETA: 4s - loss: 0.0558 55/102 [===============>..............] - ETA: 4s - loss: 0.0551 56/102 [===============>..............] - ETA: 4s - loss: 0.0543 57/102 [===============>..............] - ETA: 3s - loss: 0.0537 58/102 [================>.............] - ETA: 3s - loss: 0.0531 59/102 [================>.............] - ETA: 3s - loss: 0.0525 60/102 [================>.............] - ETA: 3s - loss: 0.0519 61/102 [================>.............] - ETA: 3s - loss: 0.0514 62/102 [=================>............] - ETA: 3s - loss: 0.0509 63/102 [=================>............] - ETA: 3s - loss: 0.0506 64/102 [=================>............] - ETA: 3s - loss: 0.0499 65/102 [==================>...........] - ETA: 3s - loss: 0.0494 66/102 [==================>...........] - ETA: 3s - loss: 0.0491 67/102 [==================>...........] - ETA: 3s - loss: 0.0490 68/102 [===================>..........] - ETA: 3s - loss: 0.0488 69/102 [===================>..........] - ETA: 2s - loss: 0.0483 70/102 [===================>..........] - ETA: 2s - loss: 0.0480 71/102 [===================>..........] - ETA: 2s - loss: 0.0477 72/102 [====================>.........] - ETA: 2s - loss: 0.0472 73/102 [====================>.........] - ETA: 2s - loss: 0.0472 74/102 [====================>.........] - ETA: 2s - loss: 0.0469 75/102 [=====================>........] - ETA: 2s - loss: 0.0467 76/102 [=====================>........] - ETA: 2s - loss: 0.0464 77/102 [=====================>........] - ETA: 2s - loss: 0.0460 78/102 [=====================>........] - ETA: 2s - loss: 0.0459 79/102 [======================>.......] - ETA: 2s - loss: 0.0454 80/102 [======================>.......] - ETA: 1s - loss: 0.0451 81/102 [======================>.......] - ETA: 1s - loss: 0.0447 82/102 [=======================>......] - ETA: 1s - loss: 0.0443 83/102 [=======================>......] - ETA: 1s - loss: 0.0442 84/102 [=======================>......] - ETA: 1s - loss: 0.0443 85/102 [========================>.....] - ETA: 1s - loss: 0.0439 86/102 [========================>.....] - ETA: 1s - loss: 0.0437 87/102 [========================>.....] - ETA: 1s - loss: 0.0435 88/102 [========================>.....] - ETA: 1s - loss: 0.0434 89/102 [=========================>....] - ETA: 1s - loss: 0.0430 90/102 [=========================>....] - ETA: 1s - loss: 0.0426 91/102 [=========================>....] - ETA: 0s - loss: 0.0423 92/102 [==========================>...] - ETA: 0s - loss: 0.0419 93/102 [==========================>...] - ETA: 0s - loss: 0.0419 94/102 [==========================>...] - ETA: 0s - loss: 0.0417 95/102 [==========================>...] - ETA: 0s - loss: 0.0415 96/102 [===========================>..] - ETA: 0s - loss: 0.0412 97/102 [===========================>..] - ETA: 0s - loss: 0.0411 98/102 [===========================>..] - ETA: 0s - loss: 0.0409 99/102 [============================>.] - ETA: 0s - loss: 0.0407100/102 [============================>.] - ETA: 0s - loss: 0.0405101/102 [============================>.] - ETA: 0s - loss: 0.0403102/102 [==============================] - ETA: 0s - loss: 0.0402102/102 [==============================] - 18s 104ms/step - loss: 0.0402 - val_loss: 0.0091 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 9s - loss: 0.0212  2/102 [..............................] - ETA: 9s - loss: 0.0166  3/102 [..............................] - ETA: 8s - loss: 0.0152  4/102 [>.............................] - ETA: 8s - loss: 0.0156  5/102 [>.............................] - ETA: 8s - loss: 0.0153  6/102 [>.............................] - ETA: 8s - loss: 0.0162  7/102 [=>............................] - ETA: 8s - loss: 0.0203  8/102 [=>............................] - ETA: 8s - loss: 0.0216  9/102 [=>............................] - ETA: 8s - loss: 0.0207 10/102 [=>............................] - ETA: 8s - loss: 0.0229 11/102 [==>...........................] - ETA: 7s - loss: 0.0217 12/102 [==>...........................] - ETA: 7s - loss: 0.0221 13/102 [==>...........................] - ETA: 7s - loss: 0.0222 14/102 [===>..........................] - ETA: 7s - loss: 0.0220 15/102 [===>..........................] - ETA: 7s - loss: 0.0221 16/102 [===>..........................] - ETA: 7s - loss: 0.0213 17/102 [====>.........................] - ETA: 7s - loss: 0.0211 18/102 [====>.........................] - ETA: 7s - loss: 0.0205 19/102 [====>.........................] - ETA: 7s - loss: 0.0206 20/102 [====>.........................] - ETA: 7s - loss: 0.0199 21/102 [=====>........................] - ETA: 7s - loss: 0.0204 22/102 [=====>........................] - ETA: 7s - loss: 0.0205 23/102 [=====>........................] - ETA: 7s - loss: 0.0203 24/102 [======>.......................] - ETA: 6s - loss: 0.0199 25/102 [======>.......................] - ETA: 6s - loss: 0.0200 26/102 [======>.......................] - ETA: 6s - loss: 0.0196 27/102 [======>.......................] - ETA: 6s - loss: 0.0193 28/102 [=======>......................] - ETA: 6s - loss: 0.0189 29/102 [=======>......................] - ETA: 6s - loss: 0.0187 30/102 [=======>......................] - ETA: 6s - loss: 0.0188 31/102 [========>.....................] - ETA: 6s - loss: 0.0190 32/102 [========>.....................] - ETA: 6s - loss: 0.0187 33/102 [========>.....................] - ETA: 6s - loss: 0.0185 34/102 [=========>....................] - ETA: 6s - loss: 0.0191 35/102 [=========>....................] - ETA: 5s - loss: 0.0193 36/102 [=========>....................] - ETA: 5s - loss: 0.0193 37/102 [=========>....................] - ETA: 5s - loss: 0.0192 38/102 [==========>...................] - ETA: 5s - loss: 0.0191 39/102 [==========>...................] - ETA: 5s - loss: 0.0189 40/102 [==========>...................] - ETA: 5s - loss: 0.0188 41/102 [===========>..................] - ETA: 5s - loss: 0.0187 42/102 [===========>..................] - ETA: 5s - loss: 0.0197 43/102 [===========>..................] - ETA: 5s - loss: 0.0199 44/102 [===========>..................] - ETA: 5s - loss: 0.0200 45/102 [============>.................] - ETA: 5s - loss: 0.0198 46/102 [============>.................] - ETA: 4s - loss: 0.0198 47/102 [============>.................] - ETA: 4s - loss: 0.0196 48/102 [=============>................] - ETA: 4s - loss: 0.0196 49/102 [=============>................] - ETA: 4s - loss: 0.0197 50/102 [=============>................] - ETA: 4s - loss: 0.0194 51/102 [==============>...............] - ETA: 4s - loss: 0.0194 52/102 [==============>...............] - ETA: 4s - loss: 0.0192 53/102 [==============>...............] - ETA: 4s - loss: 0.0197 54/102 [==============>...............] - ETA: 4s - loss: 0.0201 55/102 [===============>..............] - ETA: 4s - loss: 0.0203 56/102 [===============>..............] - ETA: 4s - loss: 0.0208 57/102 [===============>..............] - ETA: 4s - loss: 0.0207 58/102 [================>.............] - ETA: 3s - loss: 0.0207 59/102 [================>.............] - ETA: 3s - loss: 0.0207 60/102 [================>.............] - ETA: 3s - loss: 0.0207 61/102 [================>.............] - ETA: 3s - loss: 0.0207 62/102 [=================>............] - ETA: 3s - loss: 0.0205 63/102 [=================>............] - ETA: 3s - loss: 0.0206 64/102 [=================>............] - ETA: 3s - loss: 0.0204 65/102 [==================>...........] - ETA: 3s - loss: 0.0203 66/102 [==================>...........] - ETA: 3s - loss: 0.0201 67/102 [==================>...........] - ETA: 3s - loss: 0.0201 68/102 [===================>..........] - ETA: 3s - loss: 0.0201 69/102 [===================>..........] - ETA: 2s - loss: 0.0199 70/102 [===================>..........] - ETA: 2s - loss: 0.0197 71/102 [===================>..........] - ETA: 2s - loss: 0.0197 72/102 [====================>.........] - ETA: 2s - loss: 0.0200 73/102 [====================>.........] - ETA: 2s - loss: 0.0199 74/102 [====================>.........] - ETA: 2s - loss: 0.0198 75/102 [=====================>........] - ETA: 2s - loss: 0.0197 76/102 [=====================>........] - ETA: 2s - loss: 0.0198 77/102 [=====================>........] - ETA: 2s - loss: 0.0197 78/102 [=====================>........] - ETA: 2s - loss: 0.0197 79/102 [======================>.......] - ETA: 2s - loss: 0.0196 80/102 [======================>.......] - ETA: 1s - loss: 0.0197 81/102 [======================>.......] - ETA: 1s - loss: 0.0197 82/102 [=======================>......] - ETA: 1s - loss: 0.0197 83/102 [=======================>......] - ETA: 1s - loss: 0.0198 84/102 [=======================>......] - ETA: 1s - loss: 0.0197 85/102 [========================>.....] - ETA: 1s - loss: 0.0196 86/102 [========================>.....] - ETA: 1s - loss: 0.0198 87/102 [========================>.....] - ETA: 1s - loss: 0.0198 88/102 [========================>.....] - ETA: 1s - loss: 0.0200 89/102 [=========================>....] - ETA: 1s - loss: 0.0200 90/102 [=========================>....] - ETA: 1s - loss: 0.0199 91/102 [=========================>....] - ETA: 0s - loss: 0.0199 92/102 [==========================>...] - ETA: 0s - loss: 0.0200 93/102 [==========================>...] - ETA: 0s - loss: 0.0199 94/102 [==========================>...] - ETA: 0s - loss: 0.0198 95/102 [==========================>...] - ETA: 0s - loss: 0.0198 96/102 [===========================>..] - ETA: 0s - loss: 0.0198 97/102 [===========================>..] - ETA: 0s - loss: 0.0199 98/102 [===========================>..] - ETA: 0s - loss: 0.0198 99/102 [============================>.] - ETA: 0s - loss: 0.0198100/102 [============================>.] - ETA: 0s - loss: 0.0198101/102 [============================>.] - ETA: 0s - loss: 0.0197102/102 [==============================] - ETA: 0s - loss: 0.0197102/102 [==============================] - 10s 94ms/step - loss: 0.0197 - val_loss: 0.0086 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 9s - loss: 0.0159  2/102 [..............................] - ETA: 9s - loss: 0.0174  3/102 [..............................] - ETA: 9s - loss: 0.0156  4/102 [>.............................] - ETA: 9s - loss: 0.0159  5/102 [>.............................] - ETA: 8s - loss: 0.0151  6/102 [>.............................] - ETA: 8s - loss: 0.0143  7/102 [=>............................] - ETA: 8s - loss: 0.0138  8/102 [=>............................] - ETA: 8s - loss: 0.0125  9/102 [=>............................] - ETA: 8s - loss: 0.0123 10/102 [=>............................] - ETA: 8s - loss: 0.0121 11/102 [==>...........................] - ETA: 8s - loss: 0.0127 12/102 [==>...........................] - ETA: 8s - loss: 0.0126 13/102 [==>...........................] - ETA: 7s - loss: 0.0159 14/102 [===>..........................] - ETA: 7s - loss: 0.0159 15/102 [===>..........................] - ETA: 7s - loss: 0.0158 16/102 [===>..........................] - ETA: 7s - loss: 0.0167 17/102 [====>.........................] - ETA: 7s - loss: 0.0165 18/102 [====>.........................] - ETA: 7s - loss: 0.0171 19/102 [====>.........................] - ETA: 7s - loss: 0.0174 20/102 [====>.........................] - ETA: 7s - loss: 0.0174 21/102 [=====>........................] - ETA: 7s - loss: 0.0174 22/102 [=====>........................] - ETA: 7s - loss: 0.0180 23/102 [=====>........................] - ETA: 7s - loss: 0.0183 24/102 [======>.......................] - ETA: 7s - loss: 0.0190 25/102 [======>.......................] - ETA: 6s - loss: 0.0188 26/102 [======>.......................] - ETA: 6s - loss: 0.0187 27/102 [======>.......................] - ETA: 6s - loss: 0.0191 28/102 [=======>......................] - ETA: 6s - loss: 0.0187 29/102 [=======>......................] - ETA: 6s - loss: 0.0187 30/102 [=======>......................] - ETA: 6s - loss: 0.0190 31/102 [========>.....................] - ETA: 6s - loss: 0.0186 32/102 [========>.....................] - ETA: 6s - loss: 0.0182 33/102 [========>.....................] - ETA: 6s - loss: 0.0179 34/102 [=========>....................] - ETA: 6s - loss: 0.0178 35/102 [=========>....................] - ETA: 6s - loss: 0.0178 36/102 [=========>....................] - ETA: 5s - loss: 0.0175 37/102 [=========>....................] - ETA: 5s - loss: 0.0178 38/102 [==========>...................] - ETA: 5s - loss: 0.0177 39/102 [==========>...................] - ETA: 5s - loss: 0.0175 40/102 [==========>...................] - ETA: 5s - loss: 0.0174 41/102 [===========>..................] - ETA: 5s - loss: 0.0176 42/102 [===========>..................] - ETA: 5s - loss: 0.0176 43/102 [===========>..................] - ETA: 5s - loss: 0.0179 44/102 [===========>..................] - ETA: 5s - loss: 0.0179 45/102 [============>.................] - ETA: 5s - loss: 0.0178 46/102 [============>.................] - ETA: 5s - loss: 0.0178 47/102 [============>.................] - ETA: 4s - loss: 0.0181 48/102 [=============>................] - ETA: 4s - loss: 0.0183 49/102 [=============>................] - ETA: 4s - loss: 0.0182 50/102 [=============>................] - ETA: 4s - loss: 0.0185 51/102 [==============>...............] - ETA: 4s - loss: 0.0186 52/102 [==============>...............] - ETA: 4s - loss: 0.0185 53/102 [==============>...............] - ETA: 4s - loss: 0.0184 54/102 [==============>...............] - ETA: 4s - loss: 0.0183 55/102 [===============>..............] - ETA: 4s - loss: 0.0182 56/102 [===============>..............] - ETA: 4s - loss: 0.0184 57/102 [===============>..............] - ETA: 4s - loss: 0.0185 58/102 [================>.............] - ETA: 4s - loss: 0.0182 59/102 [================>.............] - ETA: 3s - loss: 0.0190 60/102 [================>.............] - ETA: 3s - loss: 0.0188 61/102 [================>.............] - ETA: 3s - loss: 0.0190 62/102 [=================>............] - ETA: 3s - loss: 0.0190 63/102 [=================>............] - ETA: 3s - loss: 0.0190 64/102 [=================>............] - ETA: 3s - loss: 0.0192 65/102 [==================>...........] - ETA: 3s - loss: 0.0191 66/102 [==================>...........] - ETA: 3s - loss: 0.0189 67/102 [==================>...........] - ETA: 3s - loss: 0.0189 68/102 [===================>..........] - ETA: 3s - loss: 0.0190 69/102 [===================>..........] - ETA: 3s - loss: 0.0189 70/102 [===================>..........] - ETA: 2s - loss: 0.0188 71/102 [===================>..........] - ETA: 2s - loss: 0.0188 72/102 [====================>.........] - ETA: 2s - loss: 0.0190 73/102 [====================>.........] - ETA: 2s - loss: 0.0188 74/102 [====================>.........] - ETA: 2s - loss: 0.0189 75/102 [=====================>........] - ETA: 2s - loss: 0.0192 76/102 [=====================>........] - ETA: 2s - loss: 0.0193 77/102 [=====================>........] - ETA: 2s - loss: 0.0193 78/102 [=====================>........] - ETA: 2s - loss: 0.0193 79/102 [======================>.......] - ETA: 2s - loss: 0.0191 80/102 [======================>.......] - ETA: 1s - loss: 0.0192 81/102 [======================>.......] - ETA: 1s - loss: 0.0193 82/102 [=======================>......] - ETA: 1s - loss: 0.0193 83/102 [=======================>......] - ETA: 1s - loss: 0.0192 84/102 [=======================>......] - ETA: 1s - loss: 0.0191 85/102 [========================>.....] - ETA: 1s - loss: 0.0191 86/102 [========================>.....] - ETA: 1s - loss: 0.0190 87/102 [========================>.....] - ETA: 1s - loss: 0.0189 88/102 [========================>.....] - ETA: 1s - loss: 0.0191 89/102 [=========================>....] - ETA: 1s - loss: 0.0190 90/102 [=========================>....] - ETA: 1s - loss: 0.0193 91/102 [=========================>....] - ETA: 0s - loss: 0.0194 92/102 [==========================>...] - ETA: 0s - loss: 0.0193 93/102 [==========================>...] - ETA: 0s - loss: 0.0193 94/102 [==========================>...] - ETA: 0s - loss: 0.0192 95/102 [==========================>...] - ETA: 0s - loss: 0.0192 96/102 [===========================>..] - ETA: 0s - loss: 0.0191 97/102 [===========================>..] - ETA: 0s - loss: 0.0191 98/102 [===========================>..] - ETA: 0s - loss: 0.0191 99/102 [============================>.] - ETA: 0s - loss: 0.0192100/102 [============================>.] - ETA: 0s - loss: 0.0191101/102 [============================>.] - ETA: 0s - loss: 0.0191102/102 [==============================] - ETA: 0s - loss: 0.0191102/102 [==============================] - 10s 95ms/step - loss: 0.0191 - val_loss: 0.0091 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 10s - loss: 0.0135  2/102 [..............................] - ETA: 8s - loss: 0.0172   3/102 [..............................] - ETA: 8s - loss: 0.0178  4/102 [>.............................] - ETA: 9s - loss: 0.0170  5/102 [>.............................] - ETA: 8s - loss: 0.0201  6/102 [>.............................] - ETA: 8s - loss: 0.0182  7/102 [=>............................] - ETA: 8s - loss: 0.0175  8/102 [=>............................] - ETA: 8s - loss: 0.0171  9/102 [=>............................] - ETA: 8s - loss: 0.0182 10/102 [=>............................] - ETA: 8s - loss: 0.0191 11/102 [==>...........................] - ETA: 8s - loss: 0.0194 12/102 [==>...........................] - ETA: 8s - loss: 0.0197 13/102 [==>...........................] - ETA: 7s - loss: 0.0194 14/102 [===>..........................] - ETA: 7s - loss: 0.0198 15/102 [===>..........................] - ETA: 7s - loss: 0.0193 16/102 [===>..........................] - ETA: 7s - loss: 0.0193 17/102 [====>.........................] - ETA: 7s - loss: 0.0200 18/102 [====>.........................] - ETA: 7s - loss: 0.0194 19/102 [====>.........................] - ETA: 7s - loss: 0.0191 20/102 [====>.........................] - ETA: 7s - loss: 0.0186 21/102 [=====>........................] - ETA: 7s - loss: 0.0194 22/102 [=====>........................] - ETA: 7s - loss: 0.0193 23/102 [=====>........................] - ETA: 7s - loss: 0.0189 24/102 [======>.......................] - ETA: 7s - loss: 0.0199 25/102 [======>.......................] - ETA: 6s - loss: 0.0198 26/102 [======>.......................] - ETA: 6s - loss: 0.0204 27/102 [======>.......................] - ETA: 6s - loss: 0.0203 28/102 [=======>......................] - ETA: 6s - loss: 0.0202 29/102 [=======>......................] - ETA: 6s - loss: 0.0203 30/102 [=======>......................] - ETA: 6s - loss: 0.0201 31/102 [========>.....................] - ETA: 6s - loss: 0.0198 32/102 [========>.....................] - ETA: 6s - loss: 0.0198 33/102 [========>.....................] - ETA: 6s - loss: 0.0201 34/102 [=========>....................] - ETA: 6s - loss: 0.0199 35/102 [=========>....................] - ETA: 6s - loss: 0.0195 36/102 [=========>....................] - ETA: 5s - loss: 0.0194 37/102 [=========>....................] - ETA: 5s - loss: 0.0192 38/102 [==========>...................] - ETA: 5s - loss: 0.0191 39/102 [==========>...................] - ETA: 5s - loss: 0.0188 40/102 [==========>...................] - ETA: 5s - loss: 0.0188 41/102 [===========>..................] - ETA: 5s - loss: 0.0187 42/102 [===========>..................] - ETA: 5s - loss: 0.0188 43/102 [===========>..................] - ETA: 5s - loss: 0.0189 44/102 [===========>..................] - ETA: 5s - loss: 0.0192 45/102 [============>.................] - ETA: 5s - loss: 0.0195 46/102 [============>.................] - ETA: 5s - loss: 0.0196 47/102 [============>.................] - ETA: 4s - loss: 0.0194 48/102 [=============>................] - ETA: 4s - loss: 0.0192 49/102 [=============>................] - ETA: 4s - loss: 0.0191 50/102 [=============>................] - ETA: 4s - loss: 0.0192 51/102 [==============>...............] - ETA: 4s - loss: 0.0192 52/102 [==============>...............] - ETA: 4s - loss: 0.0190 53/102 [==============>...............] - ETA: 4s - loss: 0.0191 54/102 [==============>...............] - ETA: 4s - loss: 0.0190 55/102 [===============>..............] - ETA: 4s - loss: 0.0192 56/102 [===============>..............] - ETA: 4s - loss: 0.0190 57/102 [===============>..............] - ETA: 4s - loss: 0.0188 58/102 [================>.............] - ETA: 3s - loss: 0.0192 59/102 [================>.............] - ETA: 3s - loss: 0.0189 60/102 [================>.............] - ETA: 3s - loss: 0.0187 61/102 [================>.............] - ETA: 3s - loss: 0.0187 62/102 [=================>............] - ETA: 3s - loss: 0.0187 63/102 [=================>............] - ETA: 3s - loss: 0.0187 64/102 [=================>............] - ETA: 3s - loss: 0.0185 65/102 [==================>...........] - ETA: 3s - loss: 0.0185 66/102 [==================>...........] - ETA: 3s - loss: 0.0185 67/102 [==================>...........] - ETA: 3s - loss: 0.0184 68/102 [===================>..........] - ETA: 3s - loss: 0.0184 69/102 [===================>..........] - ETA: 2s - loss: 0.0182 70/102 [===================>..........] - ETA: 2s - loss: 0.0183 71/102 [===================>..........] - ETA: 2s - loss: 0.0184 72/102 [====================>.........] - ETA: 2s - loss: 0.0182 73/102 [====================>.........] - ETA: 2s - loss: 0.0182 74/102 [====================>.........] - ETA: 2s - loss: 0.0180 75/102 [=====================>........] - ETA: 2s - loss: 0.0180 76/102 [=====================>........] - ETA: 2s - loss: 0.0184 77/102 [=====================>........] - ETA: 2s - loss: 0.0183 78/102 [=====================>........] - ETA: 2s - loss: 0.0181 79/102 [======================>.......] - ETA: 2s - loss: 0.0180 80/102 [======================>.......] - ETA: 1s - loss: 0.0180 81/102 [======================>.......] - ETA: 1s - loss: 0.0181 82/102 [=======================>......] - ETA: 1s - loss: 0.0182 83/102 [=======================>......] - ETA: 1s - loss: 0.0183 84/102 [=======================>......] - ETA: 1s - loss: 0.0182 85/102 [========================>.....] - ETA: 1s - loss: 0.0182 86/102 [========================>.....] - ETA: 1s - loss: 0.0182 87/102 [========================>.....] - ETA: 1s - loss: 0.0181 88/102 [========================>.....] - ETA: 1s - loss: 0.0183 89/102 [=========================>....] - ETA: 1s - loss: 0.0183 90/102 [=========================>....] - ETA: 1s - loss: 0.0182 91/102 [=========================>....] - ETA: 0s - loss: 0.0181 92/102 [==========================>...] - ETA: 0s - loss: 0.0180 93/102 [==========================>...] - ETA: 0s - loss: 0.0179 94/102 [==========================>...] - ETA: 0s - loss: 0.0184 95/102 [==========================>...] - ETA: 0s - loss: 0.0183 96/102 [===========================>..] - ETA: 0s - loss: 0.0182 97/102 [===========================>..] - ETA: 0s - loss: 0.0181 98/102 [===========================>..] - ETA: 0s - loss: 0.0180 99/102 [============================>.] - ETA: 0s - loss: 0.0179100/102 [============================>.] - ETA: 0s - loss: 0.0179101/102 [============================>.] - ETA: 0s - loss: 0.0178102/102 [==============================] - ETA: 0s - loss: 0.0178102/102 [==============================] - 10s 95ms/step - loss: 0.0178 - val_loss: 0.0095 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 10s - loss: 0.0290  2/102 [..............................] - ETA: 9s - loss: 0.0185   3/102 [..............................] - ETA: 8s - loss: 0.0150  4/102 [>.............................] - ETA: 8s - loss: 0.0136  5/102 [>.............................] - ETA: 8s - loss: 0.0137  6/102 [>.............................] - ETA: 8s - loss: 0.0151  7/102 [=>............................] - ETA: 8s - loss: 0.0143  8/102 [=>............................] - ETA: 8s - loss: 0.0131  9/102 [=>............................] - ETA: 8s - loss: 0.0143 10/102 [=>............................] - ETA: 8s - loss: 0.0139 11/102 [==>...........................] - ETA: 8s - loss: 0.0140 12/102 [==>...........................] - ETA: 8s - loss: 0.0143 13/102 [==>...........................] - ETA: 8s - loss: 0.0137 14/102 [===>..........................] - ETA: 8s - loss: 0.0135 15/102 [===>..........................] - ETA: 7s - loss: 0.0137 16/102 [===>..........................] - ETA: 7s - loss: 0.0132 17/102 [====>.........................] - ETA: 7s - loss: 0.0130 18/102 [====>.........................] - ETA: 7s - loss: 0.0138 19/102 [====>.........................] - ETA: 7s - loss: 0.0146 20/102 [====>.........................] - ETA: 7s - loss: 0.0142 21/102 [=====>........................] - ETA: 7s - loss: 0.0143 22/102 [=====>........................] - ETA: 7s - loss: 0.0147 23/102 [=====>........................] - ETA: 7s - loss: 0.0153 24/102 [======>.......................] - ETA: 7s - loss: 0.0152 25/102 [======>.......................] - ETA: 6s - loss: 0.0150 26/102 [======>.......................] - ETA: 6s - loss: 0.0148 27/102 [======>.......................] - ETA: 6s - loss: 0.0145 28/102 [=======>......................] - ETA: 6s - loss: 0.0147 29/102 [=======>......................] - ETA: 6s - loss: 0.0149 30/102 [=======>......................] - ETA: 6s - loss: 0.0146 31/102 [========>.....................] - ETA: 6s - loss: 0.0153 32/102 [========>.....................] - ETA: 6s - loss: 0.0156 33/102 [========>.....................] - ETA: 6s - loss: 0.0162 34/102 [=========>....................] - ETA: 6s - loss: 0.0170 35/102 [=========>....................] - ETA: 6s - loss: 0.0169 36/102 [=========>....................] - ETA: 5s - loss: 0.0167 37/102 [=========>....................] - ETA: 5s - loss: 0.0167 38/102 [==========>...................] - ETA: 5s - loss: 0.0169 39/102 [==========>...................] - ETA: 5s - loss: 0.0167 40/102 [==========>...................] - ETA: 5s - loss: 0.0168 41/102 [===========>..................] - ETA: 5s - loss: 0.0167 42/102 [===========>..................] - ETA: 5s - loss: 0.0166 43/102 [===========>..................] - ETA: 5s - loss: 0.0164 44/102 [===========>..................] - ETA: 5s - loss: 0.0164 45/102 [============>.................] - ETA: 5s - loss: 0.0162 46/102 [============>.................] - ETA: 5s - loss: 0.0162 47/102 [============>.................] - ETA: 4s - loss: 0.0163 48/102 [=============>................] - ETA: 4s - loss: 0.0161 49/102 [=============>................] - ETA: 4s - loss: 0.0161 50/102 [=============>................] - ETA: 4s - loss: 0.0162 51/102 [==============>...............] - ETA: 4s - loss: 0.0161 52/102 [==============>...............] - ETA: 4s - loss: 0.0164 53/102 [==============>...............] - ETA: 4s - loss: 0.0165 54/102 [==============>...............] - ETA: 4s - loss: 0.0165 55/102 [===============>..............] - ETA: 4s - loss: 0.0165 56/102 [===============>..............] - ETA: 4s - loss: 0.0167 57/102 [===============>..............] - ETA: 4s - loss: 0.0167 58/102 [================>.............] - ETA: 3s - loss: 0.0167 59/102 [================>.............] - ETA: 3s - loss: 0.0169 60/102 [================>.............] - ETA: 3s - loss: 0.0168 61/102 [================>.............] - ETA: 3s - loss: 0.0167 62/102 [=================>............] - ETA: 3s - loss: 0.0167 63/102 [=================>............] - ETA: 3s - loss: 0.0166 64/102 [=================>............] - ETA: 3s - loss: 0.0165 65/102 [==================>...........] - ETA: 3s - loss: 0.0164 66/102 [==================>...........] - ETA: 3s - loss: 0.0163 67/102 [==================>...........] - ETA: 3s - loss: 0.0162 68/102 [===================>..........] - ETA: 3s - loss: 0.0162 69/102 [===================>..........] - ETA: 2s - loss: 0.0164 70/102 [===================>..........] - ETA: 2s - loss: 0.0164 71/102 [===================>..........] - ETA: 2s - loss: 0.0163 72/102 [====================>.........] - ETA: 2s - loss: 0.0166 73/102 [====================>.........] - ETA: 2s - loss: 0.0165 74/102 [====================>.........] - ETA: 2s - loss: 0.0165 75/102 [=====================>........] - ETA: 2s - loss: 0.0167 76/102 [=====================>........] - ETA: 2s - loss: 0.0166 77/102 [=====================>........] - ETA: 2s - loss: 0.0165 78/102 [=====================>........] - ETA: 2s - loss: 0.0164 79/102 [======================>.......] - ETA: 2s - loss: 0.0165 80/102 [======================>.......] - ETA: 1s - loss: 0.0164 81/102 [======================>.......] - ETA: 1s - loss: 0.0167 82/102 [=======================>......] - ETA: 1s - loss: 0.0167 83/102 [=======================>......] - ETA: 1s - loss: 0.0168 84/102 [=======================>......] - ETA: 1s - loss: 0.0169 85/102 [========================>.....] - ETA: 1s - loss: 0.0168 86/102 [========================>.....] - ETA: 1s - loss: 0.0167 87/102 [========================>.....] - ETA: 1s - loss: 0.0167 88/102 [========================>.....] - ETA: 1s - loss: 0.0166 89/102 [=========================>....] - ETA: 1s - loss: 0.0165 90/102 [=========================>....] - ETA: 1s - loss: 0.0165 91/102 [=========================>....] - ETA: 0s - loss: 0.0164 92/102 [==========================>...] - ETA: 0s - loss: 0.0164 93/102 [==========================>...] - ETA: 0s - loss: 0.0165 94/102 [==========================>...] - ETA: 0s - loss: 0.0166 95/102 [==========================>...] - ETA: 0s - loss: 0.0166 96/102 [===========================>..] - ETA: 0s - loss: 0.0166 97/102 [===========================>..] - ETA: 0s - loss: 0.0167 98/102 [===========================>..] - ETA: 0s - loss: 0.0166 99/102 [============================>.] - ETA: 0s - loss: 0.0166100/102 [============================>.] - ETA: 0s - loss: 0.0166101/102 [============================>.] - ETA: 0s - loss: 0.0166102/102 [==============================] - ETA: 0s - loss: 0.0166102/102 [==============================] - 10s 94ms/step - loss: 0.0166 - val_loss: 0.0093 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.0203 5/16 [========>.....................] - ETA: 0s - loss: 0.0328 9/16 [===============>..............] - ETA: 0s - loss: 0.028612/16 [=====================>........] - ETA: 0s - loss: 0.029116/16 [==============================] - ETA: 0s - loss: 0.032716/16 [==============================] - 0s 16ms/step - loss: 0.0327
Test Loss: 0.032711781561374664
Saved model as forecasting_models_v5/model_gru_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for GRU model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 936ms/step
Predicted QoE for the next time step: 79.21117634295416
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/gru_wide.h5
Completed at Τετ 14 Μαΐ 2025 10:14:55 μμ EEST
=====================================================

=====================================================
Training gru model with config: bidirectional
Starting at Τετ 14 Μαΐ 2025 10:14:55 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type gru                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --bidirectional --attention_units 128
2025-05-14 22:14:55.395292: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:14:55.538566: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:14:56.133614: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:14:56.133705: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:14:56.133714: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:15:02.546085: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:15:03.206849: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:15:03.206884: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:15:03.207000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5563 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Traceback (most recent call last):
  File "timeseries_forecasting_models_v5.py", line 889, in <module>
    main()
  File "timeseries_forecasting_models_v5.py", line 672, in main
    model.summary()
  File "/home/dimitris/.local/lib/python3.8/site-packages/keras/engine/training.py", line 3214, in summary
    raise ValueError(
ValueError: This model has not yet been built. Build the model first by calling `build()` or by calling the model on a batch of data.
Warning: Original model file not found at /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/model_gru_with_attention.h5
Directory contents:
total 23844
drwxrwxr-x  2 dimitris dimitris    4096 Μαΐ  14 22:14 .
drwxrwxr-x 25 dimitris dimitris    4096 Μαΐ  14 22:00 ..
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  14 22:05 dnn_basic.h5
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  14 22:05 dnn_deep.h5
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  14 22:05 dnn_with_elu.h5
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  14 22:06 dnn_with_high_dropout.h5
-rw-rw-r--  1 dimitris dimitris 2768720 Μαΐ  14 22:12 gru_basic.h5
-rw-rw-r--  1 dimitris dimitris 2768720 Μαΐ  14 22:13 gru_deep.h5
-rw-rw-r--  1 dimitris dimitris 2768720 Μαΐ  14 22:14 gru_wide.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  14 22:03 linear_basic.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  14 22:04 linear_with_elastic_net.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  14 22:04 linear_with_l1_reg.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  14 22:04 linear_with_l2_reg.h5
-rw-rw-r--  1 dimitris dimitris 3585456 Μαΐ  14 22:07 lstm_basic.h5
-rw-rw-r--  1 dimitris dimitris 3585456 Μαΐ  14 22:08 lstm_deep.h5
-rw-rw-r--  1 dimitris dimitris 3585456 Μαΐ  14 22:10 lstm_wide.h5
-rw-rw-r--  1 dimitris dimitris 3585456 Μαΐ  14 22:11 lstm_with_stats.h5
-rw-rw-r--  1 dimitris dimitris    3463 Μαΐ  14 22:14 scaler.save
-rw-rw-r--  1 dimitris dimitris  688556 Μαΐ  14 22:15 training_log.txt
Completed at Τετ 14 Μαΐ 2025 10:15:05 μμ EEST
=====================================================

=====================================================
Training gru model with config: with_stats
Starting at Τετ 14 Μαΐ 2025 10:15:05 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type gru                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --attention_units 128
2025-05-14 22:15:06.269287: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:15:06.416661: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:15:06.993038: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:15:06.993116: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:15:06.993125: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:15:13.430221: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:15:14.123217: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:15:14.123244: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:15:14.123401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5571 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 5, 96)             41184     
                                                                 
 gru_1 (GRU)                 (None, 5, 96)             55872     
                                                                 
 gru_2 (GRU)                 (None, 5, 96)             55872     
                                                                 
 gru_3 (GRU)                 (None, 5, 96)             55872     
                                                                 
 self_attention (SelfAttenti  (None, 96)               12544     
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                2425      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 223,795
Trainable params: 223,795
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 12:57 - loss: 0.3474  2/102 [..............................] - ETA: 7s - loss: 0.3230     3/102 [..............................] - ETA: 8s - loss: 0.3177  4/102 [>.............................] - ETA: 7s - loss: 0.3036  5/102 [>.............................] - ETA: 7s - loss: 0.2875  6/102 [>.............................] - ETA: 7s - loss: 0.2682  7/102 [=>............................] - ETA: 7s - loss: 0.2434  8/102 [=>............................] - ETA: 7s - loss: 0.2221  9/102 [=>............................] - ETA: 7s - loss: 0.2001 10/102 [=>............................] - ETA: 7s - loss: 0.1932 11/102 [==>...........................] - ETA: 7s - loss: 0.1920 12/102 [==>...........................] - ETA: 7s - loss: 0.1792 13/102 [==>...........................] - ETA: 7s - loss: 0.1684 14/102 [===>..........................] - ETA: 7s - loss: 0.1577 15/102 [===>..........................] - ETA: 7s - loss: 0.1506 16/102 [===>..........................] - ETA: 7s - loss: 0.1440 17/102 [====>.........................] - ETA: 6s - loss: 0.1377 18/102 [====>.........................] - ETA: 6s - loss: 0.1317 19/102 [====>.........................] - ETA: 6s - loss: 0.1274 20/102 [====>.........................] - ETA: 6s - loss: 0.1229 21/102 [=====>........................] - ETA: 6s - loss: 0.1188 22/102 [=====>........................] - ETA: 6s - loss: 0.1148 23/102 [=====>........................] - ETA: 6s - loss: 0.1108 24/102 [======>.......................] - ETA: 6s - loss: 0.1069 25/102 [======>.......................] - ETA: 6s - loss: 0.1045 26/102 [======>.......................] - ETA: 6s - loss: 0.1021 27/102 [======>.......................] - ETA: 6s - loss: 0.0990 28/102 [=======>......................] - ETA: 6s - loss: 0.0970 29/102 [=======>......................] - ETA: 6s - loss: 0.0941 30/102 [=======>......................] - ETA: 6s - loss: 0.0924 31/102 [========>.....................] - ETA: 6s - loss: 0.0899 32/102 [========>.....................] - ETA: 5s - loss: 0.0877 33/102 [========>.....................] - ETA: 5s - loss: 0.0860 34/102 [=========>....................] - ETA: 5s - loss: 0.0844 35/102 [=========>....................] - ETA: 5s - loss: 0.0829 36/102 [=========>....................] - ETA: 5s - loss: 0.0815 37/102 [=========>....................] - ETA: 5s - loss: 0.0805 38/102 [==========>...................] - ETA: 5s - loss: 0.0788 39/102 [==========>...................] - ETA: 5s - loss: 0.0775 40/102 [==========>...................] - ETA: 5s - loss: 0.0759 41/102 [===========>..................] - ETA: 5s - loss: 0.0752 42/102 [===========>..................] - ETA: 5s - loss: 0.0737 43/102 [===========>..................] - ETA: 5s - loss: 0.0724 44/102 [===========>..................] - ETA: 4s - loss: 0.0715 45/102 [============>.................] - ETA: 4s - loss: 0.0704 46/102 [============>.................] - ETA: 4s - loss: 0.0696 47/102 [============>.................] - ETA: 4s - loss: 0.0688 48/102 [=============>................] - ETA: 4s - loss: 0.0679 49/102 [=============>................] - ETA: 4s - loss: 0.0677 50/102 [=============>................] - ETA: 4s - loss: 0.0670 51/102 [==============>...............] - ETA: 4s - loss: 0.0664 52/102 [==============>...............] - ETA: 4s - loss: 0.0657 53/102 [==============>...............] - ETA: 4s - loss: 0.0651 54/102 [==============>...............] - ETA: 4s - loss: 0.0643 55/102 [===============>..............] - ETA: 4s - loss: 0.0637 56/102 [===============>..............] - ETA: 3s - loss: 0.0629 57/102 [===============>..............] - ETA: 3s - loss: 0.0624 58/102 [================>.............] - ETA: 3s - loss: 0.0616 59/102 [================>.............] - ETA: 3s - loss: 0.0610 60/102 [================>.............] - ETA: 3s - loss: 0.0608 61/102 [================>.............] - ETA: 3s - loss: 0.0600 62/102 [=================>............] - ETA: 3s - loss: 0.0595 63/102 [=================>............] - ETA: 3s - loss: 0.0587 64/102 [=================>............] - ETA: 3s - loss: 0.0589 65/102 [==================>...........] - ETA: 3s - loss: 0.0583 66/102 [==================>...........] - ETA: 3s - loss: 0.0577 67/102 [==================>...........] - ETA: 2s - loss: 0.0571 68/102 [===================>..........] - ETA: 2s - loss: 0.0568 69/102 [===================>..........] - ETA: 2s - loss: 0.0563 70/102 [===================>..........] - ETA: 2s - loss: 0.0558 71/102 [===================>..........] - ETA: 2s - loss: 0.0553 72/102 [====================>.........] - ETA: 2s - loss: 0.0548 73/102 [====================>.........] - ETA: 2s - loss: 0.0543 74/102 [====================>.........] - ETA: 2s - loss: 0.0538 75/102 [=====================>........] - ETA: 2s - loss: 0.0534 76/102 [=====================>........] - ETA: 2s - loss: 0.0528 77/102 [=====================>........] - ETA: 2s - loss: 0.0525 78/102 [=====================>........] - ETA: 2s - loss: 0.0522 79/102 [======================>.......] - ETA: 1s - loss: 0.0516 80/102 [======================>.......] - ETA: 1s - loss: 0.0511 81/102 [======================>.......] - ETA: 1s - loss: 0.0509 82/102 [=======================>......] - ETA: 1s - loss: 0.0505 83/102 [=======================>......] - ETA: 1s - loss: 0.0501 84/102 [=======================>......] - ETA: 1s - loss: 0.0496 85/102 [========================>.....] - ETA: 1s - loss: 0.0493 86/102 [========================>.....] - ETA: 1s - loss: 0.0489 87/102 [========================>.....] - ETA: 1s - loss: 0.0487 88/102 [========================>.....] - ETA: 1s - loss: 0.0483 89/102 [=========================>....] - ETA: 1s - loss: 0.0481 90/102 [=========================>....] - ETA: 1s - loss: 0.0477 91/102 [=========================>....] - ETA: 0s - loss: 0.0475 92/102 [==========================>...] - ETA: 0s - loss: 0.0471 93/102 [==========================>...] - ETA: 0s - loss: 0.0469 94/102 [==========================>...] - ETA: 0s - loss: 0.0467 95/102 [==========================>...] - ETA: 0s - loss: 0.0464 96/102 [===========================>..] - ETA: 0s - loss: 0.0461 97/102 [===========================>..] - ETA: 0s - loss: 0.0457 98/102 [===========================>..] - ETA: 0s - loss: 0.0454 99/102 [============================>.] - ETA: 0s - loss: 0.0452100/102 [============================>.] - ETA: 0s - loss: 0.0450101/102 [============================>.] - ETA: 0s - loss: 0.0448102/102 [==============================] - ETA: 0s - loss: 0.0448102/102 [==============================] - 18s 100ms/step - loss: 0.0448 - val_loss: 0.0077 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 9s - loss: 0.0085  2/102 [..............................] - ETA: 7s - loss: 0.0085  3/102 [..............................] - ETA: 7s - loss: 0.0150  4/102 [>.............................] - ETA: 8s - loss: 0.0189  5/102 [>.............................] - ETA: 8s - loss: 0.0172  6/102 [>.............................] - ETA: 8s - loss: 0.0212  7/102 [=>............................] - ETA: 8s - loss: 0.0210  8/102 [=>............................] - ETA: 8s - loss: 0.0205  9/102 [=>............................] - ETA: 8s - loss: 0.0199 10/102 [=>............................] - ETA: 8s - loss: 0.0191 11/102 [==>...........................] - ETA: 7s - loss: 0.0180 12/102 [==>...........................] - ETA: 7s - loss: 0.0178 13/102 [==>...........................] - ETA: 7s - loss: 0.0175 14/102 [===>..........................] - ETA: 7s - loss: 0.0171 15/102 [===>..........................] - ETA: 7s - loss: 0.0167 16/102 [===>..........................] - ETA: 7s - loss: 0.0167 17/102 [====>.........................] - ETA: 7s - loss: 0.0173 18/102 [====>.........................] - ETA: 7s - loss: 0.0196 19/102 [====>.........................] - ETA: 7s - loss: 0.0202 20/102 [====>.........................] - ETA: 7s - loss: 0.0201 21/102 [=====>........................] - ETA: 7s - loss: 0.0199 22/102 [=====>........................] - ETA: 6s - loss: 0.0202 23/102 [=====>........................] - ETA: 6s - loss: 0.0203 24/102 [======>.......................] - ETA: 6s - loss: 0.0203 25/102 [======>.......................] - ETA: 6s - loss: 0.0200 26/102 [======>.......................] - ETA: 6s - loss: 0.0199 27/102 [======>.......................] - ETA: 6s - loss: 0.0200 28/102 [=======>......................] - ETA: 6s - loss: 0.0196 29/102 [=======>......................] - ETA: 6s - loss: 0.0195 30/102 [=======>......................] - ETA: 6s - loss: 0.0192 31/102 [========>.....................] - ETA: 6s - loss: 0.0193 32/102 [========>.....................] - ETA: 6s - loss: 0.0193 33/102 [========>.....................] - ETA: 5s - loss: 0.0190 34/102 [=========>....................] - ETA: 5s - loss: 0.0195 35/102 [=========>....................] - ETA: 5s - loss: 0.0193 36/102 [=========>....................] - ETA: 5s - loss: 0.0190 37/102 [=========>....................] - ETA: 5s - loss: 0.0189 38/102 [==========>...................] - ETA: 5s - loss: 0.0188 39/102 [==========>...................] - ETA: 5s - loss: 0.0186 40/102 [==========>...................] - ETA: 5s - loss: 0.0187 41/102 [===========>..................] - ETA: 5s - loss: 0.0187 42/102 [===========>..................] - ETA: 5s - loss: 0.0189 43/102 [===========>..................] - ETA: 5s - loss: 0.0187 44/102 [===========>..................] - ETA: 5s - loss: 0.0185 45/102 [============>.................] - ETA: 4s - loss: 0.0188 46/102 [============>.................] - ETA: 4s - loss: 0.0187 47/102 [============>.................] - ETA: 4s - loss: 0.0189 48/102 [=============>................] - ETA: 4s - loss: 0.0188 49/102 [=============>................] - ETA: 4s - loss: 0.0188 50/102 [=============>................] - ETA: 4s - loss: 0.0186 51/102 [==============>...............] - ETA: 4s - loss: 0.0188 52/102 [==============>...............] - ETA: 4s - loss: 0.0191 53/102 [==============>...............] - ETA: 4s - loss: 0.0192 54/102 [==============>...............] - ETA: 4s - loss: 0.0196 55/102 [===============>..............] - ETA: 4s - loss: 0.0199 56/102 [===============>..............] - ETA: 3s - loss: 0.0197 57/102 [===============>..............] - ETA: 3s - loss: 0.0198 58/102 [================>.............] - ETA: 3s - loss: 0.0201 59/102 [================>.............] - ETA: 3s - loss: 0.0199 60/102 [================>.............] - ETA: 3s - loss: 0.0197 61/102 [================>.............] - ETA: 3s - loss: 0.0197 62/102 [=================>............] - ETA: 3s - loss: 0.0197 63/102 [=================>............] - ETA: 3s - loss: 0.0196 64/102 [=================>............] - ETA: 3s - loss: 0.0195 65/102 [==================>...........] - ETA: 3s - loss: 0.0194 66/102 [==================>...........] - ETA: 3s - loss: 0.0193 67/102 [==================>...........] - ETA: 3s - loss: 0.0192 68/102 [===================>..........] - ETA: 2s - loss: 0.0191 69/102 [===================>..........] - ETA: 2s - loss: 0.0194 70/102 [===================>..........] - ETA: 2s - loss: 0.0194 71/102 [===================>..........] - ETA: 2s - loss: 0.0197 72/102 [====================>.........] - ETA: 2s - loss: 0.0196 73/102 [====================>.........] - ETA: 2s - loss: 0.0196 74/102 [====================>.........] - ETA: 2s - loss: 0.0198 75/102 [=====================>........] - ETA: 2s - loss: 0.0198 76/102 [=====================>........] - ETA: 2s - loss: 0.0198 77/102 [=====================>........] - ETA: 2s - loss: 0.0198 78/102 [=====================>........] - ETA: 2s - loss: 0.0199 79/102 [======================>.......] - ETA: 1s - loss: 0.0199 80/102 [======================>.......] - ETA: 1s - loss: 0.0198 81/102 [======================>.......] - ETA: 1s - loss: 0.0196 82/102 [=======================>......] - ETA: 1s - loss: 0.0198 83/102 [=======================>......] - ETA: 1s - loss: 0.0197 84/102 [=======================>......] - ETA: 1s - loss: 0.0197 85/102 [========================>.....] - ETA: 1s - loss: 0.0197 86/102 [========================>.....] - ETA: 1s - loss: 0.0198 87/102 [========================>.....] - ETA: 1s - loss: 0.0198 88/102 [========================>.....] - ETA: 1s - loss: 0.0199 89/102 [=========================>....] - ETA: 1s - loss: 0.0200 90/102 [=========================>....] - ETA: 1s - loss: 0.0200 91/102 [=========================>....] - ETA: 0s - loss: 0.0202 92/102 [==========================>...] - ETA: 0s - loss: 0.0201 93/102 [==========================>...] - ETA: 0s - loss: 0.0202 94/102 [==========================>...] - ETA: 0s - loss: 0.0202 95/102 [==========================>...] - ETA: 0s - loss: 0.0201 96/102 [===========================>..] - ETA: 0s - loss: 0.0201 97/102 [===========================>..] - ETA: 0s - loss: 0.0202 98/102 [===========================>..] - ETA: 0s - loss: 0.0201 99/102 [============================>.] - ETA: 0s - loss: 0.0204100/102 [============================>.] - ETA: 0s - loss: 0.0202101/102 [============================>.] - ETA: 0s - loss: 0.0202102/102 [==============================] - ETA: 0s - loss: 0.0201102/102 [==============================] - 9s 90ms/step - loss: 0.0201 - val_loss: 0.0101 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 9s - loss: 0.0172  2/102 [..............................] - ETA: 8s - loss: 0.0125  3/102 [..............................] - ETA: 8s - loss: 0.0112  4/102 [>.............................] - ETA: 8s - loss: 0.0097  5/102 [>.............................] - ETA: 8s - loss: 0.0114  6/102 [>.............................] - ETA: 8s - loss: 0.0140  7/102 [=>............................] - ETA: 8s - loss: 0.0136  8/102 [=>............................] - ETA: 8s - loss: 0.0143  9/102 [=>............................] - ETA: 8s - loss: 0.0142 10/102 [=>............................] - ETA: 8s - loss: 0.0164 11/102 [==>...........................] - ETA: 7s - loss: 0.0167 12/102 [==>...........................] - ETA: 7s - loss: 0.0186 13/102 [==>...........................] - ETA: 7s - loss: 0.0183 14/102 [===>..........................] - ETA: 7s - loss: 0.0185 15/102 [===>..........................] - ETA: 7s - loss: 0.0184 16/102 [===>..........................] - ETA: 7s - loss: 0.0181 17/102 [====>.........................] - ETA: 7s - loss: 0.0182 18/102 [====>.........................] - ETA: 7s - loss: 0.0180 19/102 [====>.........................] - ETA: 7s - loss: 0.0172 20/102 [====>.........................] - ETA: 7s - loss: 0.0178 21/102 [=====>........................] - ETA: 7s - loss: 0.0177 22/102 [=====>........................] - ETA: 6s - loss: 0.0175 23/102 [=====>........................] - ETA: 6s - loss: 0.0174 24/102 [======>.......................] - ETA: 6s - loss: 0.0171 25/102 [======>.......................] - ETA: 6s - loss: 0.0173 26/102 [======>.......................] - ETA: 6s - loss: 0.0172 27/102 [======>.......................] - ETA: 6s - loss: 0.0176 28/102 [=======>......................] - ETA: 6s - loss: 0.0173 29/102 [=======>......................] - ETA: 6s - loss: 0.0172 30/102 [=======>......................] - ETA: 6s - loss: 0.0178 31/102 [========>.....................] - ETA: 6s - loss: 0.0175 32/102 [========>.....................] - ETA: 6s - loss: 0.0172 33/102 [========>.....................] - ETA: 5s - loss: 0.0170 34/102 [=========>....................] - ETA: 5s - loss: 0.0170 35/102 [=========>....................] - ETA: 5s - loss: 0.0171 36/102 [=========>....................] - ETA: 5s - loss: 0.0171 37/102 [=========>....................] - ETA: 5s - loss: 0.0169 38/102 [==========>...................] - ETA: 5s - loss: 0.0166 39/102 [==========>...................] - ETA: 5s - loss: 0.0168 40/102 [==========>...................] - ETA: 5s - loss: 0.0168 41/102 [===========>..................] - ETA: 5s - loss: 0.0169 42/102 [===========>..................] - ETA: 5s - loss: 0.0169 43/102 [===========>..................] - ETA: 5s - loss: 0.0170 44/102 [===========>..................] - ETA: 5s - loss: 0.0170 45/102 [============>.................] - ETA: 4s - loss: 0.0169 46/102 [============>.................] - ETA: 4s - loss: 0.0170 47/102 [============>.................] - ETA: 4s - loss: 0.0172 48/102 [=============>................] - ETA: 4s - loss: 0.0170 49/102 [=============>................] - ETA: 4s - loss: 0.0169 50/102 [=============>................] - ETA: 4s - loss: 0.0172 51/102 [==============>...............] - ETA: 4s - loss: 0.0171 52/102 [==============>...............] - ETA: 4s - loss: 0.0174 53/102 [==============>...............] - ETA: 4s - loss: 0.0173 54/102 [==============>...............] - ETA: 4s - loss: 0.0173 55/102 [===============>..............] - ETA: 4s - loss: 0.0174 56/102 [===============>..............] - ETA: 3s - loss: 0.0173 57/102 [===============>..............] - ETA: 3s - loss: 0.0173 58/102 [================>.............] - ETA: 3s - loss: 0.0174 59/102 [================>.............] - ETA: 3s - loss: 0.0179 60/102 [================>.............] - ETA: 3s - loss: 0.0182 61/102 [================>.............] - ETA: 3s - loss: 0.0181 62/102 [=================>............] - ETA: 3s - loss: 0.0181 63/102 [=================>............] - ETA: 3s - loss: 0.0184 64/102 [=================>............] - ETA: 3s - loss: 0.0183 65/102 [==================>...........] - ETA: 3s - loss: 0.0183 66/102 [==================>...........] - ETA: 3s - loss: 0.0183 67/102 [==================>...........] - ETA: 3s - loss: 0.0182 68/102 [===================>..........] - ETA: 2s - loss: 0.0180 69/102 [===================>..........] - ETA: 2s - loss: 0.0180 70/102 [===================>..........] - ETA: 2s - loss: 0.0181 71/102 [===================>..........] - ETA: 2s - loss: 0.0181 72/102 [====================>.........] - ETA: 2s - loss: 0.0180 73/102 [====================>.........] - ETA: 2s - loss: 0.0179 74/102 [====================>.........] - ETA: 2s - loss: 0.0179 75/102 [=====================>........] - ETA: 2s - loss: 0.0178 76/102 [=====================>........] - ETA: 2s - loss: 0.0179 77/102 [=====================>........] - ETA: 2s - loss: 0.0179 78/102 [=====================>........] - ETA: 2s - loss: 0.0178 79/102 [======================>.......] - ETA: 1s - loss: 0.0179 80/102 [======================>.......] - ETA: 1s - loss: 0.0180 81/102 [======================>.......] - ETA: 1s - loss: 0.0182 82/102 [=======================>......] - ETA: 1s - loss: 0.0181 83/102 [=======================>......] - ETA: 1s - loss: 0.0179 84/102 [=======================>......] - ETA: 1s - loss: 0.0178 85/102 [========================>.....] - ETA: 1s - loss: 0.0176 86/102 [========================>.....] - ETA: 1s - loss: 0.0179 87/102 [========================>.....] - ETA: 1s - loss: 0.0180 88/102 [========================>.....] - ETA: 1s - loss: 0.0180 89/102 [=========================>....] - ETA: 1s - loss: 0.0180 90/102 [=========================>....] - ETA: 1s - loss: 0.0179 91/102 [=========================>....] - ETA: 0s - loss: 0.0178 92/102 [==========================>...] - ETA: 0s - loss: 0.0183 93/102 [==========================>...] - ETA: 0s - loss: 0.0182 94/102 [==========================>...] - ETA: 0s - loss: 0.0183 95/102 [==========================>...] - ETA: 0s - loss: 0.0182 96/102 [===========================>..] - ETA: 0s - loss: 0.0183 97/102 [===========================>..] - ETA: 0s - loss: 0.0182 98/102 [===========================>..] - ETA: 0s - loss: 0.0182 99/102 [============================>.] - ETA: 0s - loss: 0.0181100/102 [============================>.] - ETA: 0s - loss: 0.0180101/102 [============================>.] - ETA: 0s - loss: 0.0182102/102 [==============================] - ETA: 0s - loss: 0.0181102/102 [==============================] - 9s 90ms/step - loss: 0.0181 - val_loss: 0.0096 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 8s - loss: 0.0183  2/102 [..............................] - ETA: 9s - loss: 0.0185  3/102 [..............................] - ETA: 8s - loss: 0.0151  4/102 [>.............................] - ETA: 8s - loss: 0.0142  5/102 [>.............................] - ETA: 8s - loss: 0.0133  6/102 [>.............................] - ETA: 8s - loss: 0.0141  7/102 [=>............................] - ETA: 7s - loss: 0.0145  8/102 [=>............................] - ETA: 7s - loss: 0.0171  9/102 [=>............................] - ETA: 7s - loss: 0.0174 10/102 [=>............................] - ETA: 7s - loss: 0.0182 11/102 [==>...........................] - ETA: 7s - loss: 0.0184 12/102 [==>...........................] - ETA: 7s - loss: 0.0181 13/102 [==>...........................] - ETA: 7s - loss: 0.0188 14/102 [===>..........................] - ETA: 7s - loss: 0.0197 15/102 [===>..........................] - ETA: 7s - loss: 0.0186 16/102 [===>..........................] - ETA: 7s - loss: 0.0184 17/102 [====>.........................] - ETA: 7s - loss: 0.0186 18/102 [====>.........................] - ETA: 7s - loss: 0.0191 19/102 [====>.........................] - ETA: 7s - loss: 0.0186 20/102 [====>.........................] - ETA: 7s - loss: 0.0184 21/102 [=====>........................] - ETA: 7s - loss: 0.0186 22/102 [=====>........................] - ETA: 7s - loss: 0.0184 23/102 [=====>........................] - ETA: 6s - loss: 0.0180 24/102 [======>.......................] - ETA: 6s - loss: 0.0181 25/102 [======>.......................] - ETA: 6s - loss: 0.0180 26/102 [======>.......................] - ETA: 6s - loss: 0.0186 27/102 [======>.......................] - ETA: 6s - loss: 0.0182 28/102 [=======>......................] - ETA: 6s - loss: 0.0181 29/102 [=======>......................] - ETA: 6s - loss: 0.0179 30/102 [=======>......................] - ETA: 6s - loss: 0.0178 31/102 [========>.....................] - ETA: 6s - loss: 0.0181 32/102 [========>.....................] - ETA: 6s - loss: 0.0180 33/102 [========>.....................] - ETA: 6s - loss: 0.0177 34/102 [=========>....................] - ETA: 6s - loss: 0.0181 35/102 [=========>....................] - ETA: 5s - loss: 0.0181 36/102 [=========>....................] - ETA: 5s - loss: 0.0180 37/102 [=========>....................] - ETA: 5s - loss: 0.0178 38/102 [==========>...................] - ETA: 5s - loss: 0.0178 39/102 [==========>...................] - ETA: 5s - loss: 0.0178 40/102 [==========>...................] - ETA: 5s - loss: 0.0178 41/102 [===========>..................] - ETA: 5s - loss: 0.0182 42/102 [===========>..................] - ETA: 5s - loss: 0.0184 43/102 [===========>..................] - ETA: 5s - loss: 0.0181 44/102 [===========>..................] - ETA: 5s - loss: 0.0180 45/102 [============>.................] - ETA: 5s - loss: 0.0179 46/102 [============>.................] - ETA: 4s - loss: 0.0177 47/102 [============>.................] - ETA: 4s - loss: 0.0181 48/102 [=============>................] - ETA: 4s - loss: 0.0179 49/102 [=============>................] - ETA: 4s - loss: 0.0177 50/102 [=============>................] - ETA: 4s - loss: 0.0178 51/102 [==============>...............] - ETA: 4s - loss: 0.0181 52/102 [==============>...............] - ETA: 4s - loss: 0.0179 53/102 [==============>...............] - ETA: 4s - loss: 0.0177 54/102 [==============>...............] - ETA: 4s - loss: 0.0178 55/102 [===============>..............] - ETA: 4s - loss: 0.0178 56/102 [===============>..............] - ETA: 4s - loss: 0.0179 57/102 [===============>..............] - ETA: 3s - loss: 0.0177 58/102 [================>.............] - ETA: 3s - loss: 0.0177 59/102 [================>.............] - ETA: 3s - loss: 0.0177 60/102 [================>.............] - ETA: 3s - loss: 0.0176 61/102 [================>.............] - ETA: 3s - loss: 0.0177 62/102 [=================>............] - ETA: 3s - loss: 0.0178 63/102 [=================>............] - ETA: 3s - loss: 0.0178 64/102 [=================>............] - ETA: 3s - loss: 0.0177 65/102 [==================>...........] - ETA: 3s - loss: 0.0178 66/102 [==================>...........] - ETA: 3s - loss: 0.0177 67/102 [==================>...........] - ETA: 3s - loss: 0.0177 68/102 [===================>..........] - ETA: 2s - loss: 0.0175 69/102 [===================>..........] - ETA: 2s - loss: 0.0174 70/102 [===================>..........] - ETA: 2s - loss: 0.0173 71/102 [===================>..........] - ETA: 2s - loss: 0.0173 72/102 [====================>.........] - ETA: 2s - loss: 0.0172 73/102 [====================>.........] - ETA: 2s - loss: 0.0173 74/102 [====================>.........] - ETA: 2s - loss: 0.0174 75/102 [=====================>........] - ETA: 2s - loss: 0.0174 76/102 [=====================>........] - ETA: 2s - loss: 0.0174 77/102 [=====================>........] - ETA: 2s - loss: 0.0176 78/102 [=====================>........] - ETA: 2s - loss: 0.0177 79/102 [======================>.......] - ETA: 2s - loss: 0.0176 80/102 [======================>.......] - ETA: 1s - loss: 0.0176 81/102 [======================>.......] - ETA: 1s - loss: 0.0178 82/102 [=======================>......] - ETA: 1s - loss: 0.0178 83/102 [=======================>......] - ETA: 1s - loss: 0.0178 84/102 [=======================>......] - ETA: 1s - loss: 0.0177 85/102 [========================>.....] - ETA: 1s - loss: 0.0179 86/102 [========================>.....] - ETA: 1s - loss: 0.0182 87/102 [========================>.....] - ETA: 1s - loss: 0.0183 88/102 [========================>.....] - ETA: 1s - loss: 0.0184 89/102 [=========================>....] - ETA: 1s - loss: 0.0183 90/102 [=========================>....] - ETA: 1s - loss: 0.0183 91/102 [=========================>....] - ETA: 0s - loss: 0.0183 92/102 [==========================>...] - ETA: 0s - loss: 0.0182 93/102 [==========================>...] - ETA: 0s - loss: 0.0183 94/102 [==========================>...] - ETA: 0s - loss: 0.0183 95/102 [==========================>...] - ETA: 0s - loss: 0.0182 96/102 [===========================>..] - ETA: 0s - loss: 0.0182 97/102 [===========================>..] - ETA: 0s - loss: 0.0182 98/102 [===========================>..] - ETA: 0s - loss: 0.0181 99/102 [============================>.] - ETA: 0s - loss: 0.0182100/102 [============================>.] - ETA: 0s - loss: 0.0181101/102 [============================>.] - ETA: 0s - loss: 0.0180102/102 [==============================] - ETA: 0s - loss: 0.0180102/102 [==============================] - 9s 92ms/step - loss: 0.0180 - val_loss: 0.0084 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.0239 5/16 [========>.....................] - ETA: 0s - loss: 0.0420 9/16 [===============>..............] - ETA: 0s - loss: 0.037313/16 [=======================>......] - ETA: 0s - loss: 0.038516/16 [==============================] - 0s 14ms/step - loss: 0.0421
Test Loss: 0.04205257445573807
Saved model as forecasting_models_v5/model_gru_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for GRU model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 918ms/step
Predicted QoE for the next time step: 86.33192423465806
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/gru_with_stats.h5
Completed at Τετ 14 Μαΐ 2025 10:16:04 μμ EEST
=====================================================

=====================================================
Training transformer model with config: basic
Starting at Τετ 14 Μαΐ 2025 10:16:04 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type transformer                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 
2025-05-14 22:16:04.986338: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:16:05.126984: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:16:05.714645: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:16:05.714724: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:16:05.714746: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:16:12.330469: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:16:13.022036: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:16:13.022063: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:16:13.022214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5599 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5, 45)]           0         
                                                                 
 transformer_block (Transfor  (None, 5, 45)            22564     
 merBlock)                                                       
                                                                 
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense_2 (Dense)             (None, 32)                7232      
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 29,829
Trainable params: 29,829
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 2:29 - loss: 0.5113  7/102 [=>............................] - ETA: 0s - loss: 0.3521   14/102 [===>..........................] - ETA: 0s - loss: 0.2784 21/102 [=====>........................] - ETA: 0s - loss: 0.2349 28/102 [=======>......................] - ETA: 0s - loss: 0.2071 34/102 [=========>....................] - ETA: 0s - loss: 0.1896 40/102 [==========>...................] - ETA: 0s - loss: 0.1763 47/102 [============>.................] - ETA: 0s - loss: 0.1627 53/102 [==============>...............] - ETA: 0s - loss: 0.1522 59/102 [================>.............] - ETA: 0s - loss: 0.1433 65/102 [==================>...........] - ETA: 0s - loss: 0.1362 71/102 [===================>..........] - ETA: 0s - loss: 0.1293 77/102 [=====================>........] - ETA: 0s - loss: 0.1250 83/102 [=======================>......] - ETA: 0s - loss: 0.1197 90/102 [=========================>....] - ETA: 0s - loss: 0.1133 97/102 [===========================>..] - ETA: 0s - loss: 0.1082102/102 [==============================] - 3s 12ms/step - loss: 0.1055 - val_loss: 0.0109 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 1s - loss: 0.0153  8/102 [=>............................] - ETA: 0s - loss: 0.0369 15/102 [===>..........................] - ETA: 0s - loss: 0.0389 21/102 [=====>........................] - ETA: 0s - loss: 0.0366 27/102 [======>.......................] - ETA: 0s - loss: 0.0383 33/102 [========>.....................] - ETA: 0s - loss: 0.0371 39/102 [==========>...................] - ETA: 0s - loss: 0.0361 45/102 [============>.................] - ETA: 0s - loss: 0.0360 51/102 [==============>...............] - ETA: 0s - loss: 0.0359 57/102 [===============>..............] - ETA: 0s - loss: 0.0352 63/102 [=================>............] - ETA: 0s - loss: 0.0348 69/102 [===================>..........] - ETA: 0s - loss: 0.0343 76/102 [=====================>........] - ETA: 0s - loss: 0.0334 82/102 [=======================>......] - ETA: 0s - loss: 0.0325 88/102 [========================>.....] - ETA: 0s - loss: 0.0321 94/102 [==========================>...] - ETA: 0s - loss: 0.0312100/102 [============================>.] - ETA: 0s - loss: 0.0308102/102 [==============================] - 1s 10ms/step - loss: 0.0309 - val_loss: 0.0177 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.0245  8/102 [=>............................] - ETA: 0s - loss: 0.0250 14/102 [===>..........................] - ETA: 0s - loss: 0.0230 20/102 [====>.........................] - ETA: 0s - loss: 0.0258 27/102 [======>.......................] - ETA: 0s - loss: 0.0235 33/102 [========>.....................] - ETA: 0s - loss: 0.0256 39/102 [==========>...................] - ETA: 0s - loss: 0.0250 45/102 [============>.................] - ETA: 0s - loss: 0.0242 52/102 [==============>...............] - ETA: 0s - loss: 0.0241 59/102 [================>.............] - ETA: 0s - loss: 0.0240 66/102 [==================>...........] - ETA: 0s - loss: 0.0231 73/102 [====================>.........] - ETA: 0s - loss: 0.0230 80/102 [======================>.......] - ETA: 0s - loss: 0.0232 87/102 [========================>.....] - ETA: 0s - loss: 0.0231 95/102 [==========================>...] - ETA: 0s - loss: 0.0235102/102 [==============================] - ETA: 0s - loss: 0.0231102/102 [==============================] - 1s 9ms/step - loss: 0.0231 - val_loss: 0.0101 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 1s - loss: 0.0187  7/102 [=>............................] - ETA: 0s - loss: 0.0189 13/102 [==>...........................] - ETA: 0s - loss: 0.0241 19/102 [====>.........................] - ETA: 0s - loss: 0.0232 25/102 [======>.......................] - ETA: 0s - loss: 0.0217 31/102 [========>.....................] - ETA: 0s - loss: 0.0211 37/102 [=========>....................] - ETA: 0s - loss: 0.0203 43/102 [===========>..................] - ETA: 0s - loss: 0.0201 49/102 [=============>................] - ETA: 0s - loss: 0.0206 55/102 [===============>..............] - ETA: 0s - loss: 0.0204 61/102 [================>.............] - ETA: 0s - loss: 0.0202 67/102 [==================>...........] - ETA: 0s - loss: 0.0203 73/102 [====================>.........] - ETA: 0s - loss: 0.0200 79/102 [======================>.......] - ETA: 0s - loss: 0.0197 85/102 [========================>.....] - ETA: 0s - loss: 0.0197 91/102 [=========================>....] - ETA: 0s - loss: 0.0196 97/102 [===========================>..] - ETA: 0s - loss: 0.0195102/102 [==============================] - 1s 10ms/step - loss: 0.0198 - val_loss: 0.0164 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0108  7/102 [=>............................] - ETA: 0s - loss: 0.0155 13/102 [==>...........................] - ETA: 0s - loss: 0.0169 19/102 [====>.........................] - ETA: 0s - loss: 0.0163 25/102 [======>.......................] - ETA: 0s - loss: 0.0173 31/102 [========>.....................] - ETA: 0s - loss: 0.0179 37/102 [=========>....................] - ETA: 0s - loss: 0.0190 43/102 [===========>..................] - ETA: 0s - loss: 0.0185 49/102 [=============>................] - ETA: 0s - loss: 0.0183 56/102 [===============>..............] - ETA: 0s - loss: 0.0180 62/102 [=================>............] - ETA: 0s - loss: 0.0176 68/102 [===================>..........] - ETA: 0s - loss: 0.0175 74/102 [====================>.........] - ETA: 0s - loss: 0.0183 80/102 [======================>.......] - ETA: 0s - loss: 0.0183 87/102 [========================>.....] - ETA: 0s - loss: 0.0183 93/102 [==========================>...] - ETA: 0s - loss: 0.0179 99/102 [============================>.] - ETA: 0s - loss: 0.0179102/102 [==============================] - 1s 10ms/step - loss: 0.0182 - val_loss: 0.0105 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0304  7/102 [=>............................] - ETA: 0s - loss: 0.0200 13/102 [==>...........................] - ETA: 0s - loss: 0.0193 19/102 [====>.........................] - ETA: 0s - loss: 0.0189 25/102 [======>.......................] - ETA: 0s - loss: 0.0188 31/102 [========>.....................] - ETA: 0s - loss: 0.0176 37/102 [=========>....................] - ETA: 0s - loss: 0.0176 43/102 [===========>..................] - ETA: 0s - loss: 0.0172 49/102 [=============>................] - ETA: 0s - loss: 0.0166 55/102 [===============>..............] - ETA: 0s - loss: 0.0178 62/102 [=================>............] - ETA: 0s - loss: 0.0174 68/102 [===================>..........] - ETA: 0s - loss: 0.0172 74/102 [====================>.........] - ETA: 0s - loss: 0.0174 80/102 [======================>.......] - ETA: 0s - loss: 0.0173 86/102 [========================>.....] - ETA: 0s - loss: 0.0169 92/102 [==========================>...] - ETA: 0s - loss: 0.0170 98/102 [===========================>..] - ETA: 0s - loss: 0.0174102/102 [==============================] - 1s 10ms/step - loss: 0.0172 - val_loss: 0.0150 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.031514/16 [=========================>....] - ETA: 0s - loss: 0.047716/16 [==============================] - 0s 4ms/step - loss: 0.0501
Test Loss: 0.05009349808096886
Saved model as forecasting_models_v5/model_transformer_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for TRANSFORMER model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 185ms/step
Predicted QoE for the next time step: 91.41261833581459
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/transformer_basic.h5
Completed at Τετ 14 Μαΐ 2025 10:16:24 μμ EEST
=====================================================

=====================================================
Training transformer model with config: more_heads
Starting at Τετ 14 Μαΐ 2025 10:16:24 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type transformer                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --num_heads 4
2025-05-14 22:16:24.830232: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:16:24.985248: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:16:25.573934: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:16:25.574011: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:16:25.574020: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:16:32.164876: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:16:32.820103: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:16:32.820127: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:16:32.820267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5599 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5, 45)]           0         
                                                                 
 transformer_block (Transfor  (None, 5, 45)            39034     
 merBlock)                                                       
                                                                 
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense_2 (Dense)             (None, 32)                7232      
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 46,299
Trainable params: 46,299
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 2:30 - loss: 2.0826  8/102 [=>............................] - ETA: 0s - loss: 0.5731   15/102 [===>..........................] - ETA: 0s - loss: 0.4051 23/102 [=====>........................] - ETA: 0s - loss: 0.3144 30/102 [=======>......................] - ETA: 0s - loss: 0.2652 37/102 [=========>....................] - ETA: 0s - loss: 0.2323 44/102 [===========>..................] - ETA: 0s - loss: 0.2048 50/102 [=============>................] - ETA: 0s - loss: 0.1901 56/102 [===============>..............] - ETA: 0s - loss: 0.1757 62/102 [=================>............] - ETA: 0s - loss: 0.1649 68/102 [===================>..........] - ETA: 0s - loss: 0.1570 74/102 [====================>.........] - ETA: 0s - loss: 0.1481 80/102 [======================>.......] - ETA: 0s - loss: 0.1400 87/102 [========================>.....] - ETA: 0s - loss: 0.1332 94/102 [==========================>...] - ETA: 0s - loss: 0.1264100/102 [============================>.] - ETA: 0s - loss: 0.1215102/102 [==============================] - 3s 12ms/step - loss: 0.1209 - val_loss: 0.0230 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.0403  8/102 [=>............................] - ETA: 0s - loss: 0.0398 15/102 [===>..........................] - ETA: 0s - loss: 0.0375 22/102 [=====>........................] - ETA: 0s - loss: 0.0364 29/102 [=======>......................] - ETA: 0s - loss: 0.0330 37/102 [=========>....................] - ETA: 0s - loss: 0.0336 44/102 [===========>..................] - ETA: 0s - loss: 0.0335 51/102 [==============>...............] - ETA: 0s - loss: 0.0319 59/102 [================>.............] - ETA: 0s - loss: 0.0318 65/102 [==================>...........] - ETA: 0s - loss: 0.0317 72/102 [====================>.........] - ETA: 0s - loss: 0.0313 78/102 [=====================>........] - ETA: 0s - loss: 0.0308 85/102 [========================>.....] - ETA: 0s - loss: 0.0299 91/102 [=========================>....] - ETA: 0s - loss: 0.0295 98/102 [===========================>..] - ETA: 0s - loss: 0.0293102/102 [==============================] - 1s 9ms/step - loss: 0.0292 - val_loss: 0.0162 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.0170  7/102 [=>............................] - ETA: 0s - loss: 0.0255 13/102 [==>...........................] - ETA: 0s - loss: 0.0262 20/102 [====>.........................] - ETA: 0s - loss: 0.0234 27/102 [======>.......................] - ETA: 0s - loss: 0.0239 34/102 [=========>....................] - ETA: 0s - loss: 0.0247 40/102 [==========>...................] - ETA: 0s - loss: 0.0243 47/102 [============>.................] - ETA: 0s - loss: 0.0242 54/102 [==============>...............] - ETA: 0s - loss: 0.0242 61/102 [================>.............] - ETA: 0s - loss: 0.0239 68/102 [===================>..........] - ETA: 0s - loss: 0.0246 74/102 [====================>.........] - ETA: 0s - loss: 0.0243 80/102 [======================>.......] - ETA: 0s - loss: 0.0240 86/102 [========================>.....] - ETA: 0s - loss: 0.0238 92/102 [==========================>...] - ETA: 0s - loss: 0.0237 99/102 [============================>.] - ETA: 0s - loss: 0.0229102/102 [==============================] - 1s 10ms/step - loss: 0.0228 - val_loss: 0.0272 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0289  7/102 [=>............................] - ETA: 0s - loss: 0.0192 13/102 [==>...........................] - ETA: 0s - loss: 0.0235 19/102 [====>.........................] - ETA: 0s - loss: 0.0229 25/102 [======>.......................] - ETA: 0s - loss: 0.0229 31/102 [========>.....................] - ETA: 0s - loss: 0.0235 37/102 [=========>....................] - ETA: 0s - loss: 0.0230 44/102 [===========>..................] - ETA: 0s - loss: 0.0225 50/102 [=============>................] - ETA: 0s - loss: 0.0221 57/102 [===============>..............] - ETA: 0s - loss: 0.0216 63/102 [=================>............] - ETA: 0s - loss: 0.0219 70/102 [===================>..........] - ETA: 0s - loss: 0.0211 76/102 [=====================>........] - ETA: 0s - loss: 0.0205 82/102 [=======================>......] - ETA: 0s - loss: 0.0202 88/102 [========================>.....] - ETA: 0s - loss: 0.0203 94/102 [==========================>...] - ETA: 0s - loss: 0.0201100/102 [============================>.] - ETA: 0s - loss: 0.0199102/102 [==============================] - 1s 10ms/step - loss: 0.0199 - val_loss: 0.0280 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0449  7/102 [=>............................] - ETA: 0s - loss: 0.0247 13/102 [==>...........................] - ETA: 0s - loss: 0.0217 19/102 [====>.........................] - ETA: 0s - loss: 0.0226 25/102 [======>.......................] - ETA: 0s - loss: 0.0230 31/102 [========>.....................] - ETA: 0s - loss: 0.0223 37/102 [=========>....................] - ETA: 0s - loss: 0.0209 44/102 [===========>..................] - ETA: 0s - loss: 0.0206 50/102 [=============>................] - ETA: 0s - loss: 0.0199 56/102 [===============>..............] - ETA: 0s - loss: 0.0194 63/102 [=================>............] - ETA: 0s - loss: 0.0185 70/102 [===================>..........] - ETA: 0s - loss: 0.0181 77/102 [=====================>........] - ETA: 0s - loss: 0.0179 83/102 [=======================>......] - ETA: 0s - loss: 0.0178 88/102 [========================>.....] - ETA: 0s - loss: 0.0176 95/102 [==========================>...] - ETA: 0s - loss: 0.0179102/102 [==============================] - ETA: 0s - loss: 0.0181102/102 [==============================] - 1s 10ms/step - loss: 0.0181 - val_loss: 0.0175 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.045314/16 [=========================>....] - ETA: 0s - loss: 0.063216/16 [==============================] - 0s 4ms/step - loss: 0.0659
Test Loss: 0.0658564493060112
Saved model as forecasting_models_v5/model_transformer_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for TRANSFORMER model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 183ms/step
Predicted QoE for the next time step: 75.03339025999027
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/transformer_more_heads.h5
Completed at Τετ 14 Μαΐ 2025 10:16:43 μμ EEST
=====================================================

=====================================================
Training transformer model with config: large_ff
Starting at Τετ 14 Μαΐ 2025 10:16:43 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type transformer                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --ff_dim 128
2025-05-14 22:16:43.439460: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:16:43.584811: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:16:44.165596: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:16:44.165676: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:16:44.165686: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:16:50.660468: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:16:51.353699: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:16:51.353725: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:16:51.353873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5597 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5, 45)]           0         
                                                                 
 transformer_block (Transfor  (None, 5, 45)            28388     
 merBlock)                                                       
                                                                 
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense_2 (Dense)             (None, 32)                7232      
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 35,653
Trainable params: 35,653
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 2:27 - loss: 0.6209  8/102 [=>............................] - ETA: 0s - loss: 0.3289   15/102 [===>..........................] - ETA: 0s - loss: 0.2790 22/102 [=====>........................] - ETA: 0s - loss: 0.2407 28/102 [=======>......................] - ETA: 0s - loss: 0.2104 34/102 [=========>....................] - ETA: 0s - loss: 0.1915 40/102 [==========>...................] - ETA: 0s - loss: 0.1760 47/102 [============>.................] - ETA: 0s - loss: 0.1628 53/102 [==============>...............] - ETA: 0s - loss: 0.1533 59/102 [================>.............] - ETA: 0s - loss: 0.1438 65/102 [==================>...........] - ETA: 0s - loss: 0.1353 71/102 [===================>..........] - ETA: 0s - loss: 0.1276 77/102 [=====================>........] - ETA: 0s - loss: 0.1218 83/102 [=======================>......] - ETA: 0s - loss: 0.1171 89/102 [=========================>....] - ETA: 0s - loss: 0.1120 95/102 [==========================>...] - ETA: 0s - loss: 0.1073101/102 [============================>.] - ETA: 0s - loss: 0.1030102/102 [==============================] - 3s 12ms/step - loss: 0.1030 - val_loss: 0.0097 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.0144  7/102 [=>............................] - ETA: 0s - loss: 0.0277 14/102 [===>..........................] - ETA: 0s - loss: 0.0297 20/102 [====>.........................] - ETA: 0s - loss: 0.0318 27/102 [======>.......................] - ETA: 0s - loss: 0.0309 33/102 [========>.....................] - ETA: 0s - loss: 0.0298 39/102 [==========>...................] - ETA: 0s - loss: 0.0306 45/102 [============>.................] - ETA: 0s - loss: 0.0293 51/102 [==============>...............] - ETA: 0s - loss: 0.0296 57/102 [===============>..............] - ETA: 0s - loss: 0.0293 64/102 [=================>............] - ETA: 0s - loss: 0.0289 70/102 [===================>..........] - ETA: 0s - loss: 0.0285 76/102 [=====================>........] - ETA: 0s - loss: 0.0275 82/102 [=======================>......] - ETA: 0s - loss: 0.0271 88/102 [========================>.....] - ETA: 0s - loss: 0.0268 95/102 [==========================>...] - ETA: 0s - loss: 0.0269101/102 [============================>.] - ETA: 0s - loss: 0.0262102/102 [==============================] - 1s 10ms/step - loss: 0.0262 - val_loss: 0.0220 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.0197  7/102 [=>............................] - ETA: 0s - loss: 0.0242 13/102 [==>...........................] - ETA: 0s - loss: 0.0211 19/102 [====>.........................] - ETA: 0s - loss: 0.0211 25/102 [======>.......................] - ETA: 0s - loss: 0.0229 31/102 [========>.....................] - ETA: 0s - loss: 0.0232 38/102 [==========>...................] - ETA: 0s - loss: 0.0227 44/102 [===========>..................] - ETA: 0s - loss: 0.0228 50/102 [=============>................] - ETA: 0s - loss: 0.0231 56/102 [===============>..............] - ETA: 0s - loss: 0.0230 62/102 [=================>............] - ETA: 0s - loss: 0.0229 68/102 [===================>..........] - ETA: 0s - loss: 0.0228 74/102 [====================>.........] - ETA: 0s - loss: 0.0228 80/102 [======================>.......] - ETA: 0s - loss: 0.0226 86/102 [========================>.....] - ETA: 0s - loss: 0.0224 92/102 [==========================>...] - ETA: 0s - loss: 0.0219 98/102 [===========================>..] - ETA: 0s - loss: 0.0217102/102 [==============================] - 1s 10ms/step - loss: 0.0218 - val_loss: 0.0181 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0258  7/102 [=>............................] - ETA: 0s - loss: 0.0211 14/102 [===>..........................] - ETA: 0s - loss: 0.0225 20/102 [====>.........................] - ETA: 0s - loss: 0.0218 26/102 [======>.......................] - ETA: 0s - loss: 0.0218 33/102 [========>.....................] - ETA: 0s - loss: 0.0217 39/102 [==========>...................] - ETA: 0s - loss: 0.0212 45/102 [============>.................] - ETA: 0s - loss: 0.0201 52/102 [==============>...............] - ETA: 0s - loss: 0.0194 58/102 [================>.............] - ETA: 0s - loss: 0.0198 64/102 [=================>............] - ETA: 0s - loss: 0.0196 71/102 [===================>..........] - ETA: 0s - loss: 0.0192 77/102 [=====================>........] - ETA: 0s - loss: 0.0189 83/102 [=======================>......] - ETA: 0s - loss: 0.0190 89/102 [=========================>....] - ETA: 0s - loss: 0.0191 95/102 [==========================>...] - ETA: 0s - loss: 0.0192101/102 [============================>.] - ETA: 0s - loss: 0.0195102/102 [==============================] - 1s 10ms/step - loss: 0.0195 - val_loss: 0.0101 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.030414/16 [=========================>....] - ETA: 0s - loss: 0.044416/16 [==============================] - 0s 4ms/step - loss: 0.0468
Test Loss: 0.04675884544849396
Saved model as forecasting_models_v5/model_transformer_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for TRANSFORMER model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 185ms/step
Predicted QoE for the next time step: 45.5361479069319
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/transformer_large_ff.h5
Completed at Τετ 14 Μαΐ 2025 10:17:00 μμ EEST
=====================================================

=====================================================
Training transformer model with config: low_dropout
Starting at Τετ 14 Μαΐ 2025 10:17:00 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type transformer                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 --dropout_rate 0.05
2025-05-14 22:17:01.033703: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:17:01.190502: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:17:01.846138: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:17:01.846220: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:17:01.846231: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:17:08.299959: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:17:08.986850: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:17:08.986874: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:17:08.987009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5604 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5, 45)]           0         
                                                                 
 transformer_block (Transfor  (None, 5, 45)            22564     
 merBlock)                                                       
                                                                 
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense_2 (Dense)             (None, 32)                7232      
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 29,829
Trainable params: 29,829
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 2:27 - loss: 0.3373  8/102 [=>............................] - ETA: 0s - loss: 0.2574   15/102 [===>..........................] - ETA: 0s - loss: 0.2142 22/102 [=====>........................] - ETA: 0s - loss: 0.1888 29/102 [=======>......................] - ETA: 0s - loss: 0.1638 35/102 [=========>....................] - ETA: 0s - loss: 0.1520 41/102 [===========>..................] - ETA: 0s - loss: 0.1377 47/102 [============>.................] - ETA: 0s - loss: 0.1274 53/102 [==============>...............] - ETA: 0s - loss: 0.1210 59/102 [================>.............] - ETA: 0s - loss: 0.1143 65/102 [==================>...........] - ETA: 0s - loss: 0.1075 71/102 [===================>..........] - ETA: 0s - loss: 0.1026 77/102 [=====================>........] - ETA: 0s - loss: 0.0978 84/102 [=======================>......] - ETA: 0s - loss: 0.0935 91/102 [=========================>....] - ETA: 0s - loss: 0.0891 98/102 [===========================>..] - ETA: 0s - loss: 0.0851102/102 [==============================] - 3s 12ms/step - loss: 0.0837 - val_loss: 0.0141 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 1s - loss: 0.0442  7/102 [=>............................] - ETA: 0s - loss: 0.0352 14/102 [===>..........................] - ETA: 0s - loss: 0.0375 21/102 [=====>........................] - ETA: 0s - loss: 0.0339 27/102 [======>.......................] - ETA: 0s - loss: 0.0327 33/102 [========>.....................] - ETA: 0s - loss: 0.0334 40/102 [==========>...................] - ETA: 0s - loss: 0.0333 46/102 [============>.................] - ETA: 0s - loss: 0.0322 52/102 [==============>...............] - ETA: 0s - loss: 0.0322 58/102 [================>.............] - ETA: 0s - loss: 0.0314 64/102 [=================>............] - ETA: 0s - loss: 0.0313 70/102 [===================>..........] - ETA: 0s - loss: 0.0308 77/102 [=====================>........] - ETA: 0s - loss: 0.0315 84/102 [=======================>......] - ETA: 0s - loss: 0.0316 91/102 [=========================>....] - ETA: 0s - loss: 0.0310 98/102 [===========================>..] - ETA: 0s - loss: 0.0305102/102 [==============================] - 1s 10ms/step - loss: 0.0304 - val_loss: 0.0106 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 1s - loss: 0.0197  7/102 [=>............................] - ETA: 0s - loss: 0.0191 13/102 [==>...........................] - ETA: 0s - loss: 0.0238 20/102 [====>.........................] - ETA: 0s - loss: 0.0251 27/102 [======>.......................] - ETA: 0s - loss: 0.0249 34/102 [=========>....................] - ETA: 0s - loss: 0.0246 40/102 [==========>...................] - ETA: 0s - loss: 0.0244 46/102 [============>.................] - ETA: 0s - loss: 0.0242 53/102 [==============>...............] - ETA: 0s - loss: 0.0235 59/102 [================>.............] - ETA: 0s - loss: 0.0240 65/102 [==================>...........] - ETA: 0s - loss: 0.0243 71/102 [===================>..........] - ETA: 0s - loss: 0.0242 77/102 [=====================>........] - ETA: 0s - loss: 0.0238 83/102 [=======================>......] - ETA: 0s - loss: 0.0236 89/102 [=========================>....] - ETA: 0s - loss: 0.0231 94/102 [==========================>...] - ETA: 0s - loss: 0.0231102/102 [==============================] - ETA: 0s - loss: 0.0227102/102 [==============================] - 1s 10ms/step - loss: 0.0227 - val_loss: 0.0155 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0342  7/102 [=>............................] - ETA: 0s - loss: 0.0228 13/102 [==>...........................] - ETA: 0s - loss: 0.0225 19/102 [====>.........................] - ETA: 0s - loss: 0.0225 25/102 [======>.......................] - ETA: 0s - loss: 0.0237 31/102 [========>.....................] - ETA: 0s - loss: 0.0227 37/102 [=========>....................] - ETA: 0s - loss: 0.0213 43/102 [===========>..................] - ETA: 0s - loss: 0.0212 50/102 [=============>................] - ETA: 0s - loss: 0.0204 56/102 [===============>..............] - ETA: 0s - loss: 0.0200 62/102 [=================>............] - ETA: 0s - loss: 0.0204 68/102 [===================>..........] - ETA: 0s - loss: 0.0198 74/102 [====================>.........] - ETA: 0s - loss: 0.0199 80/102 [======================>.......] - ETA: 0s - loss: 0.0200 86/102 [========================>.....] - ETA: 0s - loss: 0.0195 92/102 [==========================>...] - ETA: 0s - loss: 0.0194 98/102 [===========================>..] - ETA: 0s - loss: 0.0195102/102 [==============================] - 1s 10ms/step - loss: 0.0192 - val_loss: 0.0102 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0082  8/102 [=>............................] - ETA: 0s - loss: 0.0192 14/102 [===>..........................] - ETA: 0s - loss: 0.0165 20/102 [====>.........................] - ETA: 0s - loss: 0.0162 26/102 [======>.......................] - ETA: 0s - loss: 0.0176 32/102 [========>.....................] - ETA: 0s - loss: 0.0170 38/102 [==========>...................] - ETA: 0s - loss: 0.0170 44/102 [===========>..................] - ETA: 0s - loss: 0.0179 50/102 [=============>................] - ETA: 0s - loss: 0.0174 57/102 [===============>..............] - ETA: 0s - loss: 0.0172 64/102 [=================>............] - ETA: 0s - loss: 0.0177 70/102 [===================>..........] - ETA: 0s - loss: 0.0173 76/102 [=====================>........] - ETA: 0s - loss: 0.0169 82/102 [=======================>......] - ETA: 0s - loss: 0.0171 88/102 [========================>.....] - ETA: 0s - loss: 0.0174 94/102 [==========================>...] - ETA: 0s - loss: 0.0177100/102 [============================>.] - ETA: 0s - loss: 0.0176102/102 [==============================] - 1s 10ms/step - loss: 0.0176 - val_loss: 0.0223 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0100  7/102 [=>............................] - ETA: 0s - loss: 0.0117 14/102 [===>..........................] - ETA: 0s - loss: 0.0141 20/102 [====>.........................] - ETA: 0s - loss: 0.0135 26/102 [======>.......................] - ETA: 0s - loss: 0.0150 32/102 [========>.....................] - ETA: 0s - loss: 0.0149 38/102 [==========>...................] - ETA: 0s - loss: 0.0154 44/102 [===========>..................] - ETA: 0s - loss: 0.0155 50/102 [=============>................] - ETA: 0s - loss: 0.0154 56/102 [===============>..............] - ETA: 0s - loss: 0.0152 62/102 [=================>............] - ETA: 0s - loss: 0.0165 68/102 [===================>..........] - ETA: 0s - loss: 0.0162 74/102 [====================>.........] - ETA: 0s - loss: 0.0169 80/102 [======================>.......] - ETA: 0s - loss: 0.0167 86/102 [========================>.....] - ETA: 0s - loss: 0.0165 92/102 [==========================>...] - ETA: 0s - loss: 0.0166 98/102 [===========================>..] - ETA: 0s - loss: 0.0167102/102 [==============================] - 1s 10ms/step - loss: 0.0167 - val_loss: 0.0111 - lr: 0.0010
Epoch 7/20
  1/102 [..............................] - ETA: 1s - loss: 0.0088  7/102 [=>............................] - ETA: 0s - loss: 0.0145 13/102 [==>...........................] - ETA: 0s - loss: 0.0136 19/102 [====>.........................] - ETA: 0s - loss: 0.0146 26/102 [======>.......................] - ETA: 0s - loss: 0.0142 32/102 [========>.....................] - ETA: 0s - loss: 0.0145 38/102 [==========>...................] - ETA: 0s - loss: 0.0139 44/102 [===========>..................] - ETA: 0s - loss: 0.0146 50/102 [=============>................] - ETA: 0s - loss: 0.0145 57/102 [===============>..............] - ETA: 0s - loss: 0.0148 63/102 [=================>............] - ETA: 0s - loss: 0.0155 69/102 [===================>..........] - ETA: 0s - loss: 0.0155 75/102 [=====================>........] - ETA: 0s - loss: 0.0156 82/102 [=======================>......] - ETA: 0s - loss: 0.0158 88/102 [========================>.....] - ETA: 0s - loss: 0.0158 95/102 [==========================>...] - ETA: 0s - loss: 0.0156102/102 [==============================] - ETA: 0s - loss: 0.0161102/102 [==============================] - 1s 10ms/step - loss: 0.0161 - val_loss: 0.0088 - lr: 5.0000e-04
Epoch 8/20
  1/102 [..............................] - ETA: 0s - loss: 0.0233  8/102 [=>............................] - ETA: 0s - loss: 0.0119 15/102 [===>..........................] - ETA: 0s - loss: 0.0109 22/102 [=====>........................] - ETA: 0s - loss: 0.0115 29/102 [=======>......................] - ETA: 0s - loss: 0.0144 35/102 [=========>....................] - ETA: 0s - loss: 0.0155 42/102 [===========>..................] - ETA: 0s - loss: 0.0162 49/102 [=============>................] - ETA: 0s - loss: 0.0162 56/102 [===============>..............] - ETA: 0s - loss: 0.0166 63/102 [=================>............] - ETA: 0s - loss: 0.0167 69/102 [===================>..........] - ETA: 0s - loss: 0.0167 76/102 [=====================>........] - ETA: 0s - loss: 0.0167 82/102 [=======================>......] - ETA: 0s - loss: 0.0166 89/102 [=========================>....] - ETA: 0s - loss: 0.0161 95/102 [==========================>...] - ETA: 0s - loss: 0.0161102/102 [==============================] - ETA: 0s - loss: 0.0163102/102 [==============================] - 1s 9ms/step - loss: 0.0163 - val_loss: 0.0086 - lr: 5.0000e-04
Epoch 9/20
  1/102 [..............................] - ETA: 0s - loss: 0.0097  7/102 [=>............................] - ETA: 0s - loss: 0.0135 13/102 [==>...........................] - ETA: 0s - loss: 0.0154 20/102 [====>.........................] - ETA: 0s - loss: 0.0152 26/102 [======>.......................] - ETA: 0s - loss: 0.0148 32/102 [========>.....................] - ETA: 0s - loss: 0.0143 38/102 [==========>...................] - ETA: 0s - loss: 0.0145 44/102 [===========>..................] - ETA: 0s - loss: 0.0140 50/102 [=============>................] - ETA: 0s - loss: 0.0153 56/102 [===============>..............] - ETA: 0s - loss: 0.0149 63/102 [=================>............] - ETA: 0s - loss: 0.0145 69/102 [===================>..........] - ETA: 0s - loss: 0.0152 75/102 [=====================>........] - ETA: 0s - loss: 0.0149 81/102 [======================>.......] - ETA: 0s - loss: 0.0150 87/102 [========================>.....] - ETA: 0s - loss: 0.0149 93/102 [==========================>...] - ETA: 0s - loss: 0.0153 99/102 [============================>.] - ETA: 0s - loss: 0.0155102/102 [==============================] - 1s 10ms/step - loss: 0.0154 - val_loss: 0.0092 - lr: 5.0000e-04
Epoch 10/20
  1/102 [..............................] - ETA: 0s - loss: 0.0127  8/102 [=>............................] - ETA: 0s - loss: 0.0144 15/102 [===>..........................] - ETA: 0s - loss: 0.0138 21/102 [=====>........................] - ETA: 0s - loss: 0.0140 27/102 [======>.......................] - ETA: 0s - loss: 0.0133 33/102 [========>.....................] - ETA: 0s - loss: 0.0139 39/102 [==========>...................] - ETA: 0s - loss: 0.0145 45/102 [============>.................] - ETA: 0s - loss: 0.0149 52/102 [==============>...............] - ETA: 0s - loss: 0.0141 58/102 [================>.............] - ETA: 0s - loss: 0.0143 64/102 [=================>............] - ETA: 0s - loss: 0.0146 70/102 [===================>..........] - ETA: 0s - loss: 0.0148 76/102 [=====================>........] - ETA: 0s - loss: 0.0149 82/102 [=======================>......] - ETA: 0s - loss: 0.0152 88/102 [========================>.....] - ETA: 0s - loss: 0.0155 94/102 [==========================>...] - ETA: 0s - loss: 0.0156100/102 [============================>.] - ETA: 0s - loss: 0.0153102/102 [==============================] - 1s 10ms/step - loss: 0.0154 - val_loss: 0.0107 - lr: 5.0000e-04
Epoch 11/20
  1/102 [..............................] - ETA: 0s - loss: 0.0084  7/102 [=>............................] - ETA: 0s - loss: 0.0164 13/102 [==>...........................] - ETA: 0s - loss: 0.0132 19/102 [====>.........................] - ETA: 0s - loss: 0.0147 25/102 [======>.......................] - ETA: 0s - loss: 0.0163 31/102 [========>.....................] - ETA: 0s - loss: 0.0163 38/102 [==========>...................] - ETA: 0s - loss: 0.0162 44/102 [===========>..................] - ETA: 0s - loss: 0.0156 51/102 [==============>...............] - ETA: 0s - loss: 0.0156 57/102 [===============>..............] - ETA: 0s - loss: 0.0157 64/102 [=================>............] - ETA: 0s - loss: 0.0159 70/102 [===================>..........] - ETA: 0s - loss: 0.0156 76/102 [=====================>........] - ETA: 0s - loss: 0.0158 82/102 [=======================>......] - ETA: 0s - loss: 0.0158 88/102 [========================>.....] - ETA: 0s - loss: 0.0154 95/102 [==========================>...] - ETA: 0s - loss: 0.0152102/102 [==============================] - ETA: 0s - loss: 0.0151102/102 [==============================] - 1s 10ms/step - loss: 0.0151 - val_loss: 0.0100 - lr: 2.5000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.019214/16 [=========================>....] - ETA: 0s - loss: 0.028916/16 [==============================] - 0s 4ms/step - loss: 0.0294
Test Loss: 0.02935037948191166
Saved model as forecasting_models_v5/model_transformer_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for TRANSFORMER model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 188ms/step
Predicted QoE for the next time step: 46.425948715358636
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/transformer_low_dropout.h5
Completed at Τετ 14 Μαΐ 2025 10:17:25 μμ EEST
=====================================================

=====================================================
Training transformer model with config: with_stats
Starting at Τετ 14 Μαΐ 2025 10:17:25 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset                 --model_type transformer                 --seq_length 5                 --epochs 20                 --batch_size 16                 --tune                 --augmented                 --use_stats                 
2025-05-14 22:17:25.661435: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:17:25.818333: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-14 22:17:26.399692: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:17:26.399809: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-14 22:17:26.399823: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-14 22:17:32.890504: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-14 22:17:33.538548: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-14 22:17:33.538572: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-14 22:17:33.538700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5604 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset
Using new format
Dataset shape: (2536, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 2531
Input shape: (2531, 5, 45)
Training samples: 2024 Test samples: 507
Starting automated hyperparameter tuning...
Reloading Tuner from tuner_dir/qoe_tuning/tuner0.json
Best hyperparameters found:
{'hidden_units': 96, 'num_layers': 4, 'dropout_rate': 0.5, 'learning_rate': 0.001, 'tuner/epochs': 7, 'tuner/initial_epoch': 3, 'tuner/bracket': 2, 'tuner/round': 1, 'tuner/trial_id': '0003'}
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5, 45)]           0         
                                                                 
 transformer_block (Transfor  (None, 5, 45)            22564     
 merBlock)                                                       
                                                                 
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense_2 (Dense)             (None, 32)                7232      
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 29,829
Trainable params: 29,829
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/102 [..............................] - ETA: 2:30 - loss: 0.4097  7/102 [=>............................] - ETA: 0s - loss: 0.3256   14/102 [===>..........................] - ETA: 0s - loss: 0.2750 21/102 [=====>........................] - ETA: 0s - loss: 0.2294 27/102 [======>.......................] - ETA: 0s - loss: 0.1967 33/102 [========>.....................] - ETA: 0s - loss: 0.1732 39/102 [==========>...................] - ETA: 0s - loss: 0.1588 45/102 [============>.................] - ETA: 0s - loss: 0.1469 51/102 [==============>...............] - ETA: 0s - loss: 0.1352 57/102 [===============>..............] - ETA: 0s - loss: 0.1256 64/102 [=================>............] - ETA: 0s - loss: 0.1170 71/102 [===================>..........] - ETA: 0s - loss: 0.1089 77/102 [=====================>........] - ETA: 0s - loss: 0.1029 83/102 [=======================>......] - ETA: 0s - loss: 0.0979 89/102 [=========================>....] - ETA: 0s - loss: 0.0935 95/102 [==========================>...] - ETA: 0s - loss: 0.0900101/102 [============================>.] - ETA: 0s - loss: 0.0866102/102 [==============================] - 3s 13ms/step - loss: 0.0865 - val_loss: 0.0153 - lr: 0.0010
Epoch 2/20
  1/102 [..............................] - ETA: 0s - loss: 0.0281  7/102 [=>............................] - ETA: 0s - loss: 0.0274 13/102 [==>...........................] - ETA: 0s - loss: 0.0291 19/102 [====>.........................] - ETA: 0s - loss: 0.0282 25/102 [======>.......................] - ETA: 0s - loss: 0.0286 31/102 [========>.....................] - ETA: 0s - loss: 0.0279 37/102 [=========>....................] - ETA: 0s - loss: 0.0270 43/102 [===========>..................] - ETA: 0s - loss: 0.0268 50/102 [=============>................] - ETA: 0s - loss: 0.0262 56/102 [===============>..............] - ETA: 0s - loss: 0.0257 62/102 [=================>............] - ETA: 0s - loss: 0.0252 68/102 [===================>..........] - ETA: 0s - loss: 0.0249 75/102 [=====================>........] - ETA: 0s - loss: 0.0248 81/102 [======================>.......] - ETA: 0s - loss: 0.0245 87/102 [========================>.....] - ETA: 0s - loss: 0.0240 93/102 [==========================>...] - ETA: 0s - loss: 0.0244 99/102 [============================>.] - ETA: 0s - loss: 0.0248102/102 [==============================] - 1s 10ms/step - loss: 0.0246 - val_loss: 0.0158 - lr: 0.0010
Epoch 3/20
  1/102 [..............................] - ETA: 0s - loss: 0.0258  8/102 [=>............................] - ETA: 0s - loss: 0.0247 14/102 [===>..........................] - ETA: 0s - loss: 0.0216 21/102 [=====>........................] - ETA: 0s - loss: 0.0216 27/102 [======>.......................] - ETA: 0s - loss: 0.0216 33/102 [========>.....................] - ETA: 0s - loss: 0.0211 39/102 [==========>...................] - ETA: 0s - loss: 0.0213 45/102 [============>.................] - ETA: 0s - loss: 0.0212 51/102 [==============>...............] - ETA: 0s - loss: 0.0211 58/102 [================>.............] - ETA: 0s - loss: 0.0210 64/102 [=================>............] - ETA: 0s - loss: 0.0206 70/102 [===================>..........] - ETA: 0s - loss: 0.0204 77/102 [=====================>........] - ETA: 0s - loss: 0.0205 83/102 [=======================>......] - ETA: 0s - loss: 0.0205 90/102 [=========================>....] - ETA: 0s - loss: 0.0199 96/102 [===========================>..] - ETA: 0s - loss: 0.0199102/102 [==============================] - ETA: 0s - loss: 0.0198102/102 [==============================] - 1s 10ms/step - loss: 0.0198 - val_loss: 0.0095 - lr: 0.0010
Epoch 4/20
  1/102 [..............................] - ETA: 0s - loss: 0.0063  8/102 [=>............................] - ETA: 0s - loss: 0.0201 15/102 [===>..........................] - ETA: 0s - loss: 0.0213 22/102 [=====>........................] - ETA: 0s - loss: 0.0211 28/102 [=======>......................] - ETA: 0s - loss: 0.0206 34/102 [=========>....................] - ETA: 0s - loss: 0.0205 40/102 [==========>...................] - ETA: 0s - loss: 0.0199 47/102 [============>.................] - ETA: 0s - loss: 0.0195 53/102 [==============>...............] - ETA: 0s - loss: 0.0195 59/102 [================>.............] - ETA: 0s - loss: 0.0193 65/102 [==================>...........] - ETA: 0s - loss: 0.0189 71/102 [===================>..........] - ETA: 0s - loss: 0.0189 78/102 [=====================>........] - ETA: 0s - loss: 0.0185 85/102 [========================>.....] - ETA: 0s - loss: 0.0183 91/102 [=========================>....] - ETA: 0s - loss: 0.0180 97/102 [===========================>..] - ETA: 0s - loss: 0.0180102/102 [==============================] - 1s 10ms/step - loss: 0.0181 - val_loss: 0.0096 - lr: 0.0010
Epoch 5/20
  1/102 [..............................] - ETA: 0s - loss: 0.0128  7/102 [=>............................] - ETA: 0s - loss: 0.0223 13/102 [==>...........................] - ETA: 0s - loss: 0.0190 19/102 [====>.........................] - ETA: 0s - loss: 0.0189 25/102 [======>.......................] - ETA: 0s - loss: 0.0181 32/102 [========>.....................] - ETA: 0s - loss: 0.0165 38/102 [==========>...................] - ETA: 0s - loss: 0.0162 45/102 [============>.................] - ETA: 0s - loss: 0.0163 51/102 [==============>...............] - ETA: 0s - loss: 0.0158 57/102 [===============>..............] - ETA: 0s - loss: 0.0158 63/102 [=================>............] - ETA: 0s - loss: 0.0169 69/102 [===================>..........] - ETA: 0s - loss: 0.0166 75/102 [=====================>........] - ETA: 0s - loss: 0.0169 82/102 [=======================>......] - ETA: 0s - loss: 0.0166 88/102 [========================>.....] - ETA: 0s - loss: 0.0169 94/102 [==========================>...] - ETA: 0s - loss: 0.0171101/102 [============================>.] - ETA: 0s - loss: 0.0174102/102 [==============================] - 1s 10ms/step - loss: 0.0174 - val_loss: 0.0100 - lr: 0.0010
Epoch 6/20
  1/102 [..............................] - ETA: 0s - loss: 0.0468  7/102 [=>............................] - ETA: 0s - loss: 0.0193 14/102 [===>..........................] - ETA: 0s - loss: 0.0160 21/102 [=====>........................] - ETA: 0s - loss: 0.0157 27/102 [======>.......................] - ETA: 0s - loss: 0.0153 33/102 [========>.....................] - ETA: 0s - loss: 0.0144 40/102 [==========>...................] - ETA: 0s - loss: 0.0148 47/102 [============>.................] - ETA: 0s - loss: 0.0148 53/102 [==============>...............] - ETA: 0s - loss: 0.0146 59/102 [================>.............] - ETA: 0s - loss: 0.0145 65/102 [==================>...........] - ETA: 0s - loss: 0.0149 71/102 [===================>..........] - ETA: 0s - loss: 0.0148 77/102 [=====================>........] - ETA: 0s - loss: 0.0152 83/102 [=======================>......] - ETA: 0s - loss: 0.0153 89/102 [=========================>....] - ETA: 0s - loss: 0.0152 95/102 [==========================>...] - ETA: 0s - loss: 0.0157101/102 [============================>.] - ETA: 0s - loss: 0.0158102/102 [==============================] - 1s 10ms/step - loss: 0.0158 - val_loss: 0.0135 - lr: 5.0000e-04
 1/16 [>.............................] - ETA: 0s - loss: 0.030914/16 [=========================>....] - ETA: 0s - loss: 0.046216/16 [==============================] - 0s 4ms/step - loss: 0.0487
Test Loss: 0.048674099147319794
Saved model as forecasting_models_v5/model_transformer_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for TRANSFORMER model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 182ms/step
Predicted QoE for the next time step: 64.56768243602586
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/transformer_with_stats.h5
Completed at Τετ 14 Μαΐ 2025 10:17:44 μμ EEST
=====================================================
Scaler file exists at /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/scaler.save

=====================================================
All models trained successfully!
Models are saved in /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5
Training completed at Τετ 14 Μαΐ 2025 10:17:44 μμ EEST
=====================================================
