Starting training of all models at Δευ 12 Μαΐ 2025 10:20:17 μμ EEST
Models will be saved in /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5
All models will be trained with the new dataset format (default) and --use_stats flag enabled

=====================================================
Training linear model with config: basic
Starting at Δευ 12 Μαΐ 2025 10:20:17 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type linear                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 
2025-05-12 22:20:17.920100: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:20:18.100284: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:20:18.799832: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:20:18.799938: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:20:18.799953: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:20:21.792397: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:20:22.507599: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:20:22.507626: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:20:22.507770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5574 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Linear Regression model...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 1)                 226       
                                                                 
=================================================================
Total params: 226
Trainable params: 226
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 21s - loss: 0.919923/27 [========================>.....] - ETA: 0s - loss: 0.5513 27/27 [==============================] - 1s 9ms/step - loss: 0.5366 - val_loss: 0.2754 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.172822/27 [=======================>......] - ETA: 0s - loss: 0.200027/27 [==============================] - 0s 4ms/step - loss: 0.1960 - val_loss: 0.0748 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.218323/27 [========================>.....] - ETA: 0s - loss: 0.117327/27 [==============================] - 0s 4ms/step - loss: 0.1196 - val_loss: 0.0294 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.168122/27 [=======================>......] - ETA: 0s - loss: 0.099427/27 [==============================] - 0s 4ms/step - loss: 0.0999 - val_loss: 0.0150 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.082622/27 [=======================>......] - ETA: 0s - loss: 0.090727/27 [==============================] - 0s 4ms/step - loss: 0.0952 - val_loss: 0.0072 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 0s - loss: 0.108622/27 [=======================>......] - ETA: 0s - loss: 0.090027/27 [==============================] - 0s 4ms/step - loss: 0.0900 - val_loss: 0.0066 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 0s - loss: 0.046723/27 [========================>.....] - ETA: 0s - loss: 0.087127/27 [==============================] - 0s 4ms/step - loss: 0.0846 - val_loss: 0.0094 - lr: 0.0010
Epoch 8/20
 1/27 [>.............................] - ETA: 0s - loss: 0.152222/27 [=======================>......] - ETA: 0s - loss: 0.088827/27 [==============================] - 0s 4ms/step - loss: 0.0838 - val_loss: 0.0088 - lr: 0.0010
Epoch 9/20
 1/27 [>.............................] - ETA: 0s - loss: 0.057622/27 [=======================>......] - ETA: 0s - loss: 0.078527/27 [==============================] - 0s 4ms/step - loss: 0.0810 - val_loss: 0.0062 - lr: 5.0000e-04
Epoch 10/20
 1/27 [>.............................] - ETA: 0s - loss: 0.079918/27 [===================>..........] - ETA: 0s - loss: 0.087927/27 [==============================] - 0s 4ms/step - loss: 0.0780 - val_loss: 0.0068 - lr: 5.0000e-04
Epoch 11/20
 1/27 [>.............................] - ETA: 0s - loss: 0.039523/27 [========================>.....] - ETA: 0s - loss: 0.076627/27 [==============================] - 0s 4ms/step - loss: 0.0764 - val_loss: 0.0064 - lr: 5.0000e-04
Epoch 12/20
 1/27 [>.............................] - ETA: 0s - loss: 0.091924/27 [=========================>....] - ETA: 0s - loss: 0.074427/27 [==============================] - 0s 4ms/step - loss: 0.0754 - val_loss: 0.0066 - lr: 2.5000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.00625/5 [==============================] - 0s 2ms/step - loss: 0.0102
Test Loss: 0.010248619131743908
Saved model as forecasting_models_v5/model_linear_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LINEAR model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 66ms/step
Predicted QoE for the next time step: 21372.729901009214

Linear Model Feature Importance:
Traceback (most recent call last):
  File "timeseries_forecasting_models_v5.py", line 889, in <module>
    main()
  File "timeseries_forecasting_models_v5.py", line 886, in main
    print(f"{feature}: {weight[0]:.4f}")
IndexError: invalid index to scalar variable.
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/linear_basic.h5
Completed at Δευ 12 Μαΐ 2025 10:20:27 μμ EEST
=====================================================

=====================================================
Training linear model with config: with_l1_reg
Starting at Δευ 12 Μαΐ 2025 10:20:27 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type linear                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --l1_reg 0.01
2025-05-12 22:20:28.343345: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:20:28.508472: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:20:29.207522: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:20:29.207616: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:20:29.207632: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:20:32.208018: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:20:32.908039: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:20:32.908065: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:20:32.908217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5579 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Linear Regression model...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 1)                 226       
                                                                 
=================================================================
Total params: 226
Trainable params: 226
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 22s - loss: 1.290623/27 [========================>.....] - ETA: 0s - loss: 0.5907 27/27 [==============================] - 1s 9ms/step - loss: 0.5747 - val_loss: 0.3141 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.308323/27 [========================>.....] - ETA: 0s - loss: 0.317027/27 [==============================] - 0s 4ms/step - loss: 0.3174 - val_loss: 0.2992 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.304323/27 [========================>.....] - ETA: 0s - loss: 0.278227/27 [==============================] - 0s 4ms/step - loss: 0.2739 - val_loss: 0.2059 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.337522/27 [=======================>......] - ETA: 0s - loss: 0.261427/27 [==============================] - 0s 4ms/step - loss: 0.2577 - val_loss: 0.1814 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.215322/27 [=======================>......] - ETA: 0s - loss: 0.253927/27 [==============================] - 0s 4ms/step - loss: 0.2453 - val_loss: 0.1768 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 0s - loss: 0.229721/27 [======================>.......] - ETA: 0s - loss: 0.237627/27 [==============================] - 0s 4ms/step - loss: 0.2334 - val_loss: 0.1600 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 0s - loss: 0.253721/27 [======================>.......] - ETA: 0s - loss: 0.224627/27 [==============================] - 0s 4ms/step - loss: 0.2243 - val_loss: 0.1550 - lr: 0.0010
Epoch 8/20
 1/27 [>.............................] - ETA: 0s - loss: 0.197620/27 [=====================>........] - ETA: 0s - loss: 0.221027/27 [==============================] - 0s 4ms/step - loss: 0.2147 - val_loss: 0.1518 - lr: 0.0010
Epoch 9/20
 1/27 [>.............................] - ETA: 0s - loss: 0.255723/27 [========================>.....] - ETA: 0s - loss: 0.205227/27 [==============================] - 0s 4ms/step - loss: 0.2067 - val_loss: 0.1393 - lr: 0.0010
Epoch 10/20
 1/27 [>.............................] - ETA: 0s - loss: 0.211622/27 [=======================>......] - ETA: 0s - loss: 0.194727/27 [==============================] - 0s 4ms/step - loss: 0.1981 - val_loss: 0.1291 - lr: 0.0010
Epoch 11/20
 1/27 [>.............................] - ETA: 0s - loss: 0.174821/27 [======================>.......] - ETA: 0s - loss: 0.190727/27 [==============================] - 0s 4ms/step - loss: 0.1890 - val_loss: 0.1380 - lr: 0.0010
Epoch 12/20
 1/27 [>.............................] - ETA: 0s - loss: 0.173221/27 [======================>.......] - ETA: 0s - loss: 0.183827/27 [==============================] - 0s 4ms/step - loss: 0.1843 - val_loss: 0.1225 - lr: 0.0010
Epoch 13/20
 1/27 [>.............................] - ETA: 0s - loss: 0.161122/27 [=======================>......] - ETA: 0s - loss: 0.176227/27 [==============================] - 0s 4ms/step - loss: 0.1760 - val_loss: 0.1131 - lr: 0.0010
Epoch 14/20
 1/27 [>.............................] - ETA: 0s - loss: 0.174324/27 [=========================>....] - ETA: 0s - loss: 0.169227/27 [==============================] - 0s 4ms/step - loss: 0.1688 - val_loss: 0.1143 - lr: 0.0010
Epoch 15/20
 1/27 [>.............................] - ETA: 0s - loss: 0.147922/27 [=======================>......] - ETA: 0s - loss: 0.161727/27 [==============================] - 0s 4ms/step - loss: 0.1626 - val_loss: 0.1089 - lr: 0.0010
Epoch 16/20
 1/27 [>.............................] - ETA: 0s - loss: 0.156722/27 [=======================>......] - ETA: 0s - loss: 0.159627/27 [==============================] - 0s 4ms/step - loss: 0.1566 - val_loss: 0.1022 - lr: 0.0010
Epoch 17/20
 1/27 [>.............................] - ETA: 0s - loss: 0.161924/27 [=========================>....] - ETA: 0s - loss: 0.149227/27 [==============================] - 0s 4ms/step - loss: 0.1515 - val_loss: 0.0968 - lr: 0.0010
Epoch 18/20
 1/27 [>.............................] - ETA: 0s - loss: 0.122721/27 [======================>.......] - ETA: 0s - loss: 0.150727/27 [==============================] - 0s 4ms/step - loss: 0.1486 - val_loss: 0.0914 - lr: 0.0010
Epoch 19/20
 1/27 [>.............................] - ETA: 0s - loss: 0.150724/27 [=========================>....] - ETA: 0s - loss: 0.143227/27 [==============================] - 0s 4ms/step - loss: 0.1415 - val_loss: 0.0835 - lr: 0.0010
Epoch 20/20
 1/27 [>.............................] - ETA: 0s - loss: 0.101621/27 [======================>.......] - ETA: 0s - loss: 0.136027/27 [==============================] - 0s 4ms/step - loss: 0.1392 - val_loss: 0.0926 - lr: 0.0010
1/5 [=====>........................] - ETA: 0s - loss: 0.10615/5 [==============================] - 0s 2ms/step - loss: 0.1055
Test Loss: 0.10545741021633148
Saved model as forecasting_models_v5/model_linear_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LINEAR model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 67ms/step
Predicted QoE for the next time step: -2992.7673775201415

Linear Model Feature Importance:
Traceback (most recent call last):
  File "timeseries_forecasting_models_v5.py", line 889, in <module>
    main()
  File "timeseries_forecasting_models_v5.py", line 886, in main
    print(f"{feature}: {weight[0]:.4f}")
IndexError: invalid index to scalar variable.
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/linear_with_l1_reg.h5
Completed at Δευ 12 Μαΐ 2025 10:20:39 μμ EEST
=====================================================

=====================================================
Training linear model with config: with_l2_reg
Starting at Δευ 12 Μαΐ 2025 10:20:39 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type linear                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --l2_reg 0.01
2025-05-12 22:20:39.706259: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:20:39.868651: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:20:40.548816: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:20:40.548910: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:20:40.548922: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:20:43.478516: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:20:44.169242: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:20:44.169277: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:20:44.169431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5576 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Linear Regression model...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 1)                 226       
                                                                 
=================================================================
Total params: 226
Trainable params: 226
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 21s - loss: 0.340521/27 [======================>.......] - ETA: 0s - loss: 0.1929 27/27 [==============================] - 1s 9ms/step - loss: 0.1775 - val_loss: 0.0531 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.138222/27 [=======================>......] - ETA: 0s - loss: 0.120327/27 [==============================] - 0s 4ms/step - loss: 0.1260 - val_loss: 0.0320 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.084221/27 [======================>.......] - ETA: 0s - loss: 0.121527/27 [==============================] - 0s 4ms/step - loss: 0.1174 - val_loss: 0.0293 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.121624/27 [=========================>....] - ETA: 0s - loss: 0.107327/27 [==============================] - 0s 4ms/step - loss: 0.1106 - val_loss: 0.0281 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.111721/27 [======================>.......] - ETA: 0s - loss: 0.105027/27 [==============================] - 0s 4ms/step - loss: 0.1056 - val_loss: 0.0283 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 0s - loss: 0.089023/27 [========================>.....] - ETA: 0s - loss: 0.103127/27 [==============================] - 0s 4ms/step - loss: 0.1020 - val_loss: 0.0262 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 0s - loss: 0.130224/27 [=========================>....] - ETA: 0s - loss: 0.099427/27 [==============================] - 0s 4ms/step - loss: 0.0973 - val_loss: 0.0294 - lr: 0.0010
Epoch 8/20
 1/27 [>.............................] - ETA: 0s - loss: 0.091423/27 [========================>.....] - ETA: 0s - loss: 0.094327/27 [==============================] - 0s 4ms/step - loss: 0.0944 - val_loss: 0.0247 - lr: 0.0010
Epoch 9/20
 1/27 [>.............................] - ETA: 0s - loss: 0.078024/27 [=========================>....] - ETA: 0s - loss: 0.089927/27 [==============================] - 0s 4ms/step - loss: 0.0898 - val_loss: 0.0247 - lr: 0.0010
Epoch 10/20
 1/27 [>.............................] - ETA: 0s - loss: 0.069922/27 [=======================>......] - ETA: 0s - loss: 0.084727/27 [==============================] - 0s 4ms/step - loss: 0.0883 - val_loss: 0.0234 - lr: 0.0010
Epoch 11/20
 1/27 [>.............................] - ETA: 0s - loss: 0.075722/27 [=======================>......] - ETA: 0s - loss: 0.082727/27 [==============================] - 0s 4ms/step - loss: 0.0838 - val_loss: 0.0300 - lr: 0.0010
Epoch 12/20
 1/27 [>.............................] - ETA: 0s - loss: 0.070222/27 [=======================>......] - ETA: 0s - loss: 0.093527/27 [==============================] - 0s 4ms/step - loss: 0.0885 - val_loss: 0.0240 - lr: 0.0010
Epoch 13/20
 1/27 [>.............................] - ETA: 0s - loss: 0.117222/27 [=======================>......] - ETA: 0s - loss: 0.081227/27 [==============================] - 0s 4ms/step - loss: 0.0824 - val_loss: 0.0230 - lr: 5.0000e-04
Epoch 14/20
 1/27 [>.............................] - ETA: 0s - loss: 0.109623/27 [========================>.....] - ETA: 0s - loss: 0.082827/27 [==============================] - 0s 4ms/step - loss: 0.0810 - val_loss: 0.0219 - lr: 5.0000e-04
Epoch 15/20
 1/27 [>.............................] - ETA: 0s - loss: 0.058823/27 [========================>.....] - ETA: 0s - loss: 0.078927/27 [==============================] - 0s 4ms/step - loss: 0.0800 - val_loss: 0.0222 - lr: 5.0000e-04
Epoch 16/20
 1/27 [>.............................] - ETA: 0s - loss: 0.102624/27 [=========================>....] - ETA: 0s - loss: 0.080627/27 [==============================] - 0s 4ms/step - loss: 0.0788 - val_loss: 0.0221 - lr: 5.0000e-04
Epoch 17/20
 1/27 [>.............................] - ETA: 0s - loss: 0.067422/27 [=======================>......] - ETA: 0s - loss: 0.083627/27 [==============================] - 0s 4ms/step - loss: 0.0781 - val_loss: 0.0216 - lr: 2.5000e-04
Epoch 18/20
 1/27 [>.............................] - ETA: 0s - loss: 0.127122/27 [=======================>......] - ETA: 0s - loss: 0.078027/27 [==============================] - 0s 4ms/step - loss: 0.0779 - val_loss: 0.0223 - lr: 2.5000e-04
Epoch 19/20
 1/27 [>.............................] - ETA: 0s - loss: 0.054622/27 [=======================>......] - ETA: 0s - loss: 0.079327/27 [==============================] - 0s 4ms/step - loss: 0.0784 - val_loss: 0.0213 - lr: 2.5000e-04
Epoch 20/20
 1/27 [>.............................] - ETA: 0s - loss: 0.079222/27 [=======================>......] - ETA: 0s - loss: 0.077627/27 [==============================] - 0s 4ms/step - loss: 0.0771 - val_loss: 0.0211 - lr: 2.5000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.02145/5 [==============================] - 0s 2ms/step - loss: 0.0204
Test Loss: 0.020432408899068832
Saved model as forecasting_models_v5/model_linear_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LINEAR model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 68ms/step
Predicted QoE for the next time step: 17309.087719154966

Linear Model Feature Importance:
Traceback (most recent call last):
  File "timeseries_forecasting_models_v5.py", line 889, in <module>
    main()
  File "timeseries_forecasting_models_v5.py", line 886, in main
    print(f"{feature}: {weight[0]:.4f}")
IndexError: invalid index to scalar variable.
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/linear_with_l2_reg.h5
Completed at Δευ 12 Μαΐ 2025 10:20:50 μμ EEST
=====================================================

=====================================================
Training linear model with config: with_elastic_net
Starting at Δευ 12 Μαΐ 2025 10:20:50 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type linear                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --l1_reg 0.005 --l2_reg 0.005
2025-05-12 22:20:50.924154: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:20:51.087541: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:20:51.762083: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:20:51.762174: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:20:51.762186: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:20:54.678476: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:20:55.394400: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:20:55.394426: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:20:55.394590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5576 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Linear Regression model...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 1)                 226       
                                                                 
=================================================================
Total params: 226
Trainable params: 226
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 21s - loss: 0.430826/27 [===========================>..] - ETA: 0s - loss: 0.3126 27/27 [==============================] - 1s 9ms/step - loss: 0.3121 - val_loss: 0.4898 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.190125/27 [==========================>...] - ETA: 0s - loss: 0.222227/27 [==============================] - 0s 4ms/step - loss: 0.2217 - val_loss: 0.2837 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.193622/27 [=======================>......] - ETA: 0s - loss: 0.195727/27 [==============================] - 0s 4ms/step - loss: 0.1889 - val_loss: 0.1777 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.255022/27 [=======================>......] - ETA: 0s - loss: 0.175927/27 [==============================] - 0s 4ms/step - loss: 0.1787 - val_loss: 0.1580 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.154722/27 [=======================>......] - ETA: 0s - loss: 0.169027/27 [==============================] - 0s 4ms/step - loss: 0.1686 - val_loss: 0.1332 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 0s - loss: 0.225623/27 [========================>.....] - ETA: 0s - loss: 0.163127/27 [==============================] - 0s 4ms/step - loss: 0.1642 - val_loss: 0.1276 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 0s - loss: 0.141124/27 [=========================>....] - ETA: 0s - loss: 0.156827/27 [==============================] - 0s 4ms/step - loss: 0.1542 - val_loss: 0.1474 - lr: 0.0010
Epoch 8/20
 1/27 [>.............................] - ETA: 0s - loss: 0.149722/27 [=======================>......] - ETA: 0s - loss: 0.151327/27 [==============================] - 0s 4ms/step - loss: 0.1502 - val_loss: 0.1391 - lr: 0.0010
Epoch 9/20
 1/27 [>.............................] - ETA: 0s - loss: 0.147123/27 [========================>.....] - ETA: 0s - loss: 0.141727/27 [==============================] - 0s 4ms/step - loss: 0.1427 - val_loss: 0.1243 - lr: 5.0000e-04
Epoch 10/20
 1/27 [>.............................] - ETA: 0s - loss: 0.104723/27 [========================>.....] - ETA: 0s - loss: 0.139027/27 [==============================] - 0s 4ms/step - loss: 0.1400 - val_loss: 0.1234 - lr: 5.0000e-04
Epoch 11/20
 1/27 [>.............................] - ETA: 0s - loss: 0.132622/27 [=======================>......] - ETA: 0s - loss: 0.138527/27 [==============================] - 0s 4ms/step - loss: 0.1388 - val_loss: 0.1137 - lr: 5.0000e-04
Epoch 12/20
 1/27 [>.............................] - ETA: 0s - loss: 0.142623/27 [========================>.....] - ETA: 0s - loss: 0.135627/27 [==============================] - 0s 4ms/step - loss: 0.1357 - val_loss: 0.1340 - lr: 5.0000e-04
Epoch 13/20
 1/27 [>.............................] - ETA: 0s - loss: 0.139121/27 [======================>.......] - ETA: 0s - loss: 0.136627/27 [==============================] - 0s 4ms/step - loss: 0.1323 - val_loss: 0.1077 - lr: 5.0000e-04
Epoch 14/20
 1/27 [>.............................] - ETA: 0s - loss: 0.155622/27 [=======================>......] - ETA: 0s - loss: 0.131927/27 [==============================] - 0s 4ms/step - loss: 0.1307 - val_loss: 0.1152 - lr: 5.0000e-04
Epoch 15/20
 1/27 [>.............................] - ETA: 0s - loss: 0.131125/27 [==========================>...] - ETA: 0s - loss: 0.126427/27 [==============================] - 0s 4ms/step - loss: 0.1281 - val_loss: 0.1106 - lr: 5.0000e-04
Epoch 16/20
 1/27 [>.............................] - ETA: 0s - loss: 0.079922/27 [=======================>......] - ETA: 0s - loss: 0.124227/27 [==============================] - 0s 4ms/step - loss: 0.1268 - val_loss: 0.1188 - lr: 2.5000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.13225/5 [==============================] - 0s 2ms/step - loss: 0.1416
Test Loss: 0.14155808091163635
Saved model as forecasting_models_v5/model_linear_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LINEAR model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 66ms/step
Predicted QoE for the next time step: -30814.800517727046

Linear Model Feature Importance:
Traceback (most recent call last):
  File "timeseries_forecasting_models_v5.py", line 889, in <module>
    main()
  File "timeseries_forecasting_models_v5.py", line 886, in main
    print(f"{feature}: {weight[0]:.4f}")
IndexError: invalid index to scalar variable.
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/linear_with_elastic_net.h5
Completed at Δευ 12 Μαΐ 2025 10:21:01 μμ EEST
=====================================================

=====================================================
Training dnn model with config: basic
Starting at Δευ 12 Μαΐ 2025 10:21:01 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type dnn                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 
2025-05-12 22:21:01.593837: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:21:01.756879: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:21:02.406813: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:21:02.406903: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:21:02.406913: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:21:05.379342: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:21:06.053188: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:21:06.053212: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:21:06.053355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5529 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Simple DNN model...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 64)                14464     
                                                                 
 dropout (Dropout)           (None, 64)                0         
                                                                 
 dense_1 (Dense)             (None, 32)                2080      
                                                                 
 dropout_1 (Dropout)         (None, 32)                0         
                                                                 
 dense_2 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 16,577
Trainable params: 16,577
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 23s - loss: 0.265517/27 [=================>............] - ETA: 0s - loss: 0.1089 27/27 [==============================] - 1s 11ms/step - loss: 0.1027 - val_loss: 0.0057 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.050616/27 [================>.............] - ETA: 0s - loss: 0.060527/27 [==============================] - 0s 5ms/step - loss: 0.0579 - val_loss: 0.0064 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.082317/27 [=================>............] - ETA: 0s - loss: 0.055627/27 [==============================] - 0s 5ms/step - loss: 0.0585 - val_loss: 0.0098 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.048216/27 [================>.............] - ETA: 0s - loss: 0.050127/27 [==============================] - 0s 6ms/step - loss: 0.0493 - val_loss: 0.0153 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.00645/5 [==============================] - 0s 2ms/step - loss: 0.0055
Test Loss: 0.005538539960980415
Saved model as forecasting_models_v5/model_dnn_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for DNN model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 84ms/step
Predicted QoE for the next time step: 34089.875187390746
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/dnn_basic.h5
Completed at Δευ 12 Μαΐ 2025 10:21:10 μμ EEST
=====================================================

=====================================================
Training dnn model with config: deep
Starting at Δευ 12 Μαΐ 2025 10:21:10 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type dnn                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --hidden_layers 128,64,32
2025-05-12 22:21:11.290681: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:21:11.458288: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:21:12.116741: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:21:12.116840: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:21:12.116851: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:21:15.085297: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:21:15.773904: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:21:15.773927: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:21:15.774067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5529 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Simple DNN model...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 128)               28928     
                                                                 
 dropout (Dropout)           (None, 128)               0         
                                                                 
 dense_1 (Dense)             (None, 64)                8256      
                                                                 
 dropout_1 (Dropout)         (None, 64)                0         
                                                                 
 dense_2 (Dense)             (None, 32)                2080      
                                                                 
 dropout_2 (Dropout)         (None, 32)                0         
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 39,297
Trainable params: 39,297
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 26s - loss: 0.191216/27 [================>.............] - ETA: 0s - loss: 0.1010 27/27 [==============================] - 1s 12ms/step - loss: 0.0850 - val_loss: 0.0584 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.077815/27 [===============>..............] - ETA: 0s - loss: 0.057127/27 [==============================] - 0s 6ms/step - loss: 0.0568 - val_loss: 0.0651 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.068414/27 [==============>...............] - ETA: 0s - loss: 0.058327/27 [==============================] - ETA: 0s - loss: 0.057327/27 [==============================] - 0s 6ms/step - loss: 0.0573 - val_loss: 0.0917 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.053414/27 [==============>...............] - ETA: 0s - loss: 0.049827/27 [==============================] - ETA: 0s - loss: 0.052827/27 [==============================] - 0s 6ms/step - loss: 0.0528 - val_loss: 0.0489 - lr: 5.0000e-04
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.038515/27 [===============>..............] - ETA: 0s - loss: 0.046427/27 [==============================] - 0s 5ms/step - loss: 0.0456 - val_loss: 0.0226 - lr: 5.0000e-04
Epoch 6/20
 1/27 [>.............................] - ETA: 0s - loss: 0.037314/27 [==============>...............] - ETA: 0s - loss: 0.053527/27 [==============================] - ETA: 0s - loss: 0.052827/27 [==============================] - 0s 6ms/step - loss: 0.0528 - val_loss: 0.0186 - lr: 5.0000e-04
Epoch 7/20
 1/27 [>.............................] - ETA: 0s - loss: 0.031314/27 [==============>...............] - ETA: 0s - loss: 0.048227/27 [==============================] - ETA: 0s - loss: 0.047927/27 [==============================] - 0s 6ms/step - loss: 0.0479 - val_loss: 0.0262 - lr: 5.0000e-04
Epoch 8/20
 1/27 [>.............................] - ETA: 0s - loss: 0.020114/27 [==============>...............] - ETA: 0s - loss: 0.047027/27 [==============================] - ETA: 0s - loss: 0.042827/27 [==============================] - 0s 6ms/step - loss: 0.0428 - val_loss: 0.0217 - lr: 5.0000e-04
Epoch 9/20
 1/27 [>.............................] - ETA: 0s - loss: 0.050714/27 [==============>...............] - ETA: 0s - loss: 0.041126/27 [===========================>..] - ETA: 0s - loss: 0.041027/27 [==============================] - 0s 6ms/step - loss: 0.0409 - val_loss: 0.0421 - lr: 2.5000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.03185/5 [==============================] - 0s 2ms/step - loss: 0.0519
Test Loss: 0.05188967287540436
Saved model as forecasting_models_v5/model_dnn_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for DNN model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 86ms/step
Predicted QoE for the next time step: 36648.98569544739
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/dnn_deep.h5
Completed at Δευ 12 Μαΐ 2025 10:21:21 μμ EEST
=====================================================

=====================================================
Training dnn model with config: with_elu
Starting at Δευ 12 Μαΐ 2025 10:21:21 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type dnn                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --activation elu
2025-05-12 22:21:21.983013: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:21:22.155033: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:21:22.773916: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:21:22.774005: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:21:22.774015: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:21:25.794022: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:21:26.496057: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:21:26.496083: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:21:26.496215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5529 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Simple DNN model...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 64)                14464     
                                                                 
 dropout (Dropout)           (None, 64)                0         
                                                                 
 dense_1 (Dense)             (None, 32)                2080      
                                                                 
 dropout_1 (Dropout)         (None, 32)                0         
                                                                 
 dense_2 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 16,577
Trainable params: 16,577
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 25s - loss: 0.431018/27 [===================>..........] - ETA: 0s - loss: 0.2142 27/27 [==============================] - 1s 10ms/step - loss: 0.1927 - val_loss: 0.0084 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.091319/27 [====================>.........] - ETA: 0s - loss: 0.110427/27 [==============================] - 0s 4ms/step - loss: 0.1038 - val_loss: 0.0056 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.169717/27 [=================>............] - ETA: 0s - loss: 0.104027/27 [==============================] - 0s 5ms/step - loss: 0.1017 - val_loss: 0.0057 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.116616/27 [================>.............] - ETA: 0s - loss: 0.080127/27 [==============================] - 0s 5ms/step - loss: 0.0796 - val_loss: 0.0070 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.101116/27 [================>.............] - ETA: 0s - loss: 0.066227/27 [==============================] - 0s 6ms/step - loss: 0.0627 - val_loss: 0.0186 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.01395/5 [==============================] - 0s 2ms/step - loss: 0.0165
Test Loss: 0.016527535393834114
Saved model as forecasting_models_v5/model_dnn_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for DNN model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 87ms/step
Predicted QoE for the next time step: -21441.922394181212
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/dnn_with_elu.h5
Completed at Δευ 12 Μαΐ 2025 10:21:31 μμ EEST
=====================================================

=====================================================
Training dnn model with config: with_high_dropout
Starting at Δευ 12 Μαΐ 2025 10:21:31 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type dnn                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --dropout_rate 0.4
2025-05-12 22:21:31.908191: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:21:32.070809: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:21:32.753081: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:21:32.753169: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:21:32.753180: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:21:35.730182: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:21:36.455942: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:21:36.455971: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:21:36.456140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5529 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Simple DNN model...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense (Dense)               (None, 64)                14464     
                                                                 
 dropout (Dropout)           (None, 64)                0         
                                                                 
 dense_1 (Dense)             (None, 32)                2080      
                                                                 
 dropout_1 (Dropout)         (None, 32)                0         
                                                                 
 dense_2 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 16,577
Trainable params: 16,577
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 25s - loss: 0.326616/27 [================>.............] - ETA: 0s - loss: 0.1533 27/27 [==============================] - 1s 11ms/step - loss: 0.1377 - val_loss: 0.0585 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.099117/27 [=================>............] - ETA: 0s - loss: 0.088927/27 [==============================] - 0s 5ms/step - loss: 0.0882 - val_loss: 0.0395 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.048416/27 [================>.............] - ETA: 0s - loss: 0.073127/27 [==============================] - 0s 5ms/step - loss: 0.0721 - val_loss: 0.0190 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.059916/27 [================>.............] - ETA: 0s - loss: 0.074627/27 [==============================] - 0s 5ms/step - loss: 0.0725 - val_loss: 0.0336 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.067715/27 [===============>..............] - ETA: 0s - loss: 0.066327/27 [==============================] - 0s 5ms/step - loss: 0.0681 - val_loss: 0.0523 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 0s - loss: 0.048216/27 [================>.............] - ETA: 0s - loss: 0.057827/27 [==============================] - 0s 6ms/step - loss: 0.0570 - val_loss: 0.0554 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.02775/5 [==============================] - 0s 2ms/step - loss: 0.0493
Test Loss: 0.04933196306228638
Saved model as forecasting_models_v5/model_dnn_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for DNN model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 84ms/step
Predicted QoE for the next time step: 16570.984077696838
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/dnn_with_high_dropout.h5
Completed at Δευ 12 Μαΐ 2025 10:21:41 μμ EEST
=====================================================

=====================================================
Training lstm model with config: basic
Starting at Δευ 12 Μαΐ 2025 10:21:41 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type lstm                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --attention_units 128
2025-05-12 22:21:42.060508: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:21:42.221650: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:21:42.902410: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:21:42.902499: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:21:42.902510: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:21:45.861304: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:21:46.563631: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:21:46.563657: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:21:46.563803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5529 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building LSTM model with self-attention...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 5, 50)             19200     
                                                                 
 lstm_1 (LSTM)               (None, 5, 50)             20200     
                                                                 
 self_attention (SelfAttenti  (None, 50)               6656      
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                1275      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 47,357
Trainable params: 47,357
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 2:02 - loss: 0.2832 2/27 [=>............................] - ETA: 1s - loss: 0.2357   3/27 [==>...........................] - ETA: 1s - loss: 0.2387 5/27 [====>.........................] - ETA: 1s - loss: 0.2240 7/27 [======>.......................] - ETA: 0s - loss: 0.2097 8/27 [=======>......................] - ETA: 0s - loss: 0.199510/27 [==========>...................] - ETA: 0s - loss: 0.183112/27 [============>.................] - ETA: 0s - loss: 0.166714/27 [==============>...............] - ETA: 0s - loss: 0.151615/27 [===============>..............] - ETA: 0s - loss: 0.146916/27 [================>.............] - ETA: 0s - loss: 0.140518/27 [===================>..........] - ETA: 0s - loss: 0.131719/27 [====================>.........] - ETA: 0s - loss: 0.131421/27 [======================>.......] - ETA: 0s - loss: 0.125422/27 [=======================>......] - ETA: 0s - loss: 0.121523/27 [========================>.....] - ETA: 0s - loss: 0.118124/27 [=========================>....] - ETA: 0s - loss: 0.114825/27 [==========================>...] - ETA: 0s - loss: 0.112026/27 [===========================>..] - ETA: 0s - loss: 0.109727/27 [==============================] - ETA: 0s - loss: 0.109427/27 [==============================] - 7s 77ms/step - loss: 0.1094 - val_loss: 0.0512 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0619 2/27 [=>............................] - ETA: 1s - loss: 0.0627 3/27 [==>...........................] - ETA: 1s - loss: 0.0589 5/27 [====>.........................] - ETA: 1s - loss: 0.0572 6/27 [=====>........................] - ETA: 1s - loss: 0.0553 8/27 [=======>......................] - ETA: 0s - loss: 0.0543 9/27 [=========>....................] - ETA: 0s - loss: 0.053110/27 [==========>...................] - ETA: 0s - loss: 0.050711/27 [===========>..................] - ETA: 0s - loss: 0.049112/27 [============>.................] - ETA: 0s - loss: 0.046613/27 [=============>................] - ETA: 0s - loss: 0.045114/27 [==============>...............] - ETA: 0s - loss: 0.045515/27 [===============>..............] - ETA: 0s - loss: 0.044916/27 [================>.............] - ETA: 0s - loss: 0.043617/27 [=================>............] - ETA: 0s - loss: 0.041818/27 [===================>..........] - ETA: 0s - loss: 0.041119/27 [====================>.........] - ETA: 0s - loss: 0.040820/27 [=====================>........] - ETA: 0s - loss: 0.040822/27 [=======================>......] - ETA: 0s - loss: 0.042523/27 [========================>.....] - ETA: 0s - loss: 0.042924/27 [=========================>....] - ETA: 0s - loss: 0.043325/27 [==========================>...] - ETA: 0s - loss: 0.042826/27 [===========================>..] - ETA: 0s - loss: 0.042327/27 [==============================] - ETA: 0s - loss: 0.042227/27 [==============================] - 2s 58ms/step - loss: 0.0422 - val_loss: 0.0131 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0325 2/27 [=>............................] - ETA: 1s - loss: 0.0279 3/27 [==>...........................] - ETA: 1s - loss: 0.0287 4/27 [===>..........................] - ETA: 1s - loss: 0.0294 5/27 [====>.........................] - ETA: 1s - loss: 0.0375 6/27 [=====>........................] - ETA: 1s - loss: 0.0417 7/27 [======>.......................] - ETA: 1s - loss: 0.0402 8/27 [=======>......................] - ETA: 1s - loss: 0.0406 9/27 [=========>....................] - ETA: 0s - loss: 0.038310/27 [==========>...................] - ETA: 0s - loss: 0.036111/27 [===========>..................] - ETA: 0s - loss: 0.035712/27 [============>.................] - ETA: 0s - loss: 0.036113/27 [=============>................] - ETA: 0s - loss: 0.037015/27 [===============>..............] - ETA: 0s - loss: 0.035216/27 [================>.............] - ETA: 0s - loss: 0.035217/27 [=================>............] - ETA: 0s - loss: 0.036118/27 [===================>..........] - ETA: 0s - loss: 0.037819/27 [====================>.........] - ETA: 0s - loss: 0.037320/27 [=====================>........] - ETA: 0s - loss: 0.037321/27 [======================>.......] - ETA: 0s - loss: 0.037322/27 [=======================>......] - ETA: 0s - loss: 0.037123/27 [========================>.....] - ETA: 0s - loss: 0.036825/27 [==========================>...] - ETA: 0s - loss: 0.037526/27 [===========================>..] - ETA: 0s - loss: 0.036827/27 [==============================] - ETA: 0s - loss: 0.036827/27 [==============================] - 2s 58ms/step - loss: 0.0368 - val_loss: 0.0021 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0238 2/27 [=>............................] - ETA: 1s - loss: 0.0232 4/27 [===>..........................] - ETA: 1s - loss: 0.0316 5/27 [====>.........................] - ETA: 1s - loss: 0.0339 6/27 [=====>........................] - ETA: 1s - loss: 0.0327 7/27 [======>.......................] - ETA: 1s - loss: 0.0310 8/27 [=======>......................] - ETA: 1s - loss: 0.0282 9/27 [=========>....................] - ETA: 0s - loss: 0.027110/27 [==========>...................] - ETA: 0s - loss: 0.030111/27 [===========>..................] - ETA: 0s - loss: 0.031112/27 [============>.................] - ETA: 0s - loss: 0.031213/27 [=============>................] - ETA: 0s - loss: 0.030814/27 [==============>...............] - ETA: 0s - loss: 0.033115/27 [===============>..............] - ETA: 0s - loss: 0.031817/27 [=================>............] - ETA: 0s - loss: 0.033818/27 [===================>..........] - ETA: 0s - loss: 0.033719/27 [====================>.........] - ETA: 0s - loss: 0.033320/27 [=====================>........] - ETA: 0s - loss: 0.033221/27 [======================>.......] - ETA: 0s - loss: 0.033823/27 [========================>.....] - ETA: 0s - loss: 0.033525/27 [==========================>...] - ETA: 0s - loss: 0.033726/27 [===========================>..] - ETA: 0s - loss: 0.034227/27 [==============================] - ETA: 0s - loss: 0.034227/27 [==============================] - 2s 57ms/step - loss: 0.0342 - val_loss: 3.6271e-04 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0317 2/27 [=>............................] - ETA: 1s - loss: 0.0288 4/27 [===>..........................] - ETA: 1s - loss: 0.0282 5/27 [====>.........................] - ETA: 1s - loss: 0.0336 6/27 [=====>........................] - ETA: 1s - loss: 0.0385 7/27 [======>.......................] - ETA: 1s - loss: 0.0370 8/27 [=======>......................] - ETA: 1s - loss: 0.0374 9/27 [=========>....................] - ETA: 0s - loss: 0.039111/27 [===========>..................] - ETA: 0s - loss: 0.037512/27 [============>.................] - ETA: 0s - loss: 0.037313/27 [=============>................] - ETA: 0s - loss: 0.037514/27 [==============>...............] - ETA: 0s - loss: 0.036615/27 [===============>..............] - ETA: 0s - loss: 0.036516/27 [================>.............] - ETA: 0s - loss: 0.036418/27 [===================>..........] - ETA: 0s - loss: 0.037419/27 [====================>.........] - ETA: 0s - loss: 0.036421/27 [======================>.......] - ETA: 0s - loss: 0.037122/27 [=======================>......] - ETA: 0s - loss: 0.036423/27 [========================>.....] - ETA: 0s - loss: 0.035724/27 [=========================>....] - ETA: 0s - loss: 0.035725/27 [==========================>...] - ETA: 0s - loss: 0.035626/27 [===========================>..] - ETA: 0s - loss: 0.035827/27 [==============================] - ETA: 0s - loss: 0.035727/27 [==============================] - 2s 58ms/step - loss: 0.0357 - val_loss: 0.0046 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0164 2/27 [=>............................] - ETA: 1s - loss: 0.0320 3/27 [==>...........................] - ETA: 1s - loss: 0.0293 4/27 [===>..........................] - ETA: 1s - loss: 0.0405 5/27 [====>.........................] - ETA: 1s - loss: 0.0452 6/27 [=====>........................] - ETA: 1s - loss: 0.0428 7/27 [======>.......................] - ETA: 1s - loss: 0.0383 8/27 [=======>......................] - ETA: 1s - loss: 0.037310/27 [==========>...................] - ETA: 0s - loss: 0.037811/27 [===========>..................] - ETA: 0s - loss: 0.036312/27 [============>.................] - ETA: 0s - loss: 0.037913/27 [=============>................] - ETA: 0s - loss: 0.037114/27 [==============>...............] - ETA: 0s - loss: 0.036215/27 [===============>..............] - ETA: 0s - loss: 0.035416/27 [================>.............] - ETA: 0s - loss: 0.034717/27 [=================>............] - ETA: 0s - loss: 0.034819/27 [====================>.........] - ETA: 0s - loss: 0.034320/27 [=====================>........] - ETA: 0s - loss: 0.034721/27 [======================>.......] - ETA: 0s - loss: 0.034622/27 [=======================>......] - ETA: 0s - loss: 0.034123/27 [========================>.....] - ETA: 0s - loss: 0.034424/27 [=========================>....] - ETA: 0s - loss: 0.036825/27 [==========================>...] - ETA: 0s - loss: 0.036726/27 [===========================>..] - ETA: 0s - loss: 0.037327/27 [==============================] - ETA: 0s - loss: 0.037227/27 [==============================] - 2s 59ms/step - loss: 0.0372 - val_loss: 2.4295e-04 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0393 2/27 [=>............................] - ETA: 1s - loss: 0.0401 4/27 [===>..........................] - ETA: 1s - loss: 0.0342 5/27 [====>.........................] - ETA: 1s - loss: 0.0304 6/27 [=====>........................] - ETA: 1s - loss: 0.0317 7/27 [======>.......................] - ETA: 1s - loss: 0.0322 9/27 [=========>....................] - ETA: 0s - loss: 0.031610/27 [==========>...................] - ETA: 0s - loss: 0.029611/27 [===========>..................] - ETA: 0s - loss: 0.029712/27 [============>.................] - ETA: 0s - loss: 0.031913/27 [=============>................] - ETA: 0s - loss: 0.030914/27 [==============>...............] - ETA: 0s - loss: 0.032615/27 [===============>..............] - ETA: 0s - loss: 0.032616/27 [================>.............] - ETA: 0s - loss: 0.032017/27 [=================>............] - ETA: 0s - loss: 0.033418/27 [===================>..........] - ETA: 0s - loss: 0.032419/27 [====================>.........] - ETA: 0s - loss: 0.032820/27 [=====================>........] - ETA: 0s - loss: 0.032321/27 [======================>.......] - ETA: 0s - loss: 0.031722/27 [=======================>......] - ETA: 0s - loss: 0.031323/27 [========================>.....] - ETA: 0s - loss: 0.032324/27 [=========================>....] - ETA: 0s - loss: 0.032825/27 [==========================>...] - ETA: 0s - loss: 0.033726/27 [===========================>..] - ETA: 0s - loss: 0.033927/27 [==============================] - 2s 58ms/step - loss: 0.0340 - val_loss: 2.7072e-04 - lr: 0.0010
Epoch 8/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0175 2/27 [=>............................] - ETA: 1s - loss: 0.0191 3/27 [==>...........................] - ETA: 1s - loss: 0.0254 4/27 [===>..........................] - ETA: 1s - loss: 0.0276 5/27 [====>.........................] - ETA: 1s - loss: 0.0305 6/27 [=====>........................] - ETA: 1s - loss: 0.0305 7/27 [======>.......................] - ETA: 1s - loss: 0.0270 8/27 [=======>......................] - ETA: 1s - loss: 0.0269 9/27 [=========>....................] - ETA: 0s - loss: 0.028910/27 [==========>...................] - ETA: 0s - loss: 0.028211/27 [===========>..................] - ETA: 0s - loss: 0.030712/27 [============>.................] - ETA: 0s - loss: 0.033513/27 [=============>................] - ETA: 0s - loss: 0.036814/27 [==============>...............] - ETA: 0s - loss: 0.036415/27 [===============>..............] - ETA: 0s - loss: 0.036917/27 [=================>............] - ETA: 0s - loss: 0.038619/27 [====================>.........] - ETA: 0s - loss: 0.037720/27 [=====================>........] - ETA: 0s - loss: 0.037621/27 [======================>.......] - ETA: 0s - loss: 0.037022/27 [=======================>......] - ETA: 0s - loss: 0.037223/27 [========================>.....] - ETA: 0s - loss: 0.036724/27 [=========================>....] - ETA: 0s - loss: 0.036625/27 [==========================>...] - ETA: 0s - loss: 0.036726/27 [===========================>..] - ETA: 0s - loss: 0.036827/27 [==============================] - 2s 57ms/step - loss: 0.0366 - val_loss: 0.0024 - lr: 0.0010
Epoch 9/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0528 2/27 [=>............................] - ETA: 1s - loss: 0.0527 3/27 [==>...........................] - ETA: 1s - loss: 0.0442 4/27 [===>..........................] - ETA: 1s - loss: 0.0441 5/27 [====>.........................] - ETA: 1s - loss: 0.0432 6/27 [=====>........................] - ETA: 1s - loss: 0.0391 7/27 [======>.......................] - ETA: 1s - loss: 0.0397 9/27 [=========>....................] - ETA: 0s - loss: 0.037810/27 [==========>...................] - ETA: 0s - loss: 0.035512/27 [============>.................] - ETA: 0s - loss: 0.034013/27 [=============>................] - ETA: 0s - loss: 0.034314/27 [==============>...............] - ETA: 0s - loss: 0.035315/27 [===============>..............] - ETA: 0s - loss: 0.035216/27 [================>.............] - ETA: 0s - loss: 0.035218/27 [===================>..........] - ETA: 0s - loss: 0.035320/27 [=====================>........] - ETA: 0s - loss: 0.035521/27 [======================>.......] - ETA: 0s - loss: 0.035022/27 [=======================>......] - ETA: 0s - loss: 0.035623/27 [========================>.....] - ETA: 0s - loss: 0.035124/27 [=========================>....] - ETA: 0s - loss: 0.035225/27 [==========================>...] - ETA: 0s - loss: 0.034626/27 [===========================>..] - ETA: 0s - loss: 0.034427/27 [==============================] - 2s 59ms/step - loss: 0.0344 - val_loss: 7.8438e-04 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 2.5337e-045/5 [==============================] - 0s 11ms/step - loss: 3.7312e-04
Test Loss: 0.00037311689811758697
Saved model as forecasting_models_v5/model_lstm_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LSTM model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 532ms/step
Predicted QoE for the next time step: 94.44891852042318
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/lstm_basic.h5
Completed at Δευ 12 Μαΐ 2025 10:22:09 μμ EEST
=====================================================

=====================================================
Training lstm model with config: deep
Starting at Δευ 12 Μαΐ 2025 10:22:09 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type lstm                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --num_layers 3 --attention_units 128
2025-05-12 22:22:10.307000: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:22:10.468403: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:22:11.087359: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:22:11.087444: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:22:11.087455: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:22:14.028241: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:22:14.747462: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:22:14.747487: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:22:14.747638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5529 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building LSTM model with self-attention...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 5, 50)             19200     
                                                                 
 lstm_1 (LSTM)               (None, 5, 50)             20200     
                                                                 
 lstm_2 (LSTM)               (None, 5, 50)             20200     
                                                                 
 self_attention (SelfAttenti  (None, 50)               6656      
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                1275      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 67,557
Trainable params: 67,557
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 3:00 - loss: 0.2574 2/27 [=>............................] - ETA: 1s - loss: 0.2592   3/27 [==>...........................] - ETA: 1s - loss: 0.2633 4/27 [===>..........................] - ETA: 1s - loss: 0.2808 5/27 [====>.........................] - ETA: 1s - loss: 0.2872 6/27 [=====>........................] - ETA: 1s - loss: 0.2883 7/27 [======>.......................] - ETA: 1s - loss: 0.2840 8/27 [=======>......................] - ETA: 1s - loss: 0.2821 9/27 [=========>....................] - ETA: 1s - loss: 0.279010/27 [==========>...................] - ETA: 1s - loss: 0.276311/27 [===========>..................] - ETA: 1s - loss: 0.268512/27 [============>.................] - ETA: 1s - loss: 0.256813/27 [=============>................] - ETA: 1s - loss: 0.246914/27 [==============>...............] - ETA: 0s - loss: 0.239015/27 [===============>..............] - ETA: 0s - loss: 0.229916/27 [================>.............] - ETA: 0s - loss: 0.220417/27 [=================>............] - ETA: 0s - loss: 0.211918/27 [===================>..........] - ETA: 0s - loss: 0.202419/27 [====================>.........] - ETA: 0s - loss: 0.194320/27 [=====================>........] - ETA: 0s - loss: 0.189121/27 [======================>.......] - ETA: 0s - loss: 0.183622/27 [=======================>......] - ETA: 0s - loss: 0.177823/27 [========================>.....] - ETA: 0s - loss: 0.175724/27 [=========================>....] - ETA: 0s - loss: 0.171925/27 [==========================>...] - ETA: 0s - loss: 0.167126/27 [===========================>..] - ETA: 0s - loss: 0.161827/27 [==============================] - ETA: 0s - loss: 0.161127/27 [==============================] - 10s 113ms/step - loss: 0.1611 - val_loss: 0.0712 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0496 2/27 [=>............................] - ETA: 1s - loss: 0.0558 3/27 [==>...........................] - ETA: 1s - loss: 0.0567 4/27 [===>..........................] - ETA: 1s - loss: 0.0596 5/27 [====>.........................] - ETA: 1s - loss: 0.0616 6/27 [=====>........................] - ETA: 1s - loss: 0.0594 7/27 [======>.......................] - ETA: 1s - loss: 0.0594 8/27 [=======>......................] - ETA: 1s - loss: 0.0593 9/27 [=========>....................] - ETA: 1s - loss: 0.058010/27 [==========>...................] - ETA: 1s - loss: 0.058911/27 [===========>..................] - ETA: 1s - loss: 0.056612/27 [============>.................] - ETA: 1s - loss: 0.056613/27 [=============>................] - ETA: 1s - loss: 0.054114/27 [==============>...............] - ETA: 0s - loss: 0.054815/27 [===============>..............] - ETA: 0s - loss: 0.055516/27 [================>.............] - ETA: 0s - loss: 0.054117/27 [=================>............] - ETA: 0s - loss: 0.053118/27 [===================>..........] - ETA: 0s - loss: 0.051919/27 [====================>.........] - ETA: 0s - loss: 0.051620/27 [=====================>........] - ETA: 0s - loss: 0.051221/27 [======================>.......] - ETA: 0s - loss: 0.050222/27 [=======================>......] - ETA: 0s - loss: 0.049523/27 [========================>.....] - ETA: 0s - loss: 0.048524/27 [=========================>....] - ETA: 0s - loss: 0.048125/27 [==========================>...] - ETA: 0s - loss: 0.047526/27 [===========================>..] - ETA: 0s - loss: 0.047427/27 [==============================] - ETA: 0s - loss: 0.047827/27 [==============================] - 2s 79ms/step - loss: 0.0478 - val_loss: 0.0142 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 2s - loss: 0.0214 2/27 [=>............................] - ETA: 1s - loss: 0.0267 3/27 [==>...........................] - ETA: 1s - loss: 0.0239 4/27 [===>..........................] - ETA: 1s - loss: 0.0254 5/27 [====>.........................] - ETA: 1s - loss: 0.0233 6/27 [=====>........................] - ETA: 1s - loss: 0.0301 7/27 [======>.......................] - ETA: 1s - loss: 0.0287 8/27 [=======>......................] - ETA: 1s - loss: 0.0313 9/27 [=========>....................] - ETA: 1s - loss: 0.030410/27 [==========>...................] - ETA: 1s - loss: 0.031911/27 [===========>..................] - ETA: 1s - loss: 0.034312/27 [============>.................] - ETA: 1s - loss: 0.035113/27 [=============>................] - ETA: 1s - loss: 0.035814/27 [==============>...............] - ETA: 1s - loss: 0.038015/27 [===============>..............] - ETA: 0s - loss: 0.038116/27 [================>.............] - ETA: 0s - loss: 0.039017/27 [=================>............] - ETA: 0s - loss: 0.039318/27 [===================>..........] - ETA: 0s - loss: 0.038519/27 [====================>.........] - ETA: 0s - loss: 0.039720/27 [=====================>........] - ETA: 0s - loss: 0.038921/27 [======================>.......] - ETA: 0s - loss: 0.039322/27 [=======================>......] - ETA: 0s - loss: 0.038223/27 [========================>.....] - ETA: 0s - loss: 0.037624/27 [=========================>....] - ETA: 0s - loss: 0.038025/27 [==========================>...] - ETA: 0s - loss: 0.037826/27 [===========================>..] - ETA: 0s - loss: 0.037427/27 [==============================] - ETA: 0s - loss: 0.037427/27 [==============================] - 2s 80ms/step - loss: 0.0374 - val_loss: 0.0017 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0276 2/27 [=>............................] - ETA: 1s - loss: 0.0204 3/27 [==>...........................] - ETA: 1s - loss: 0.0274 4/27 [===>..........................] - ETA: 1s - loss: 0.0265 5/27 [====>.........................] - ETA: 1s - loss: 0.0394 6/27 [=====>........................] - ETA: 1s - loss: 0.0383 7/27 [======>.......................] - ETA: 1s - loss: 0.0389 8/27 [=======>......................] - ETA: 1s - loss: 0.0420 9/27 [=========>....................] - ETA: 1s - loss: 0.041110/27 [==========>...................] - ETA: 1s - loss: 0.038811/27 [===========>..................] - ETA: 1s - loss: 0.039112/27 [============>.................] - ETA: 1s - loss: 0.039313/27 [=============>................] - ETA: 1s - loss: 0.038114/27 [==============>...............] - ETA: 0s - loss: 0.036815/27 [===============>..............] - ETA: 0s - loss: 0.036016/27 [================>.............] - ETA: 0s - loss: 0.036317/27 [=================>............] - ETA: 0s - loss: 0.035918/27 [===================>..........] - ETA: 0s - loss: 0.035319/27 [====================>.........] - ETA: 0s - loss: 0.035120/27 [=====================>........] - ETA: 0s - loss: 0.034621/27 [======================>.......] - ETA: 0s - loss: 0.034322/27 [=======================>......] - ETA: 0s - loss: 0.034423/27 [========================>.....] - ETA: 0s - loss: 0.033824/27 [=========================>....] - ETA: 0s - loss: 0.033325/27 [==========================>...] - ETA: 0s - loss: 0.032926/27 [===========================>..] - ETA: 0s - loss: 0.033027/27 [==============================] - ETA: 0s - loss: 0.033527/27 [==============================] - 2s 80ms/step - loss: 0.0335 - val_loss: 0.0031 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0427 2/27 [=>............................] - ETA: 2s - loss: 0.0310 3/27 [==>...........................] - ETA: 1s - loss: 0.0361 4/27 [===>..........................] - ETA: 1s - loss: 0.0373 5/27 [====>.........................] - ETA: 1s - loss: 0.0365 6/27 [=====>........................] - ETA: 1s - loss: 0.0361 7/27 [======>.......................] - ETA: 1s - loss: 0.0370 8/27 [=======>......................] - ETA: 1s - loss: 0.0357 9/27 [=========>....................] - ETA: 1s - loss: 0.034910/27 [==========>...................] - ETA: 1s - loss: 0.033711/27 [===========>..................] - ETA: 1s - loss: 0.034212/27 [============>.................] - ETA: 1s - loss: 0.032913/27 [=============>................] - ETA: 1s - loss: 0.033514/27 [==============>...............] - ETA: 1s - loss: 0.033415/27 [===============>..............] - ETA: 0s - loss: 0.035416/27 [================>.............] - ETA: 0s - loss: 0.034917/27 [=================>............] - ETA: 0s - loss: 0.035418/27 [===================>..........] - ETA: 0s - loss: 0.035819/27 [====================>.........] - ETA: 0s - loss: 0.036620/27 [=====================>........] - ETA: 0s - loss: 0.036321/27 [======================>.......] - ETA: 0s - loss: 0.036122/27 [=======================>......] - ETA: 0s - loss: 0.035723/27 [========================>.....] - ETA: 0s - loss: 0.035124/27 [=========================>....] - ETA: 0s - loss: 0.034325/27 [==========================>...] - ETA: 0s - loss: 0.034326/27 [===========================>..] - ETA: 0s - loss: 0.035927/27 [==============================] - ETA: 0s - loss: 0.035827/27 [==============================] - 2s 81ms/step - loss: 0.0358 - val_loss: 2.6303e-04 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0272 2/27 [=>............................] - ETA: 1s - loss: 0.0278 3/27 [==>...........................] - ETA: 1s - loss: 0.0239 4/27 [===>..........................] - ETA: 1s - loss: 0.0242 5/27 [====>.........................] - ETA: 1s - loss: 0.0252 6/27 [=====>........................] - ETA: 1s - loss: 0.0304 7/27 [======>.......................] - ETA: 1s - loss: 0.0340 8/27 [=======>......................] - ETA: 1s - loss: 0.0364 9/27 [=========>....................] - ETA: 1s - loss: 0.036710/27 [==========>...................] - ETA: 1s - loss: 0.037711/27 [===========>..................] - ETA: 1s - loss: 0.036612/27 [============>.................] - ETA: 1s - loss: 0.037413/27 [=============>................] - ETA: 1s - loss: 0.037914/27 [==============>...............] - ETA: 0s - loss: 0.037515/27 [===============>..............] - ETA: 0s - loss: 0.035716/27 [================>.............] - ETA: 0s - loss: 0.035717/27 [=================>............] - ETA: 0s - loss: 0.036118/27 [===================>..........] - ETA: 0s - loss: 0.035719/27 [====================>.........] - ETA: 0s - loss: 0.036020/27 [=====================>........] - ETA: 0s - loss: 0.035321/27 [======================>.......] - ETA: 0s - loss: 0.035222/27 [=======================>......] - ETA: 0s - loss: 0.035923/27 [========================>.....] - ETA: 0s - loss: 0.035724/27 [=========================>....] - ETA: 0s - loss: 0.035225/27 [==========================>...] - ETA: 0s - loss: 0.035226/27 [===========================>..] - ETA: 0s - loss: 0.034527/27 [==============================] - ETA: 0s - loss: 0.034427/27 [==============================] - 2s 80ms/step - loss: 0.0344 - val_loss: 0.0028 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0433 2/27 [=>............................] - ETA: 1s - loss: 0.0329 3/27 [==>...........................] - ETA: 1s - loss: 0.0286 4/27 [===>..........................] - ETA: 1s - loss: 0.0334 5/27 [====>.........................] - ETA: 1s - loss: 0.0305 6/27 [=====>........................] - ETA: 1s - loss: 0.0289 7/27 [======>.......................] - ETA: 1s - loss: 0.0284 8/27 [=======>......................] - ETA: 1s - loss: 0.0280 9/27 [=========>....................] - ETA: 1s - loss: 0.027810/27 [==========>...................] - ETA: 1s - loss: 0.029011/27 [===========>..................] - ETA: 1s - loss: 0.030212/27 [============>.................] - ETA: 1s - loss: 0.029413/27 [=============>................] - ETA: 1s - loss: 0.028714/27 [==============>...............] - ETA: 0s - loss: 0.029615/27 [===============>..............] - ETA: 0s - loss: 0.029716/27 [================>.............] - ETA: 0s - loss: 0.029017/27 [=================>............] - ETA: 0s - loss: 0.029318/27 [===================>..........] - ETA: 0s - loss: 0.029119/27 [====================>.........] - ETA: 0s - loss: 0.028820/27 [=====================>........] - ETA: 0s - loss: 0.031521/27 [======================>.......] - ETA: 0s - loss: 0.031922/27 [=======================>......] - ETA: 0s - loss: 0.031323/27 [========================>.....] - ETA: 0s - loss: 0.031424/27 [=========================>....] - ETA: 0s - loss: 0.032625/27 [==========================>...] - ETA: 0s - loss: 0.033426/27 [===========================>..] - ETA: 0s - loss: 0.034327/27 [==============================] - ETA: 0s - loss: 0.034327/27 [==============================] - 2s 81ms/step - loss: 0.0343 - val_loss: 0.0018 - lr: 0.0010
Epoch 8/20
 1/27 [>.............................] - ETA: 2s - loss: 0.0367 2/27 [=>............................] - ETA: 1s - loss: 0.0402 3/27 [==>...........................] - ETA: 1s - loss: 0.0392 4/27 [===>..........................] - ETA: 1s - loss: 0.0400 5/27 [====>.........................] - ETA: 1s - loss: 0.0391 6/27 [=====>........................] - ETA: 1s - loss: 0.0386 7/27 [======>.......................] - ETA: 1s - loss: 0.0396 8/27 [=======>......................] - ETA: 1s - loss: 0.0388 9/27 [=========>....................] - ETA: 1s - loss: 0.036010/27 [==========>...................] - ETA: 1s - loss: 0.034311/27 [===========>..................] - ETA: 1s - loss: 0.032612/27 [============>.................] - ETA: 1s - loss: 0.034713/27 [=============>................] - ETA: 1s - loss: 0.036114/27 [==============>...............] - ETA: 0s - loss: 0.034615/27 [===============>..............] - ETA: 0s - loss: 0.034116/27 [================>.............] - ETA: 0s - loss: 0.033417/27 [=================>............] - ETA: 0s - loss: 0.034318/27 [===================>..........] - ETA: 0s - loss: 0.034219/27 [====================>.........] - ETA: 0s - loss: 0.034420/27 [=====================>........] - ETA: 0s - loss: 0.035621/27 [======================>.......] - ETA: 0s - loss: 0.034822/27 [=======================>......] - ETA: 0s - loss: 0.035523/27 [========================>.....] - ETA: 0s - loss: 0.035324/27 [=========================>....] - ETA: 0s - loss: 0.034625/27 [==========================>...] - ETA: 0s - loss: 0.034726/27 [===========================>..] - ETA: 0s - loss: 0.033927/27 [==============================] - ETA: 0s - loss: 0.034227/27 [==============================] - 2s 81ms/step - loss: 0.0342 - val_loss: 4.0282e-04 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 4.0049e-045/5 [==============================] - ETA: 0s - loss: 9.7098e-045/5 [==============================] - 0s 15ms/step - loss: 9.7098e-04
Test Loss: 0.0009709819569252431
Saved model as forecasting_models_v5/model_lstm_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LSTM model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 706ms/step
Predicted QoE for the next time step: 96.87372457548022
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/lstm_deep.h5
Completed at Δευ 12 Μαΐ 2025 10:22:44 μμ EEST
=====================================================

=====================================================
Training lstm model with config: wide
Starting at Δευ 12 Μαΐ 2025 10:22:44 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type lstm                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --hidden_units 100 --attention_units 128
2025-05-12 22:22:44.643644: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:22:44.805923: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:22:45.497741: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:22:45.497831: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:22:45.497843: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:22:48.446540: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:22:49.152843: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:22:49.152867: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:22:49.153022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5527 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building LSTM model with self-attention...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 5, 100)            58400     
                                                                 
 lstm_1 (LSTM)               (None, 5, 100)            80400     
                                                                 
 self_attention (SelfAttenti  (None, 100)              13056     
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                2525      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 154,407
Trainable params: 154,407
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 2:08 - loss: 0.3212 3/27 [==>...........................] - ETA: 1s - loss: 0.2576   4/27 [===>..........................] - ETA: 1s - loss: 0.2417 5/27 [====>.........................] - ETA: 1s - loss: 0.2311 7/27 [======>.......................] - ETA: 1s - loss: 0.2137 8/27 [=======>......................] - ETA: 1s - loss: 0.1995 9/27 [=========>....................] - ETA: 0s - loss: 0.185310/27 [==========>...................] - ETA: 0s - loss: 0.174212/27 [============>.................] - ETA: 0s - loss: 0.158013/27 [=============>................] - ETA: 0s - loss: 0.155015/27 [===============>..............] - ETA: 0s - loss: 0.140716/27 [================>.............] - ETA: 0s - loss: 0.133717/27 [=================>............] - ETA: 0s - loss: 0.129218/27 [===================>..........] - ETA: 0s - loss: 0.123919/27 [====================>.........] - ETA: 0s - loss: 0.119520/27 [=====================>........] - ETA: 0s - loss: 0.116422/27 [=======================>......] - ETA: 0s - loss: 0.110523/27 [========================>.....] - ETA: 0s - loss: 0.107624/27 [=========================>....] - ETA: 0s - loss: 0.104825/27 [==========================>...] - ETA: 0s - loss: 0.102926/27 [===========================>..] - ETA: 0s - loss: 0.100627/27 [==============================] - 7s 81ms/step - loss: 0.1002 - val_loss: 0.0108 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0390 2/27 [=>............................] - ETA: 1s - loss: 0.0346 4/27 [===>..........................] - ETA: 1s - loss: 0.0326 5/27 [====>.........................] - ETA: 1s - loss: 0.0339 6/27 [=====>........................] - ETA: 1s - loss: 0.0344 7/27 [======>.......................] - ETA: 1s - loss: 0.0329 8/27 [=======>......................] - ETA: 1s - loss: 0.0361 9/27 [=========>....................] - ETA: 0s - loss: 0.034710/27 [==========>...................] - ETA: 0s - loss: 0.034712/27 [============>.................] - ETA: 0s - loss: 0.034213/27 [=============>................] - ETA: 0s - loss: 0.035914/27 [==============>...............] - ETA: 0s - loss: 0.035615/27 [===============>..............] - ETA: 0s - loss: 0.036416/27 [================>.............] - ETA: 0s - loss: 0.037017/27 [=================>............] - ETA: 0s - loss: 0.037419/27 [====================>.........] - ETA: 0s - loss: 0.036420/27 [=====================>........] - ETA: 0s - loss: 0.035821/27 [======================>.......] - ETA: 0s - loss: 0.036422/27 [=======================>......] - ETA: 0s - loss: 0.036423/27 [========================>.....] - ETA: 0s - loss: 0.036624/27 [=========================>....] - ETA: 0s - loss: 0.036925/27 [==========================>...] - ETA: 0s - loss: 0.036926/27 [===========================>..] - ETA: 0s - loss: 0.037427/27 [==============================] - ETA: 0s - loss: 0.037327/27 [==============================] - 2s 57ms/step - loss: 0.0373 - val_loss: 0.0053 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0327 2/27 [=>............................] - ETA: 1s - loss: 0.0323 3/27 [==>...........................] - ETA: 1s - loss: 0.0327 4/27 [===>..........................] - ETA: 1s - loss: 0.0360 5/27 [====>.........................] - ETA: 1s - loss: 0.0366 6/27 [=====>........................] - ETA: 1s - loss: 0.0351 8/27 [=======>......................] - ETA: 0s - loss: 0.0375 9/27 [=========>....................] - ETA: 0s - loss: 0.035510/27 [==========>...................] - ETA: 0s - loss: 0.034111/27 [===========>..................] - ETA: 0s - loss: 0.035812/27 [============>.................] - ETA: 0s - loss: 0.035914/27 [==============>...............] - ETA: 0s - loss: 0.035315/27 [===============>..............] - ETA: 0s - loss: 0.035616/27 [================>.............] - ETA: 0s - loss: 0.036217/27 [=================>............] - ETA: 0s - loss: 0.034618/27 [===================>..........] - ETA: 0s - loss: 0.034119/27 [====================>.........] - ETA: 0s - loss: 0.033720/27 [=====================>........] - ETA: 0s - loss: 0.034221/27 [======================>.......] - ETA: 0s - loss: 0.034522/27 [=======================>......] - ETA: 0s - loss: 0.033823/27 [========================>.....] - ETA: 0s - loss: 0.035124/27 [=========================>....] - ETA: 0s - loss: 0.036026/27 [===========================>..] - ETA: 0s - loss: 0.036927/27 [==============================] - ETA: 0s - loss: 0.036827/27 [==============================] - 2s 57ms/step - loss: 0.0368 - val_loss: 9.2802e-04 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0423 2/27 [=>............................] - ETA: 1s - loss: 0.0393 3/27 [==>...........................] - ETA: 1s - loss: 0.0391 4/27 [===>..........................] - ETA: 1s - loss: 0.0365 5/27 [====>.........................] - ETA: 1s - loss: 0.0347 6/27 [=====>........................] - ETA: 1s - loss: 0.0340 7/27 [======>.......................] - ETA: 1s - loss: 0.0342 8/27 [=======>......................] - ETA: 0s - loss: 0.0347 9/27 [=========>....................] - ETA: 0s - loss: 0.035110/27 [==========>...................] - ETA: 0s - loss: 0.033711/27 [===========>..................] - ETA: 0s - loss: 0.032912/27 [============>.................] - ETA: 0s - loss: 0.031613/27 [=============>................] - ETA: 0s - loss: 0.034515/27 [===============>..............] - ETA: 0s - loss: 0.033617/27 [=================>............] - ETA: 0s - loss: 0.033719/27 [====================>.........] - ETA: 0s - loss: 0.033420/27 [=====================>........] - ETA: 0s - loss: 0.033222/27 [=======================>......] - ETA: 0s - loss: 0.033023/27 [========================>.....] - ETA: 0s - loss: 0.033425/27 [==========================>...] - ETA: 0s - loss: 0.034326/27 [===========================>..] - ETA: 0s - loss: 0.033827/27 [==============================] - ETA: 0s - loss: 0.034127/27 [==============================] - 2s 56ms/step - loss: 0.0341 - val_loss: 6.8371e-04 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0191 2/27 [=>............................] - ETA: 1s - loss: 0.0284 3/27 [==>...........................] - ETA: 1s - loss: 0.0264 4/27 [===>..........................] - ETA: 1s - loss: 0.0294 5/27 [====>.........................] - ETA: 1s - loss: 0.0308 6/27 [=====>........................] - ETA: 1s - loss: 0.0312 7/27 [======>.......................] - ETA: 1s - loss: 0.0359 8/27 [=======>......................] - ETA: 1s - loss: 0.0333 9/27 [=========>....................] - ETA: 1s - loss: 0.035010/27 [==========>...................] - ETA: 0s - loss: 0.034311/27 [===========>..................] - ETA: 0s - loss: 0.034512/27 [============>.................] - ETA: 0s - loss: 0.035113/27 [=============>................] - ETA: 0s - loss: 0.034114/27 [==============>...............] - ETA: 0s - loss: 0.035215/27 [===============>..............] - ETA: 0s - loss: 0.036616/27 [================>.............] - ETA: 0s - loss: 0.036018/27 [===================>..........] - ETA: 0s - loss: 0.034519/27 [====================>.........] - ETA: 0s - loss: 0.034920/27 [=====================>........] - ETA: 0s - loss: 0.037321/27 [======================>.......] - ETA: 0s - loss: 0.036723/27 [========================>.....] - ETA: 0s - loss: 0.036724/27 [=========================>....] - ETA: 0s - loss: 0.036626/27 [===========================>..] - ETA: 0s - loss: 0.037027/27 [==============================] - ETA: 0s - loss: 0.037027/27 [==============================] - 2s 57ms/step - loss: 0.0370 - val_loss: 0.0092 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0328 2/27 [=>............................] - ETA: 1s - loss: 0.0424 3/27 [==>...........................] - ETA: 1s - loss: 0.0389 4/27 [===>..........................] - ETA: 1s - loss: 0.0367 5/27 [====>.........................] - ETA: 1s - loss: 0.0353 6/27 [=====>........................] - ETA: 1s - loss: 0.0347 7/27 [======>.......................] - ETA: 1s - loss: 0.0346 8/27 [=======>......................] - ETA: 1s - loss: 0.0339 9/27 [=========>....................] - ETA: 0s - loss: 0.036110/27 [==========>...................] - ETA: 0s - loss: 0.035311/27 [===========>..................] - ETA: 0s - loss: 0.034812/27 [============>.................] - ETA: 0s - loss: 0.034314/27 [==============>...............] - ETA: 0s - loss: 0.033915/27 [===============>..............] - ETA: 0s - loss: 0.035616/27 [================>.............] - ETA: 0s - loss: 0.035317/27 [=================>............] - ETA: 0s - loss: 0.034618/27 [===================>..........] - ETA: 0s - loss: 0.034719/27 [====================>.........] - ETA: 0s - loss: 0.034120/27 [=====================>........] - ETA: 0s - loss: 0.033521/27 [======================>.......] - ETA: 0s - loss: 0.033623/27 [========================>.....] - ETA: 0s - loss: 0.034224/27 [=========================>....] - ETA: 0s - loss: 0.034425/27 [==========================>...] - ETA: 0s - loss: 0.034426/27 [===========================>..] - ETA: 0s - loss: 0.034827/27 [==============================] - ETA: 0s - loss: 0.035227/27 [==============================] - 2s 57ms/step - loss: 0.0352 - val_loss: 0.0021 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0377 2/27 [=>............................] - ETA: 1s - loss: 0.0451 3/27 [==>...........................] - ETA: 1s - loss: 0.0402 4/27 [===>..........................] - ETA: 1s - loss: 0.0407 5/27 [====>.........................] - ETA: 1s - loss: 0.0383 6/27 [=====>........................] - ETA: 1s - loss: 0.0364 7/27 [======>.......................] - ETA: 1s - loss: 0.0368 8/27 [=======>......................] - ETA: 1s - loss: 0.0372 9/27 [=========>....................] - ETA: 0s - loss: 0.035410/27 [==========>...................] - ETA: 0s - loss: 0.034111/27 [===========>..................] - ETA: 0s - loss: 0.034512/27 [============>.................] - ETA: 0s - loss: 0.034613/27 [=============>................] - ETA: 0s - loss: 0.035914/27 [==============>...............] - ETA: 0s - loss: 0.035915/27 [===============>..............] - ETA: 0s - loss: 0.035316/27 [================>.............] - ETA: 0s - loss: 0.034018/27 [===================>..........] - ETA: 0s - loss: 0.033620/27 [=====================>........] - ETA: 0s - loss: 0.034821/27 [======================>.......] - ETA: 0s - loss: 0.035122/27 [=======================>......] - ETA: 0s - loss: 0.034523/27 [========================>.....] - ETA: 0s - loss: 0.034324/27 [=========================>....] - ETA: 0s - loss: 0.034725/27 [==========================>...] - ETA: 0s - loss: 0.034427/27 [==============================] - ETA: 0s - loss: 0.034327/27 [==============================] - 2s 58ms/step - loss: 0.0343 - val_loss: 6.7809e-04 - lr: 5.0000e-04
Epoch 8/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0280 2/27 [=>............................] - ETA: 1s - loss: 0.0313 3/27 [==>...........................] - ETA: 1s - loss: 0.0328 4/27 [===>..........................] - ETA: 1s - loss: 0.0412 5/27 [====>.........................] - ETA: 1s - loss: 0.0392 6/27 [=====>........................] - ETA: 1s - loss: 0.0346 7/27 [======>.......................] - ETA: 1s - loss: 0.0332 8/27 [=======>......................] - ETA: 1s - loss: 0.034410/27 [==========>...................] - ETA: 0s - loss: 0.034311/27 [===========>..................] - ETA: 0s - loss: 0.035412/27 [============>.................] - ETA: 0s - loss: 0.035413/27 [=============>................] - ETA: 0s - loss: 0.034014/27 [==============>...............] - ETA: 0s - loss: 0.034115/27 [===============>..............] - ETA: 0s - loss: 0.034516/27 [================>.............] - ETA: 0s - loss: 0.033218/27 [===================>..........] - ETA: 0s - loss: 0.033719/27 [====================>.........] - ETA: 0s - loss: 0.033720/27 [=====================>........] - ETA: 0s - loss: 0.033421/27 [======================>.......] - ETA: 0s - loss: 0.033422/27 [=======================>......] - ETA: 0s - loss: 0.033623/27 [========================>.....] - ETA: 0s - loss: 0.033924/27 [=========================>....] - ETA: 0s - loss: 0.033525/27 [==========================>...] - ETA: 0s - loss: 0.034627/27 [==============================] - ETA: 0s - loss: 0.033927/27 [==============================] - 2s 58ms/step - loss: 0.0339 - val_loss: 6.2892e-04 - lr: 5.0000e-04
Epoch 9/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0155 2/27 [=>............................] - ETA: 1s - loss: 0.0422 3/27 [==>...........................] - ETA: 1s - loss: 0.0367 5/27 [====>.........................] - ETA: 1s - loss: 0.0286 6/27 [=====>........................] - ETA: 1s - loss: 0.0272 7/27 [======>.......................] - ETA: 1s - loss: 0.0312 8/27 [=======>......................] - ETA: 1s - loss: 0.0317 9/27 [=========>....................] - ETA: 0s - loss: 0.029911/27 [===========>..................] - ETA: 0s - loss: 0.029713/27 [=============>................] - ETA: 0s - loss: 0.030414/27 [==============>...............] - ETA: 0s - loss: 0.030915/27 [===============>..............] - ETA: 0s - loss: 0.031517/27 [=================>............] - ETA: 0s - loss: 0.032818/27 [===================>..........] - ETA: 0s - loss: 0.032219/27 [====================>.........] - ETA: 0s - loss: 0.033120/27 [=====================>........] - ETA: 0s - loss: 0.032121/27 [======================>.......] - ETA: 0s - loss: 0.032322/27 [=======================>......] - ETA: 0s - loss: 0.033023/27 [========================>.....] - ETA: 0s - loss: 0.032425/27 [==========================>...] - ETA: 0s - loss: 0.033626/27 [===========================>..] - ETA: 0s - loss: 0.033427/27 [==============================] - ETA: 0s - loss: 0.033327/27 [==============================] - 2s 56ms/step - loss: 0.0333 - val_loss: 0.0027 - lr: 2.5000e-04
Epoch 10/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0572 2/27 [=>............................] - ETA: 1s - loss: 0.0489 3/27 [==>...........................] - ETA: 1s - loss: 0.0457 5/27 [====>.........................] - ETA: 1s - loss: 0.0385 7/27 [======>.......................] - ETA: 1s - loss: 0.0356 8/27 [=======>......................] - ETA: 0s - loss: 0.0354 9/27 [=========>....................] - ETA: 0s - loss: 0.034210/27 [==========>...................] - ETA: 0s - loss: 0.034711/27 [===========>..................] - ETA: 0s - loss: 0.034112/27 [============>.................] - ETA: 0s - loss: 0.031713/27 [=============>................] - ETA: 0s - loss: 0.031915/27 [===============>..............] - ETA: 0s - loss: 0.030717/27 [=================>............] - ETA: 0s - loss: 0.029519/27 [====================>.........] - ETA: 0s - loss: 0.029221/27 [======================>.......] - ETA: 0s - loss: 0.030922/27 [=======================>......] - ETA: 0s - loss: 0.032023/27 [========================>.....] - ETA: 0s - loss: 0.031825/27 [==========================>...] - ETA: 0s - loss: 0.031927/27 [==============================] - ETA: 0s - loss: 0.032727/27 [==============================] - 1s 55ms/step - loss: 0.0327 - val_loss: 0.0019 - lr: 2.5000e-04
Epoch 11/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0381 3/27 [==>...........................] - ETA: 1s - loss: 0.0343 4/27 [===>..........................] - ETA: 1s - loss: 0.0321 5/27 [====>.........................] - ETA: 1s - loss: 0.0334 6/27 [=====>........................] - ETA: 1s - loss: 0.0321 8/27 [=======>......................] - ETA: 0s - loss: 0.0337 9/27 [=========>....................] - ETA: 0s - loss: 0.037410/27 [==========>...................] - ETA: 0s - loss: 0.037911/27 [===========>..................] - ETA: 0s - loss: 0.037612/27 [============>.................] - ETA: 0s - loss: 0.038313/27 [=============>................] - ETA: 0s - loss: 0.037514/27 [==============>...............] - ETA: 0s - loss: 0.036915/27 [===============>..............] - ETA: 0s - loss: 0.035716/27 [================>.............] - ETA: 0s - loss: 0.034917/27 [=================>............] - ETA: 0s - loss: 0.034718/27 [===================>..........] - ETA: 0s - loss: 0.034420/27 [=====================>........] - ETA: 0s - loss: 0.034422/27 [=======================>......] - ETA: 0s - loss: 0.034524/27 [=========================>....] - ETA: 0s - loss: 0.033725/27 [==========================>...] - ETA: 0s - loss: 0.034026/27 [===========================>..] - ETA: 0s - loss: 0.033827/27 [==============================] - ETA: 0s - loss: 0.033827/27 [==============================] - 2s 56ms/step - loss: 0.0338 - val_loss: 3.2149e-04 - lr: 1.2500e-04
Epoch 12/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0240 2/27 [=>............................] - ETA: 1s - loss: 0.0257 4/27 [===>..........................] - ETA: 1s - loss: 0.0329 6/27 [=====>........................] - ETA: 1s - loss: 0.0306 7/27 [======>.......................] - ETA: 0s - loss: 0.0293 8/27 [=======>......................] - ETA: 0s - loss: 0.0318 9/27 [=========>....................] - ETA: 0s - loss: 0.031311/27 [===========>..................] - ETA: 0s - loss: 0.033113/27 [=============>................] - ETA: 0s - loss: 0.033814/27 [==============>...............] - ETA: 0s - loss: 0.035115/27 [===============>..............] - ETA: 0s - loss: 0.035116/27 [================>.............] - ETA: 0s - loss: 0.035417/27 [=================>............] - ETA: 0s - loss: 0.034918/27 [===================>..........] - ETA: 0s - loss: 0.034720/27 [=====================>........] - ETA: 0s - loss: 0.034121/27 [======================>.......] - ETA: 0s - loss: 0.034022/27 [=======================>......] - ETA: 0s - loss: 0.033523/27 [========================>.....] - ETA: 0s - loss: 0.033325/27 [==========================>...] - ETA: 0s - loss: 0.034526/27 [===========================>..] - ETA: 0s - loss: 0.033727/27 [==============================] - 2s 56ms/step - loss: 0.0339 - val_loss: 0.0011 - lr: 1.2500e-04
Epoch 13/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0260 2/27 [=>............................] - ETA: 1s - loss: 0.0321 4/27 [===>..........................] - ETA: 1s - loss: 0.0269 5/27 [====>.........................] - ETA: 1s - loss: 0.0253 7/27 [======>.......................] - ETA: 1s - loss: 0.0257 8/27 [=======>......................] - ETA: 0s - loss: 0.026910/27 [==========>...................] - ETA: 0s - loss: 0.029411/27 [===========>..................] - ETA: 0s - loss: 0.031112/27 [============>.................] - ETA: 0s - loss: 0.031814/27 [==============>...............] - ETA: 0s - loss: 0.034216/27 [================>.............] - ETA: 0s - loss: 0.033418/27 [===================>..........] - ETA: 0s - loss: 0.035820/27 [=====================>........] - ETA: 0s - loss: 0.034621/27 [======================>.......] - ETA: 0s - loss: 0.034023/27 [========================>.....] - ETA: 0s - loss: 0.032924/27 [=========================>....] - ETA: 0s - loss: 0.033525/27 [==========================>...] - ETA: 0s - loss: 0.032827/27 [==============================] - ETA: 0s - loss: 0.032627/27 [==============================] - 1s 54ms/step - loss: 0.0326 - val_loss: 0.0011 - lr: 1.2500e-04
Epoch 14/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0276 2/27 [=>............................] - ETA: 1s - loss: 0.0302 3/27 [==>...........................] - ETA: 1s - loss: 0.0258 5/27 [====>.........................] - ETA: 1s - loss: 0.0279 7/27 [======>.......................] - ETA: 1s - loss: 0.0379 9/27 [=========>....................] - ETA: 0s - loss: 0.036110/27 [==========>...................] - ETA: 0s - loss: 0.035711/27 [===========>..................] - ETA: 0s - loss: 0.033912/27 [============>.................] - ETA: 0s - loss: 0.033813/27 [=============>................] - ETA: 0s - loss: 0.032614/27 [==============>...............] - ETA: 0s - loss: 0.033015/27 [===============>..............] - ETA: 0s - loss: 0.032217/27 [=================>............] - ETA: 0s - loss: 0.031518/27 [===================>..........] - ETA: 0s - loss: 0.030920/27 [=====================>........] - ETA: 0s - loss: 0.031621/27 [======================>.......] - ETA: 0s - loss: 0.032422/27 [=======================>......] - ETA: 0s - loss: 0.032023/27 [========================>.....] - ETA: 0s - loss: 0.032425/27 [==========================>...] - ETA: 0s - loss: 0.033027/27 [==============================] - ETA: 0s - loss: 0.033427/27 [==============================] - 1s 55ms/step - loss: 0.0334 - val_loss: 6.9244e-04 - lr: 6.2500e-05
1/5 [=====>........................] - ETA: 0s - loss: 4.4552e-045/5 [==============================] - 0s 11ms/step - loss: 0.0011
Test Loss: 0.001100075663998723
Saved model as forecasting_models_v5/model_lstm_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LSTM model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 501ms/step
Predicted QoE for the next time step: 100.15610647022962
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/lstm_wide.h5
Completed at Δευ 12 Μαΐ 2025 10:23:20 μμ EEST
=====================================================

=====================================================
Training lstm model with config: bidirectional
Starting at Δευ 12 Μαΐ 2025 10:23:20 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type lstm                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --bidirectional --attention_units 128
2025-05-12 22:23:20.414750: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:23:20.572011: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:23:21.158957: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:23:21.159032: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:23:21.159040: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:23:23.925413: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:23:24.606614: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:23:24.606637: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:23:24.606773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5509 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building LSTM model with self-attention...
Traceback (most recent call last):
  File "timeseries_forecasting_models_v5.py", line 889, in <module>
    main()
  File "timeseries_forecasting_models_v5.py", line 720, in main
    model.summary()
  File "/home/dimitris/.local/lib/python3.8/site-packages/keras/engine/training.py", line 3214, in summary
    raise ValueError(
ValueError: This model has not yet been built. Build the model first by calling `build()` or by calling the model on a batch of data.
Warning: Original model file not found at /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/model_lstm_with_attention.h5
Directory contents:
total 4860
drwxrwxr-x  2 dimitris dimitris    4096 Μαΐ  12 22:23 .
drwxrwxr-x 20 dimitris dimitris    4096 Μαΐ  12 21:43 ..
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  12 22:21 dnn_basic.h5
-rw-rw-r--  1 dimitris dimitris  519208 Μαΐ  12 22:21 dnn_deep.h5
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  12 22:21 dnn_with_elu.h5
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  12 22:21 dnn_with_high_dropout.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  12 22:20 linear_basic.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  12 22:20 linear_with_elastic_net.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  12 22:20 linear_with_l1_reg.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  12 22:20 linear_with_l2_reg.h5
-rw-rw-r--  1 dimitris dimitris  628760 Μαΐ  12 22:22 lstm_basic.h5
-rw-rw-r--  1 dimitris dimitris  881952 Μαΐ  12 22:22 lstm_deep.h5
-rw-rw-r--  1 dimitris dimitris 1914264 Μαΐ  12 22:23 lstm_wide.h5
-rw-rw-r--  1 dimitris dimitris    3463 Μαΐ  12 22:23 scaler.save
-rw-rw-r--  1 dimitris dimitris  196249 Μαΐ  12 22:23 training_log.txt
Completed at Δευ 12 Μαΐ 2025 10:23:27 μμ EEST
=====================================================

=====================================================
Training lstm model with config: with_stats
Starting at Δευ 12 Μαΐ 2025 10:23:27 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type lstm                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --attention_units 128
2025-05-12 22:23:27.600156: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:23:27.750137: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:23:28.318508: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:23:28.318609: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:23:28.318622: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:23:31.047623: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:23:31.738220: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:23:31.738243: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:23:31.738402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5512 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building LSTM model with self-attention...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 5, 50)             19200     
                                                                 
 lstm_1 (LSTM)               (None, 5, 50)             20200     
                                                                 
 self_attention (SelfAttenti  (None, 50)               6656      
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                1275      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 47,357
Trainable params: 47,357
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 1:55 - loss: 0.2722 3/27 [==>...........................] - ETA: 1s - loss: 0.2415   5/27 [====>.........................] - ETA: 0s - loss: 0.2230 7/27 [======>.......................] - ETA: 0s - loss: 0.2088 9/27 [=========>....................] - ETA: 0s - loss: 0.196211/27 [===========>..................] - ETA: 0s - loss: 0.179213/27 [=============>................] - ETA: 0s - loss: 0.164414/27 [==============>...............] - ETA: 0s - loss: 0.159216/27 [================>.............] - ETA: 0s - loss: 0.146718/27 [===================>..........] - ETA: 0s - loss: 0.136619/27 [====================>.........] - ETA: 0s - loss: 0.133021/27 [======================>.......] - ETA: 0s - loss: 0.131522/27 [=======================>......] - ETA: 0s - loss: 0.127924/27 [=========================>....] - ETA: 0s - loss: 0.120225/27 [==========================>...] - ETA: 0s - loss: 0.117026/27 [===========================>..] - ETA: 0s - loss: 0.114227/27 [==============================] - ETA: 0s - loss: 0.113827/27 [==============================] - 6s 73ms/step - loss: 0.1138 - val_loss: 0.0508 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0413 3/27 [==>...........................] - ETA: 1s - loss: 0.0439 4/27 [===>..........................] - ETA: 1s - loss: 0.0435 5/27 [====>.........................] - ETA: 1s - loss: 0.0410 6/27 [=====>........................] - ETA: 1s - loss: 0.0420 7/27 [======>.......................] - ETA: 1s - loss: 0.0444 8/27 [=======>......................] - ETA: 1s - loss: 0.041110/27 [==========>...................] - ETA: 0s - loss: 0.040012/27 [============>.................] - ETA: 0s - loss: 0.039313/27 [=============>................] - ETA: 0s - loss: 0.041114/27 [==============>...............] - ETA: 0s - loss: 0.042415/27 [===============>..............] - ETA: 0s - loss: 0.041516/27 [================>.............] - ETA: 0s - loss: 0.040618/27 [===================>..........] - ETA: 0s - loss: 0.038720/27 [=====================>........] - ETA: 0s - loss: 0.038121/27 [======================>.......] - ETA: 0s - loss: 0.037722/27 [=======================>......] - ETA: 0s - loss: 0.037223/27 [========================>.....] - ETA: 0s - loss: 0.038424/27 [=========================>....] - ETA: 0s - loss: 0.037526/27 [===========================>..] - ETA: 0s - loss: 0.038727/27 [==============================] - 1s 54ms/step - loss: 0.0386 - val_loss: 0.0100 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0253 2/27 [=>............................] - ETA: 1s - loss: 0.0423 3/27 [==>...........................] - ETA: 1s - loss: 0.0403 5/27 [====>.........................] - ETA: 1s - loss: 0.0400 7/27 [======>.......................] - ETA: 1s - loss: 0.0376 8/27 [=======>......................] - ETA: 0s - loss: 0.037310/27 [==========>...................] - ETA: 0s - loss: 0.037111/27 [===========>..................] - ETA: 0s - loss: 0.037012/27 [============>.................] - ETA: 0s - loss: 0.035814/27 [==============>...............] - ETA: 0s - loss: 0.037015/27 [===============>..............] - ETA: 0s - loss: 0.036216/27 [================>.............] - ETA: 0s - loss: 0.035118/27 [===================>..........] - ETA: 0s - loss: 0.036620/27 [=====================>........] - ETA: 0s - loss: 0.036322/27 [=======================>......] - ETA: 0s - loss: 0.037124/27 [=========================>....] - ETA: 0s - loss: 0.036626/27 [===========================>..] - ETA: 0s - loss: 0.036527/27 [==============================] - 1s 53ms/step - loss: 0.0364 - val_loss: 0.0074 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0446 3/27 [==>...........................] - ETA: 1s - loss: 0.0451 5/27 [====>.........................] - ETA: 1s - loss: 0.0379 7/27 [======>.......................] - ETA: 0s - loss: 0.0356 9/27 [=========>....................] - ETA: 0s - loss: 0.033711/27 [===========>..................] - ETA: 0s - loss: 0.031513/27 [=============>................] - ETA: 0s - loss: 0.032815/27 [===============>..............] - ETA: 0s - loss: 0.033716/27 [================>.............] - ETA: 0s - loss: 0.034418/27 [===================>..........] - ETA: 0s - loss: 0.033120/27 [=====================>........] - ETA: 0s - loss: 0.032822/27 [=======================>......] - ETA: 0s - loss: 0.033024/27 [=========================>....] - ETA: 0s - loss: 0.033126/27 [===========================>..] - ETA: 0s - loss: 0.034627/27 [==============================] - 1s 52ms/step - loss: 0.0346 - val_loss: 0.0033 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0202 3/27 [==>...........................] - ETA: 1s - loss: 0.0296 4/27 [===>..........................] - ETA: 1s - loss: 0.0340 6/27 [=====>........................] - ETA: 0s - loss: 0.0323 8/27 [=======>......................] - ETA: 0s - loss: 0.0304 9/27 [=========>....................] - ETA: 0s - loss: 0.032211/27 [===========>..................] - ETA: 0s - loss: 0.032312/27 [============>.................] - ETA: 0s - loss: 0.032913/27 [=============>................] - ETA: 0s - loss: 0.032915/27 [===============>..............] - ETA: 0s - loss: 0.031817/27 [=================>............] - ETA: 0s - loss: 0.034318/27 [===================>..........] - ETA: 0s - loss: 0.035419/27 [====================>.........] - ETA: 0s - loss: 0.034921/27 [======================>.......] - ETA: 0s - loss: 0.035623/27 [========================>.....] - ETA: 0s - loss: 0.035124/27 [=========================>....] - ETA: 0s - loss: 0.034926/27 [===========================>..] - ETA: 0s - loss: 0.034227/27 [==============================] - 1s 52ms/step - loss: 0.0346 - val_loss: 0.0011 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0320 3/27 [==>...........................] - ETA: 1s - loss: 0.0363 4/27 [===>..........................] - ETA: 1s - loss: 0.0359 5/27 [====>.........................] - ETA: 1s - loss: 0.0343 6/27 [=====>........................] - ETA: 1s - loss: 0.0326 8/27 [=======>......................] - ETA: 0s - loss: 0.0327 9/27 [=========>....................] - ETA: 0s - loss: 0.033210/27 [==========>...................] - ETA: 0s - loss: 0.032311/27 [===========>..................] - ETA: 0s - loss: 0.032613/27 [=============>................] - ETA: 0s - loss: 0.035015/27 [===============>..............] - ETA: 0s - loss: 0.034416/27 [================>.............] - ETA: 0s - loss: 0.034317/27 [=================>............] - ETA: 0s - loss: 0.034518/27 [===================>..........] - ETA: 0s - loss: 0.033719/27 [====================>.........] - ETA: 0s - loss: 0.033220/27 [=====================>........] - ETA: 0s - loss: 0.034121/27 [======================>.......] - ETA: 0s - loss: 0.033923/27 [========================>.....] - ETA: 0s - loss: 0.034625/27 [==========================>...] - ETA: 0s - loss: 0.034426/27 [===========================>..] - ETA: 0s - loss: 0.034527/27 [==============================] - ETA: 0s - loss: 0.034627/27 [==============================] - 1s 55ms/step - loss: 0.0346 - val_loss: 0.0026 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0203 2/27 [=>............................] - ETA: 1s - loss: 0.0405 3/27 [==>...........................] - ETA: 1s - loss: 0.0397 5/27 [====>.........................] - ETA: 1s - loss: 0.0336 6/27 [=====>........................] - ETA: 1s - loss: 0.0319 8/27 [=======>......................] - ETA: 0s - loss: 0.033710/27 [==========>...................] - ETA: 0s - loss: 0.035412/27 [============>.................] - ETA: 0s - loss: 0.034213/27 [=============>................] - ETA: 0s - loss: 0.033715/27 [===============>..............] - ETA: 0s - loss: 0.032617/27 [=================>............] - ETA: 0s - loss: 0.035519/27 [====================>.........] - ETA: 0s - loss: 0.035521/27 [======================>.......] - ETA: 0s - loss: 0.036022/27 [=======================>......] - ETA: 0s - loss: 0.035323/27 [========================>.....] - ETA: 0s - loss: 0.034625/27 [==========================>...] - ETA: 0s - loss: 0.034426/27 [===========================>..] - ETA: 0s - loss: 0.034227/27 [==============================] - 1s 52ms/step - loss: 0.0342 - val_loss: 3.6436e-04 - lr: 0.0010
Epoch 8/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0178 3/27 [==>...........................] - ETA: 1s - loss: 0.0261 5/27 [====>.........................] - ETA: 1s - loss: 0.0284 7/27 [======>.......................] - ETA: 0s - loss: 0.0369 8/27 [=======>......................] - ETA: 0s - loss: 0.0372 9/27 [=========>....................] - ETA: 0s - loss: 0.038110/27 [==========>...................] - ETA: 0s - loss: 0.036411/27 [===========>..................] - ETA: 0s - loss: 0.035313/27 [=============>................] - ETA: 0s - loss: 0.035115/27 [===============>..............] - ETA: 0s - loss: 0.036217/27 [=================>............] - ETA: 0s - loss: 0.036518/27 [===================>..........] - ETA: 0s - loss: 0.036519/27 [====================>.........] - ETA: 0s - loss: 0.035721/27 [======================>.......] - ETA: 0s - loss: 0.035423/27 [========================>.....] - ETA: 0s - loss: 0.036024/27 [=========================>....] - ETA: 0s - loss: 0.035525/27 [==========================>...] - ETA: 0s - loss: 0.034927/27 [==============================] - ETA: 0s - loss: 0.035427/27 [==============================] - 1s 53ms/step - loss: 0.0354 - val_loss: 5.5771e-04 - lr: 0.0010
Epoch 9/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0611 2/27 [=>............................] - ETA: 1s - loss: 0.0420 4/27 [===>..........................] - ETA: 1s - loss: 0.0367 6/27 [=====>........................] - ETA: 1s - loss: 0.0343 7/27 [======>.......................] - ETA: 0s - loss: 0.0349 9/27 [=========>....................] - ETA: 0s - loss: 0.032511/27 [===========>..................] - ETA: 0s - loss: 0.032712/27 [============>.................] - ETA: 0s - loss: 0.032614/27 [==============>...............] - ETA: 0s - loss: 0.034916/27 [================>.............] - ETA: 0s - loss: 0.038218/27 [===================>..........] - ETA: 0s - loss: 0.037419/27 [====================>.........] - ETA: 0s - loss: 0.037521/27 [======================>.......] - ETA: 0s - loss: 0.036122/27 [=======================>......] - ETA: 0s - loss: 0.035824/27 [=========================>....] - ETA: 0s - loss: 0.036425/27 [==========================>...] - ETA: 0s - loss: 0.035727/27 [==============================] - ETA: 0s - loss: 0.035027/27 [==============================] - 1s 53ms/step - loss: 0.0350 - val_loss: 3.4558e-04 - lr: 0.0010
Epoch 10/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0324 2/27 [=>............................] - ETA: 1s - loss: 0.0370 4/27 [===>..........................] - ETA: 1s - loss: 0.0322 6/27 [=====>........................] - ETA: 1s - loss: 0.0341 7/27 [======>.......................] - ETA: 1s - loss: 0.0334 8/27 [=======>......................] - ETA: 0s - loss: 0.0324 9/27 [=========>....................] - ETA: 0s - loss: 0.031110/27 [==========>...................] - ETA: 0s - loss: 0.030512/27 [============>.................] - ETA: 0s - loss: 0.029614/27 [==============>...............] - ETA: 0s - loss: 0.030516/27 [================>.............] - ETA: 0s - loss: 0.031818/27 [===================>..........] - ETA: 0s - loss: 0.031619/27 [====================>.........] - ETA: 0s - loss: 0.031521/27 [======================>.......] - ETA: 0s - loss: 0.031522/27 [=======================>......] - ETA: 0s - loss: 0.031724/27 [=========================>....] - ETA: 0s - loss: 0.032226/27 [===========================>..] - ETA: 0s - loss: 0.033027/27 [==============================] - 1s 52ms/step - loss: 0.0334 - val_loss: 5.3896e-04 - lr: 5.0000e-04
Epoch 11/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0274 2/27 [=>............................] - ETA: 1s - loss: 0.0351 3/27 [==>...........................] - ETA: 1s - loss: 0.0310 5/27 [====>.........................] - ETA: 1s - loss: 0.0304 6/27 [=====>........................] - ETA: 1s - loss: 0.0317 7/27 [======>.......................] - ETA: 1s - loss: 0.0346 8/27 [=======>......................] - ETA: 0s - loss: 0.0335 9/27 [=========>....................] - ETA: 0s - loss: 0.035911/27 [===========>..................] - ETA: 0s - loss: 0.034512/27 [============>.................] - ETA: 0s - loss: 0.034113/27 [=============>................] - ETA: 0s - loss: 0.033215/27 [===============>..............] - ETA: 0s - loss: 0.033217/27 [=================>............] - ETA: 0s - loss: 0.032619/27 [====================>.........] - ETA: 0s - loss: 0.034020/27 [=====================>........] - ETA: 0s - loss: 0.033022/27 [=======================>......] - ETA: 0s - loss: 0.032824/27 [=========================>....] - ETA: 0s - loss: 0.032925/27 [==========================>...] - ETA: 0s - loss: 0.032426/27 [===========================>..] - ETA: 0s - loss: 0.032927/27 [==============================] - ETA: 0s - loss: 0.032927/27 [==============================] - 1s 54ms/step - loss: 0.0329 - val_loss: 3.5025e-04 - lr: 5.0000e-04
Epoch 12/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0184 2/27 [=>............................] - ETA: 1s - loss: 0.0316 3/27 [==>...........................] - ETA: 1s - loss: 0.0289 4/27 [===>..........................] - ETA: 1s - loss: 0.0344 5/27 [====>.........................] - ETA: 1s - loss: 0.0308 6/27 [=====>........................] - ETA: 1s - loss: 0.0300 7/27 [======>.......................] - ETA: 1s - loss: 0.0309 9/27 [=========>....................] - ETA: 0s - loss: 0.032111/27 [===========>..................] - ETA: 0s - loss: 0.031212/27 [============>.................] - ETA: 0s - loss: 0.032314/27 [==============>...............] - ETA: 0s - loss: 0.033016/27 [================>.............] - ETA: 0s - loss: 0.033517/27 [=================>............] - ETA: 0s - loss: 0.032718/27 [===================>..........] - ETA: 0s - loss: 0.033320/27 [=====================>........] - ETA: 0s - loss: 0.032021/27 [======================>.......] - ETA: 0s - loss: 0.031423/27 [========================>.....] - ETA: 0s - loss: 0.032025/27 [==========================>...] - ETA: 0s - loss: 0.033027/27 [==============================] - ETA: 0s - loss: 0.032527/27 [==============================] - 1s 54ms/step - loss: 0.0325 - val_loss: 2.7882e-04 - lr: 2.5000e-04
Epoch 13/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0410 2/27 [=>............................] - ETA: 1s - loss: 0.0280 3/27 [==>...........................] - ETA: 1s - loss: 0.0308 4/27 [===>..........................] - ETA: 1s - loss: 0.0279 5/27 [====>.........................] - ETA: 1s - loss: 0.0275 6/27 [=====>........................] - ETA: 1s - loss: 0.0293 7/27 [======>.......................] - ETA: 1s - loss: 0.0328 9/27 [=========>....................] - ETA: 0s - loss: 0.030911/27 [===========>..................] - ETA: 0s - loss: 0.030413/27 [=============>................] - ETA: 0s - loss: 0.032014/27 [==============>...............] - ETA: 0s - loss: 0.032716/27 [================>.............] - ETA: 0s - loss: 0.032118/27 [===================>..........] - ETA: 0s - loss: 0.032819/27 [====================>.........] - ETA: 0s - loss: 0.033320/27 [=====================>........] - ETA: 0s - loss: 0.034421/27 [======================>.......] - ETA: 0s - loss: 0.033723/27 [========================>.....] - ETA: 0s - loss: 0.033725/27 [==========================>...] - ETA: 0s - loss: 0.033727/27 [==============================] - ETA: 0s - loss: 0.033427/27 [==============================] - 1s 54ms/step - loss: 0.0334 - val_loss: 0.0032 - lr: 2.5000e-04
Epoch 14/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0280 2/27 [=>............................] - ETA: 1s - loss: 0.0417 4/27 [===>..........................] - ETA: 1s - loss: 0.0391 5/27 [====>.........................] - ETA: 1s - loss: 0.0387 6/27 [=====>........................] - ETA: 1s - loss: 0.0361 7/27 [======>.......................] - ETA: 1s - loss: 0.0354 9/27 [=========>....................] - ETA: 0s - loss: 0.033211/27 [===========>..................] - ETA: 0s - loss: 0.032612/27 [============>.................] - ETA: 0s - loss: 0.033614/27 [==============>...............] - ETA: 0s - loss: 0.031616/27 [================>.............] - ETA: 0s - loss: 0.032517/27 [=================>............] - ETA: 0s - loss: 0.031919/27 [====================>.........] - ETA: 0s - loss: 0.032221/27 [======================>.......] - ETA: 0s - loss: 0.034422/27 [=======================>......] - ETA: 0s - loss: 0.035624/27 [=========================>....] - ETA: 0s - loss: 0.035126/27 [===========================>..] - ETA: 0s - loss: 0.034327/27 [==============================] - 1s 53ms/step - loss: 0.0343 - val_loss: 4.7743e-04 - lr: 1.2500e-04
Epoch 15/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0480 3/27 [==>...........................] - ETA: 1s - loss: 0.0394 5/27 [====>.........................] - ETA: 1s - loss: 0.0382 6/27 [=====>........................] - ETA: 1s - loss: 0.0371 7/27 [======>.......................] - ETA: 0s - loss: 0.0344 9/27 [=========>....................] - ETA: 0s - loss: 0.032711/27 [===========>..................] - ETA: 0s - loss: 0.032212/27 [============>.................] - ETA: 0s - loss: 0.034314/27 [==============>...............] - ETA: 0s - loss: 0.034816/27 [================>.............] - ETA: 0s - loss: 0.035717/27 [=================>............] - ETA: 0s - loss: 0.034518/27 [===================>..........] - ETA: 0s - loss: 0.034420/27 [=====================>........] - ETA: 0s - loss: 0.034122/27 [=======================>......] - ETA: 0s - loss: 0.033823/27 [========================>.....] - ETA: 0s - loss: 0.033524/27 [=========================>....] - ETA: 0s - loss: 0.033026/27 [===========================>..] - ETA: 0s - loss: 0.032527/27 [==============================] - 1s 53ms/step - loss: 0.0330 - val_loss: 3.2624e-04 - lr: 1.2500e-04
1/5 [=====>........................] - ETA: 0s - loss: 5.5182e-045/5 [==============================] - 0s 9ms/step - loss: 0.0011
Test Loss: 0.0011365277459844947
Saved model as forecasting_models_v5/model_lstm_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for LSTM model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 501ms/step
Predicted QoE for the next time step: 94.13159230234861
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/lstm_with_stats.h5
Completed at Δευ 12 Μαΐ 2025 10:24:02 μμ EEST
=====================================================

=====================================================
Training gru model with config: basic
Starting at Δευ 12 Μαΐ 2025 10:24:02 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type gru                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --attention_units 128
2025-05-12 22:24:02.585776: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:24:02.731851: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:24:03.306177: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:24:03.306267: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:24:03.306277: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:24:06.047834: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:24:06.721767: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:24:06.721801: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:24:06.721930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5522 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building GRU model with self-attention...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 5, 50)             14550     
                                                                 
 gru_1 (GRU)                 (None, 5, 50)             15300     
                                                                 
 self_attention (SelfAttenti  (None, 50)               6656      
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                1275      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 37,807
Trainable params: 37,807
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 1:48 - loss: 0.3213 3/27 [==>...........................] - ETA: 1s - loss: 0.2368   5/27 [====>.........................] - ETA: 0s - loss: 0.1891 7/27 [======>.......................] - ETA: 0s - loss: 0.1568 9/27 [=========>....................] - ETA: 0s - loss: 0.130511/27 [===========>..................] - ETA: 0s - loss: 0.121413/27 [=============>................] - ETA: 0s - loss: 0.109415/27 [===============>..............] - ETA: 0s - loss: 0.099416/27 [================>.............] - ETA: 0s - loss: 0.096318/27 [===================>..........] - ETA: 0s - loss: 0.089420/27 [=====================>........] - ETA: 0s - loss: 0.083722/27 [=======================>......] - ETA: 0s - loss: 0.079023/27 [========================>.....] - ETA: 0s - loss: 0.076425/27 [==========================>...] - ETA: 0s - loss: 0.072527/27 [==============================] - ETA: 0s - loss: 0.070927/27 [==============================] - 6s 72ms/step - loss: 0.0709 - val_loss: 0.0093 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0399 3/27 [==>...........................] - ETA: 1s - loss: 0.0286 5/27 [====>.........................] - ETA: 1s - loss: 0.0312 7/27 [======>.......................] - ETA: 0s - loss: 0.0309 9/27 [=========>....................] - ETA: 0s - loss: 0.032711/27 [===========>..................] - ETA: 0s - loss: 0.036313/27 [=============>................] - ETA: 0s - loss: 0.036115/27 [===============>..............] - ETA: 0s - loss: 0.037716/27 [================>.............] - ETA: 0s - loss: 0.037818/27 [===================>..........] - ETA: 0s - loss: 0.039120/27 [=====================>........] - ETA: 0s - loss: 0.039821/27 [======================>.......] - ETA: 0s - loss: 0.039123/27 [========================>.....] - ETA: 0s - loss: 0.038725/27 [==========================>...] - ETA: 0s - loss: 0.037727/27 [==============================] - ETA: 0s - loss: 0.037827/27 [==============================] - 1s 50ms/step - loss: 0.0378 - val_loss: 5.6061e-04 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0435 3/27 [==>...........................] - ETA: 1s - loss: 0.0376 5/27 [====>.........................] - ETA: 1s - loss: 0.0334 7/27 [======>.......................] - ETA: 0s - loss: 0.0312 9/27 [=========>....................] - ETA: 0s - loss: 0.033610/27 [==========>...................] - ETA: 0s - loss: 0.033112/27 [============>.................] - ETA: 0s - loss: 0.033614/27 [==============>...............] - ETA: 0s - loss: 0.034216/27 [================>.............] - ETA: 0s - loss: 0.033318/27 [===================>..........] - ETA: 0s - loss: 0.034620/27 [=====================>........] - ETA: 0s - loss: 0.035922/27 [=======================>......] - ETA: 0s - loss: 0.035723/27 [========================>.....] - ETA: 0s - loss: 0.036325/27 [==========================>...] - ETA: 0s - loss: 0.036227/27 [==============================] - ETA: 0s - loss: 0.036127/27 [==============================] - 1s 49ms/step - loss: 0.0361 - val_loss: 0.0027 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0211 3/27 [==>...........................] - ETA: 1s - loss: 0.0333 4/27 [===>..........................] - ETA: 1s - loss: 0.0370 5/27 [====>.........................] - ETA: 1s - loss: 0.0444 7/27 [======>.......................] - ETA: 0s - loss: 0.0435 9/27 [=========>....................] - ETA: 0s - loss: 0.038411/27 [===========>..................] - ETA: 0s - loss: 0.035713/27 [=============>................] - ETA: 0s - loss: 0.036814/27 [==============>...............] - ETA: 0s - loss: 0.036816/27 [================>.............] - ETA: 0s - loss: 0.037318/27 [===================>..........] - ETA: 0s - loss: 0.036620/27 [=====================>........] - ETA: 0s - loss: 0.036722/27 [=======================>......] - ETA: 0s - loss: 0.035424/27 [=========================>....] - ETA: 0s - loss: 0.035826/27 [===========================>..] - ETA: 0s - loss: 0.035427/27 [==============================] - 1s 50ms/step - loss: 0.0356 - val_loss: 0.0028 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0436 3/27 [==>...........................] - ETA: 1s - loss: 0.0355 5/27 [====>.........................] - ETA: 1s - loss: 0.0349 6/27 [=====>........................] - ETA: 1s - loss: 0.0354 8/27 [=======>......................] - ETA: 0s - loss: 0.036710/27 [==========>...................] - ETA: 0s - loss: 0.038012/27 [============>.................] - ETA: 0s - loss: 0.039014/27 [==============>...............] - ETA: 0s - loss: 0.037616/27 [================>.............] - ETA: 0s - loss: 0.037418/27 [===================>..........] - ETA: 0s - loss: 0.038120/27 [=====================>........] - ETA: 0s - loss: 0.035822/27 [=======================>......] - ETA: 0s - loss: 0.034624/27 [=========================>....] - ETA: 0s - loss: 0.033626/27 [===========================>..] - ETA: 0s - loss: 0.033527/27 [==============================] - 1s 51ms/step - loss: 0.0334 - val_loss: 0.0019 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.00145/5 [==============================] - 0s 10ms/step - loss: 0.0023
Test Loss: 0.002318304032087326
Saved model as forecasting_models_v5/model_gru_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for GRU model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 559ms/step
Predicted QoE for the next time step: 94.59383010726214
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/gru_basic.h5
Completed at Δευ 12 Μαΐ 2025 10:24:22 μμ EEST
=====================================================

=====================================================
Training gru model with config: deep
Starting at Δευ 12 Μαΐ 2025 10:24:22 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type gru                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --num_layers 3 --attention_units 128
2025-05-12 22:24:22.618426: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:24:22.763451: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:24:23.338637: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:24:23.338728: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:24:23.338737: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:24:26.020735: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:24:26.668860: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:24:26.668883: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:24:26.669015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5521 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building GRU model with self-attention...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 5, 50)             14550     
                                                                 
 gru_1 (GRU)                 (None, 5, 50)             15300     
                                                                 
 gru_2 (GRU)                 (None, 5, 50)             15300     
                                                                 
 self_attention (SelfAttenti  (None, 50)               6656      
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                1275      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 53,107
Trainable params: 53,107
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 2:34 - loss: 0.2579 2/27 [=>............................] - ETA: 1s - loss: 0.2619   3/27 [==>...........................] - ETA: 1s - loss: 0.2679 4/27 [===>..........................] - ETA: 1s - loss: 0.2699 5/27 [====>.........................] - ETA: 1s - loss: 0.2604 6/27 [=====>........................] - ETA: 1s - loss: 0.2398 7/27 [======>.......................] - ETA: 1s - loss: 0.2196 8/27 [=======>......................] - ETA: 1s - loss: 0.2030 9/27 [=========>....................] - ETA: 1s - loss: 0.189010/27 [==========>...................] - ETA: 1s - loss: 0.177311/27 [===========>..................] - ETA: 1s - loss: 0.167912/27 [============>.................] - ETA: 0s - loss: 0.161813/27 [=============>................] - ETA: 0s - loss: 0.155914/27 [==============>...............] - ETA: 0s - loss: 0.152015/27 [===============>..............] - ETA: 0s - loss: 0.147316/27 [================>.............] - ETA: 0s - loss: 0.141717/27 [=================>............] - ETA: 0s - loss: 0.137418/27 [===================>..........] - ETA: 0s - loss: 0.133219/27 [====================>.........] - ETA: 0s - loss: 0.127620/27 [=====================>........] - ETA: 0s - loss: 0.124021/27 [======================>.......] - ETA: 0s - loss: 0.119922/27 [=======================>......] - ETA: 0s - loss: 0.116423/27 [========================>.....] - ETA: 0s - loss: 0.113024/27 [=========================>....] - ETA: 0s - loss: 0.109825/27 [==========================>...] - ETA: 0s - loss: 0.107326/27 [===========================>..] - ETA: 0s - loss: 0.104827/27 [==============================] - ETA: 0s - loss: 0.104527/27 [==============================] - 9s 104ms/step - loss: 0.1045 - val_loss: 0.0164 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0344 2/27 [=>............................] - ETA: 1s - loss: 0.0405 3/27 [==>...........................] - ETA: 1s - loss: 0.0443 4/27 [===>..........................] - ETA: 1s - loss: 0.0386 5/27 [====>.........................] - ETA: 1s - loss: 0.0437 6/27 [=====>........................] - ETA: 1s - loss: 0.0419 7/27 [======>.......................] - ETA: 1s - loss: 0.0383 8/27 [=======>......................] - ETA: 1s - loss: 0.0384 9/27 [=========>....................] - ETA: 1s - loss: 0.037410/27 [==========>...................] - ETA: 1s - loss: 0.035811/27 [===========>..................] - ETA: 1s - loss: 0.037312/27 [============>.................] - ETA: 1s - loss: 0.036413/27 [=============>................] - ETA: 0s - loss: 0.035514/27 [==============>...............] - ETA: 0s - loss: 0.039015/27 [===============>..............] - ETA: 0s - loss: 0.038816/27 [================>.............] - ETA: 0s - loss: 0.038417/27 [=================>............] - ETA: 0s - loss: 0.038818/27 [===================>..........] - ETA: 0s - loss: 0.038519/27 [====================>.........] - ETA: 0s - loss: 0.039420/27 [=====================>........] - ETA: 0s - loss: 0.039121/27 [======================>.......] - ETA: 0s - loss: 0.038622/27 [=======================>......] - ETA: 0s - loss: 0.037823/27 [========================>.....] - ETA: 0s - loss: 0.037524/27 [=========================>....] - ETA: 0s - loss: 0.038725/27 [==========================>...] - ETA: 0s - loss: 0.039326/27 [===========================>..] - ETA: 0s - loss: 0.039327/27 [==============================] - ETA: 0s - loss: 0.039627/27 [==============================] - 2s 73ms/step - loss: 0.0396 - val_loss: 0.0043 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0280 2/27 [=>............................] - ETA: 1s - loss: 0.0471 3/27 [==>...........................] - ETA: 1s - loss: 0.0394 4/27 [===>..........................] - ETA: 1s - loss: 0.0387 5/27 [====>.........................] - ETA: 1s - loss: 0.0351 6/27 [=====>........................] - ETA: 1s - loss: 0.0362 7/27 [======>.......................] - ETA: 1s - loss: 0.0371 8/27 [=======>......................] - ETA: 1s - loss: 0.0374 9/27 [=========>....................] - ETA: 1s - loss: 0.038010/27 [==========>...................] - ETA: 1s - loss: 0.037611/27 [===========>..................] - ETA: 1s - loss: 0.037812/27 [============>.................] - ETA: 0s - loss: 0.037913/27 [=============>................] - ETA: 0s - loss: 0.036814/27 [==============>...............] - ETA: 0s - loss: 0.035215/27 [===============>..............] - ETA: 0s - loss: 0.036716/27 [================>.............] - ETA: 0s - loss: 0.036117/27 [=================>............] - ETA: 0s - loss: 0.036118/27 [===================>..........] - ETA: 0s - loss: 0.036319/27 [====================>.........] - ETA: 0s - loss: 0.036720/27 [=====================>........] - ETA: 0s - loss: 0.036121/27 [======================>.......] - ETA: 0s - loss: 0.036422/27 [=======================>......] - ETA: 0s - loss: 0.035623/27 [========================>.....] - ETA: 0s - loss: 0.036124/27 [=========================>....] - ETA: 0s - loss: 0.035725/27 [==========================>...] - ETA: 0s - loss: 0.035426/27 [===========================>..] - ETA: 0s - loss: 0.036027/27 [==============================] - ETA: 0s - loss: 0.036027/27 [==============================] - 2s 73ms/step - loss: 0.0360 - val_loss: 0.0036 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0222 2/27 [=>............................] - ETA: 1s - loss: 0.0331 3/27 [==>...........................] - ETA: 1s - loss: 0.0438 4/27 [===>..........................] - ETA: 1s - loss: 0.0409 5/27 [====>.........................] - ETA: 1s - loss: 0.0395 6/27 [=====>........................] - ETA: 1s - loss: 0.0417 7/27 [======>.......................] - ETA: 1s - loss: 0.0387 8/27 [=======>......................] - ETA: 1s - loss: 0.0402 9/27 [=========>....................] - ETA: 1s - loss: 0.039410/27 [==========>...................] - ETA: 1s - loss: 0.039111/27 [===========>..................] - ETA: 1s - loss: 0.037712/27 [============>.................] - ETA: 1s - loss: 0.036613/27 [=============>................] - ETA: 0s - loss: 0.036014/27 [==============>...............] - ETA: 0s - loss: 0.034615/27 [===============>..............] - ETA: 0s - loss: 0.033816/27 [================>.............] - ETA: 0s - loss: 0.033817/27 [=================>............] - ETA: 0s - loss: 0.034318/27 [===================>..........] - ETA: 0s - loss: 0.034419/27 [====================>.........] - ETA: 0s - loss: 0.034420/27 [=====================>........] - ETA: 0s - loss: 0.035421/27 [======================>.......] - ETA: 0s - loss: 0.035422/27 [=======================>......] - ETA: 0s - loss: 0.036023/27 [========================>.....] - ETA: 0s - loss: 0.036324/27 [=========================>....] - ETA: 0s - loss: 0.036325/27 [==========================>...] - ETA: 0s - loss: 0.036326/27 [===========================>..] - ETA: 0s - loss: 0.036827/27 [==============================] - ETA: 0s - loss: 0.036927/27 [==============================] - 2s 72ms/step - loss: 0.0369 - val_loss: 0.0081 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0260 2/27 [=>............................] - ETA: 1s - loss: 0.0333 3/27 [==>...........................] - ETA: 1s - loss: 0.0317 4/27 [===>..........................] - ETA: 1s - loss: 0.0310 5/27 [====>.........................] - ETA: 1s - loss: 0.0435 6/27 [=====>........................] - ETA: 1s - loss: 0.0397 7/27 [======>.......................] - ETA: 1s - loss: 0.0409 8/27 [=======>......................] - ETA: 1s - loss: 0.0391 9/27 [=========>....................] - ETA: 1s - loss: 0.039610/27 [==========>...................] - ETA: 1s - loss: 0.040211/27 [===========>..................] - ETA: 1s - loss: 0.039012/27 [============>.................] - ETA: 1s - loss: 0.040413/27 [=============>................] - ETA: 0s - loss: 0.039014/27 [==============>...............] - ETA: 0s - loss: 0.039015/27 [===============>..............] - ETA: 0s - loss: 0.039316/27 [================>.............] - ETA: 0s - loss: 0.038317/27 [=================>............] - ETA: 0s - loss: 0.038418/27 [===================>..........] - ETA: 0s - loss: 0.037819/27 [====================>.........] - ETA: 0s - loss: 0.037820/27 [=====================>........] - ETA: 0s - loss: 0.037021/27 [======================>.......] - ETA: 0s - loss: 0.037022/27 [=======================>......] - ETA: 0s - loss: 0.036723/27 [========================>.....] - ETA: 0s - loss: 0.038124/27 [=========================>....] - ETA: 0s - loss: 0.037425/27 [==========================>...] - ETA: 0s - loss: 0.036526/27 [===========================>..] - ETA: 0s - loss: 0.036627/27 [==============================] - ETA: 0s - loss: 0.037027/27 [==============================] - 2s 74ms/step - loss: 0.0370 - val_loss: 9.6323e-04 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0341 2/27 [=>............................] - ETA: 1s - loss: 0.0362 3/27 [==>...........................] - ETA: 1s - loss: 0.0356 4/27 [===>..........................] - ETA: 1s - loss: 0.0342 5/27 [====>.........................] - ETA: 1s - loss: 0.0330 6/27 [=====>........................] - ETA: 1s - loss: 0.0331 7/27 [======>.......................] - ETA: 1s - loss: 0.0321 8/27 [=======>......................] - ETA: 1s - loss: 0.0348 9/27 [=========>....................] - ETA: 1s - loss: 0.034010/27 [==========>...................] - ETA: 1s - loss: 0.034611/27 [===========>..................] - ETA: 1s - loss: 0.034112/27 [============>.................] - ETA: 0s - loss: 0.033513/27 [=============>................] - ETA: 0s - loss: 0.032114/27 [==============>...............] - ETA: 0s - loss: 0.033315/27 [===============>..............] - ETA: 0s - loss: 0.032616/27 [================>.............] - ETA: 0s - loss: 0.034917/27 [=================>............] - ETA: 0s - loss: 0.034318/27 [===================>..........] - ETA: 0s - loss: 0.034319/27 [====================>.........] - ETA: 0s - loss: 0.034420/27 [=====================>........] - ETA: 0s - loss: 0.034721/27 [======================>.......] - ETA: 0s - loss: 0.034622/27 [=======================>......] - ETA: 0s - loss: 0.033923/27 [========================>.....] - ETA: 0s - loss: 0.034324/27 [=========================>....] - ETA: 0s - loss: 0.034225/27 [==========================>...] - ETA: 0s - loss: 0.035226/27 [===========================>..] - ETA: 0s - loss: 0.034827/27 [==============================] - ETA: 0s - loss: 0.034927/27 [==============================] - 2s 71ms/step - loss: 0.0349 - val_loss: 0.0024 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0479 2/27 [=>............................] - ETA: 1s - loss: 0.0343 3/27 [==>...........................] - ETA: 1s - loss: 0.0412 4/27 [===>..........................] - ETA: 1s - loss: 0.0404 5/27 [====>.........................] - ETA: 1s - loss: 0.0442 6/27 [=====>........................] - ETA: 1s - loss: 0.0414 7/27 [======>.......................] - ETA: 1s - loss: 0.0437 8/27 [=======>......................] - ETA: 1s - loss: 0.0422 9/27 [=========>....................] - ETA: 1s - loss: 0.041810/27 [==========>...................] - ETA: 1s - loss: 0.043111/27 [===========>..................] - ETA: 1s - loss: 0.041112/27 [============>.................] - ETA: 1s - loss: 0.040113/27 [=============>................] - ETA: 0s - loss: 0.038414/27 [==============>...............] - ETA: 0s - loss: 0.037815/27 [===============>..............] - ETA: 0s - loss: 0.037816/27 [================>.............] - ETA: 0s - loss: 0.036517/27 [=================>............] - ETA: 0s - loss: 0.036318/27 [===================>..........] - ETA: 0s - loss: 0.037019/27 [====================>.........] - ETA: 0s - loss: 0.036220/27 [=====================>........] - ETA: 0s - loss: 0.035421/27 [======================>.......] - ETA: 0s - loss: 0.036222/27 [=======================>......] - ETA: 0s - loss: 0.036023/27 [========================>.....] - ETA: 0s - loss: 0.035524/27 [=========================>....] - ETA: 0s - loss: 0.035725/27 [==========================>...] - ETA: 0s - loss: 0.036226/27 [===========================>..] - ETA: 0s - loss: 0.036027/27 [==============================] - ETA: 0s - loss: 0.035827/27 [==============================] - 2s 73ms/step - loss: 0.0358 - val_loss: 0.0044 - lr: 0.0010
Epoch 8/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0319 2/27 [=>............................] - ETA: 1s - loss: 0.0400 3/27 [==>...........................] - ETA: 1s - loss: 0.0348 4/27 [===>..........................] - ETA: 1s - loss: 0.0340 5/27 [====>.........................] - ETA: 1s - loss: 0.0313 6/27 [=====>........................] - ETA: 1s - loss: 0.0321 7/27 [======>.......................] - ETA: 1s - loss: 0.0312 8/27 [=======>......................] - ETA: 1s - loss: 0.0295 9/27 [=========>....................] - ETA: 1s - loss: 0.029110/27 [==========>...................] - ETA: 1s - loss: 0.031411/27 [===========>..................] - ETA: 1s - loss: 0.032812/27 [============>.................] - ETA: 1s - loss: 0.031713/27 [=============>................] - ETA: 0s - loss: 0.031614/27 [==============>...............] - ETA: 0s - loss: 0.031915/27 [===============>..............] - ETA: 0s - loss: 0.034316/27 [================>.............] - ETA: 0s - loss: 0.036017/27 [=================>............] - ETA: 0s - loss: 0.035418/27 [===================>..........] - ETA: 0s - loss: 0.034519/27 [====================>.........] - ETA: 0s - loss: 0.035520/27 [=====================>........] - ETA: 0s - loss: 0.035121/27 [======================>.......] - ETA: 0s - loss: 0.034822/27 [=======================>......] - ETA: 0s - loss: 0.034223/27 [========================>.....] - ETA: 0s - loss: 0.033924/27 [=========================>....] - ETA: 0s - loss: 0.035225/27 [==========================>...] - ETA: 0s - loss: 0.035126/27 [===========================>..] - ETA: 0s - loss: 0.035127/27 [==============================] - ETA: 0s - loss: 0.035227/27 [==============================] - 2s 73ms/step - loss: 0.0352 - val_loss: 0.0035 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.00265/5 [==============================] - 0s 13ms/step - loss: 0.0067
Test Loss: 0.006686671171337366
Saved model as forecasting_models_v5/model_gru_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for GRU model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 776ms/step
Predicted QoE for the next time step: 85.61426402116656
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/gru_deep.h5
Completed at Δευ 12 Μαΐ 2025 10:24:53 μμ EEST
=====================================================

=====================================================
Training gru model with config: wide
Starting at Δευ 12 Μαΐ 2025 10:24:53 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type gru                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --hidden_units 100 --attention_units 128
2025-05-12 22:24:53.885646: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:24:54.025442: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:24:54.609755: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:24:54.609834: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:24:54.609844: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:24:57.280413: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:24:57.964698: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:24:57.964722: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:24:57.964871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5516 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building GRU model with self-attention...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 5, 100)            44100     
                                                                 
 gru_1 (GRU)                 (None, 5, 100)            60600     
                                                                 
 self_attention (SelfAttenti  (None, 100)              13056     
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                2525      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 120,307
Trainable params: 120,307
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 1:48 - loss: 0.2481 3/27 [==>...........................] - ETA: 0s - loss: 0.1735   5/27 [====>.........................] - ETA: 0s - loss: 0.1240 7/27 [======>.......................] - ETA: 0s - loss: 0.1173 9/27 [=========>....................] - ETA: 0s - loss: 0.101211/27 [===========>..................] - ETA: 0s - loss: 0.089813/27 [=============>................] - ETA: 0s - loss: 0.081415/27 [===============>..............] - ETA: 0s - loss: 0.076817/27 [=================>............] - ETA: 0s - loss: 0.073218/27 [===================>..........] - ETA: 0s - loss: 0.071920/27 [=====================>........] - ETA: 0s - loss: 0.068122/27 [=======================>......] - ETA: 0s - loss: 0.064924/27 [=========================>....] - ETA: 0s - loss: 0.065426/27 [===========================>..] - ETA: 0s - loss: 0.062327/27 [==============================] - 6s 71ms/step - loss: 0.0623 - val_loss: 0.0159 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0258 3/27 [==>...........................] - ETA: 1s - loss: 0.0291 5/27 [====>.........................] - ETA: 0s - loss: 0.0355 7/27 [======>.......................] - ETA: 0s - loss: 0.0390 9/27 [=========>....................] - ETA: 0s - loss: 0.042511/27 [===========>..................] - ETA: 0s - loss: 0.039913/27 [=============>................] - ETA: 0s - loss: 0.040315/27 [===============>..............] - ETA: 0s - loss: 0.040617/27 [=================>............] - ETA: 0s - loss: 0.038519/27 [====================>.........] - ETA: 0s - loss: 0.037420/27 [=====================>........] - ETA: 0s - loss: 0.037821/27 [======================>.......] - ETA: 0s - loss: 0.037923/27 [========================>.....] - ETA: 0s - loss: 0.037824/27 [=========================>....] - ETA: 0s - loss: 0.037326/27 [===========================>..] - ETA: 0s - loss: 0.037227/27 [==============================] - 1s 51ms/step - loss: 0.0371 - val_loss: 0.0094 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0422 3/27 [==>...........................] - ETA: 1s - loss: 0.0393 5/27 [====>.........................] - ETA: 1s - loss: 0.0373 6/27 [=====>........................] - ETA: 0s - loss: 0.0342 8/27 [=======>......................] - ETA: 0s - loss: 0.0358 9/27 [=========>....................] - ETA: 0s - loss: 0.038111/27 [===========>..................] - ETA: 0s - loss: 0.037613/27 [=============>................] - ETA: 0s - loss: 0.036915/27 [===============>..............] - ETA: 0s - loss: 0.038016/27 [================>.............] - ETA: 0s - loss: 0.037918/27 [===================>..........] - ETA: 0s - loss: 0.038520/27 [=====================>........] - ETA: 0s - loss: 0.038422/27 [=======================>......] - ETA: 0s - loss: 0.037424/27 [=========================>....] - ETA: 0s - loss: 0.036626/27 [===========================>..] - ETA: 0s - loss: 0.036227/27 [==============================] - 1s 51ms/step - loss: 0.0360 - val_loss: 0.0020 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0249 3/27 [==>...........................] - ETA: 1s - loss: 0.0445 5/27 [====>.........................] - ETA: 1s - loss: 0.0374 7/27 [======>.......................] - ETA: 0s - loss: 0.0374 9/27 [=========>....................] - ETA: 0s - loss: 0.037710/27 [==========>...................] - ETA: 0s - loss: 0.037312/27 [============>.................] - ETA: 0s - loss: 0.036014/27 [==============>...............] - ETA: 0s - loss: 0.036916/27 [================>.............] - ETA: 0s - loss: 0.036018/27 [===================>..........] - ETA: 0s - loss: 0.036120/27 [=====================>........] - ETA: 0s - loss: 0.036322/27 [=======================>......] - ETA: 0s - loss: 0.036623/27 [========================>.....] - ETA: 0s - loss: 0.036925/27 [==========================>...] - ETA: 0s - loss: 0.035627/27 [==============================] - ETA: 0s - loss: 0.035727/27 [==============================] - 1s 51ms/step - loss: 0.0357 - val_loss: 0.0043 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0196 2/27 [=>............................] - ETA: 1s - loss: 0.0336 4/27 [===>..........................] - ETA: 1s - loss: 0.0322 6/27 [=====>........................] - ETA: 0s - loss: 0.0339 7/27 [======>.......................] - ETA: 0s - loss: 0.0329 9/27 [=========>....................] - ETA: 0s - loss: 0.036710/27 [==========>...................] - ETA: 0s - loss: 0.035112/27 [============>.................] - ETA: 0s - loss: 0.038514/27 [==============>...............] - ETA: 0s - loss: 0.037816/27 [================>.............] - ETA: 0s - loss: 0.037018/27 [===================>..........] - ETA: 0s - loss: 0.037620/27 [=====================>........] - ETA: 0s - loss: 0.038522/27 [=======================>......] - ETA: 0s - loss: 0.038123/27 [========================>.....] - ETA: 0s - loss: 0.037525/27 [==========================>...] - ETA: 0s - loss: 0.037327/27 [==============================] - ETA: 0s - loss: 0.036727/27 [==============================] - 1s 50ms/step - loss: 0.0367 - val_loss: 0.0084 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0541 3/27 [==>...........................] - ETA: 1s - loss: 0.0460 5/27 [====>.........................] - ETA: 1s - loss: 0.0382 7/27 [======>.......................] - ETA: 0s - loss: 0.0367 9/27 [=========>....................] - ETA: 0s - loss: 0.036211/27 [===========>..................] - ETA: 0s - loss: 0.034513/27 [=============>................] - ETA: 0s - loss: 0.033615/27 [===============>..............] - ETA: 0s - loss: 0.033517/27 [=================>............] - ETA: 0s - loss: 0.034719/27 [====================>.........] - ETA: 0s - loss: 0.034121/27 [======================>.......] - ETA: 0s - loss: 0.032123/27 [========================>.....] - ETA: 0s - loss: 0.033025/27 [==========================>...] - ETA: 0s - loss: 0.032727/27 [==============================] - ETA: 0s - loss: 0.033127/27 [==============================] - 1s 50ms/step - loss: 0.0331 - val_loss: 0.0095 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.00335/5 [==============================] - 0s 10ms/step - loss: 0.0052
Test Loss: 0.005173816345632076
Saved model as forecasting_models_v5/model_gru_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for GRU model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 554ms/step
Predicted QoE for the next time step: 93.86126916629911
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/gru_wide.h5
Completed at Δευ 12 Μαΐ 2025 10:25:14 μμ EEST
=====================================================

=====================================================
Training gru model with config: bidirectional
Starting at Δευ 12 Μαΐ 2025 10:25:14 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type gru                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --bidirectional --attention_units 128
2025-05-12 22:25:15.293277: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:25:15.442697: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:25:16.027616: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:25:16.027692: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:25:16.027713: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:25:18.702463: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:25:19.383362: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:25:19.383388: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:25:19.383538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5534 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building GRU model with self-attention...
Traceback (most recent call last):
  File "timeseries_forecasting_models_v5.py", line 889, in <module>
    main()
  File "timeseries_forecasting_models_v5.py", line 720, in main
    model.summary()
  File "/home/dimitris/.local/lib/python3.8/site-packages/keras/engine/training.py", line 3214, in summary
    raise ValueError(
ValueError: This model has not yet been built. Build the model first by calling `build()` or by calling the model on a batch of data.
Warning: Original model file not found at /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/model_gru_with_attention.h5
Directory contents:
total 8260
drwxrwxr-x  2 dimitris dimitris    4096 Μαΐ  12 22:25 .
drwxrwxr-x 20 dimitris dimitris    4096 Μαΐ  12 21:43 ..
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  12 22:21 dnn_basic.h5
-rw-rw-r--  1 dimitris dimitris  519208 Μαΐ  12 22:21 dnn_deep.h5
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  12 22:21 dnn_with_elu.h5
-rw-rw-r--  1 dimitris dimitris  233792 Μαΐ  12 22:21 dnn_with_high_dropout.h5
-rw-rw-r--  1 dimitris dimitris  514616 Μαΐ  12 22:24 gru_basic.h5
-rw-rw-r--  1 dimitris dimitris  709264 Μαΐ  12 22:24 gru_deep.h5
-rw-rw-r--  1 dimitris dimitris 1504352 Μαΐ  12 22:25 gru_wide.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  12 22:20 linear_basic.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  12 22:20 linear_with_elastic_net.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  12 22:20 linear_with_l1_reg.h5
-rw-rw-r--  1 dimitris dimitris   22064 Μαΐ  12 22:20 linear_with_l2_reg.h5
-rw-rw-r--  1 dimitris dimitris  628760 Μαΐ  12 22:22 lstm_basic.h5
-rw-rw-r--  1 dimitris dimitris  881952 Μαΐ  12 22:22 lstm_deep.h5
-rw-rw-r--  1 dimitris dimitris 1914264 Μαΐ  12 22:23 lstm_wide.h5
-rw-rw-r--  1 dimitris dimitris  628760 Μαΐ  12 22:23 lstm_with_stats.h5
-rw-rw-r--  1 dimitris dimitris    3463 Μαΐ  12 22:25 scaler.save
-rw-rw-r--  1 dimitris dimitris  311148 Μαΐ  12 22:25 training_log.txt
Completed at Δευ 12 Μαΐ 2025 10:25:21 μμ EEST
=====================================================

=====================================================
Training gru model with config: with_stats
Starting at Δευ 12 Μαΐ 2025 10:25:21 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type gru                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --attention_units 128
2025-05-12 22:25:22.368997: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:25:22.517290: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:25:23.099831: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:25:23.099909: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:25:23.099929: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:25:25.768627: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:25:26.426797: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:25:26.426822: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:25:26.426958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5537 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer gru will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
WARNING:tensorflow:Layer gru_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building GRU model with self-attention...
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 5, 50)             14550     
                                                                 
 gru_1 (GRU)                 (None, 5, 50)             15300     
                                                                 
 self_attention (SelfAttenti  (None, 50)               6656      
 on)                                                             
                                                                 
 dense (Dense)               (None, 25)                1275      
                                                                 
 dense_1 (Dense)             (None, 1)                 26        
                                                                 
=================================================================
Total params: 37,807
Trainable params: 37,807
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 1:47 - loss: 0.2847 3/27 [==>...........................] - ETA: 1s - loss: 0.2736   5/27 [====>.........................] - ETA: 0s - loss: 0.2375 7/27 [======>.......................] - ETA: 0s - loss: 0.1903 9/27 [=========>....................] - ETA: 0s - loss: 0.171011/27 [===========>..................] - ETA: 0s - loss: 0.159513/27 [=============>................] - ETA: 0s - loss: 0.146915/27 [===============>..............] - ETA: 0s - loss: 0.134917/27 [=================>............] - ETA: 0s - loss: 0.125819/27 [====================>.........] - ETA: 0s - loss: 0.115221/27 [======================>.......] - ETA: 0s - loss: 0.108623/27 [========================>.....] - ETA: 0s - loss: 0.100924/27 [=========================>....] - ETA: 0s - loss: 0.098226/27 [===========================>..] - ETA: 0s - loss: 0.094527/27 [==============================] - 6s 71ms/step - loss: 0.0943 - val_loss: 0.0132 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0329 3/27 [==>...........................] - ETA: 0s - loss: 0.0470 5/27 [====>.........................] - ETA: 0s - loss: 0.0394 7/27 [======>.......................] - ETA: 0s - loss: 0.0364 9/27 [=========>....................] - ETA: 0s - loss: 0.037311/27 [===========>..................] - ETA: 0s - loss: 0.037613/27 [=============>................] - ETA: 0s - loss: 0.037215/27 [===============>..............] - ETA: 0s - loss: 0.037517/27 [=================>............] - ETA: 0s - loss: 0.036719/27 [====================>.........] - ETA: 0s - loss: 0.038320/27 [=====================>........] - ETA: 0s - loss: 0.038621/27 [======================>.......] - ETA: 0s - loss: 0.038223/27 [========================>.....] - ETA: 0s - loss: 0.038725/27 [==========================>...] - ETA: 0s - loss: 0.038226/27 [===========================>..] - ETA: 0s - loss: 0.038127/27 [==============================] - 1s 49ms/step - loss: 0.0383 - val_loss: 0.0143 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0425 2/27 [=>............................] - ETA: 1s - loss: 0.0408 4/27 [===>..........................] - ETA: 1s - loss: 0.0341 6/27 [=====>........................] - ETA: 1s - loss: 0.0376 7/27 [======>.......................] - ETA: 0s - loss: 0.0358 9/27 [=========>....................] - ETA: 0s - loss: 0.033611/27 [===========>..................] - ETA: 0s - loss: 0.033713/27 [=============>................] - ETA: 0s - loss: 0.035215/27 [===============>..............] - ETA: 0s - loss: 0.033717/27 [=================>............] - ETA: 0s - loss: 0.035119/27 [====================>.........] - ETA: 0s - loss: 0.036021/27 [======================>.......] - ETA: 0s - loss: 0.035523/27 [========================>.....] - ETA: 0s - loss: 0.035025/27 [==========================>...] - ETA: 0s - loss: 0.035927/27 [==============================] - ETA: 0s - loss: 0.036827/27 [==============================] - 1s 49ms/step - loss: 0.0368 - val_loss: 0.0100 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0577 2/27 [=>............................] - ETA: 1s - loss: 0.0661 3/27 [==>...........................] - ETA: 1s - loss: 0.0623 4/27 [===>..........................] - ETA: 1s - loss: 0.0508 6/27 [=====>........................] - ETA: 1s - loss: 0.0451 8/27 [=======>......................] - ETA: 0s - loss: 0.0432 9/27 [=========>....................] - ETA: 0s - loss: 0.041611/27 [===========>..................] - ETA: 0s - loss: 0.041413/27 [=============>................] - ETA: 0s - loss: 0.041614/27 [==============>...............] - ETA: 0s - loss: 0.041316/27 [================>.............] - ETA: 0s - loss: 0.040818/27 [===================>..........] - ETA: 0s - loss: 0.039420/27 [=====================>........] - ETA: 0s - loss: 0.037522/27 [=======================>......] - ETA: 0s - loss: 0.036523/27 [========================>.....] - ETA: 0s - loss: 0.035924/27 [=========================>....] - ETA: 0s - loss: 0.035926/27 [===========================>..] - ETA: 0s - loss: 0.035827/27 [==============================] - 1s 53ms/step - loss: 0.0356 - val_loss: 0.0072 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0221 3/27 [==>...........................] - ETA: 1s - loss: 0.0276 5/27 [====>.........................] - ETA: 1s - loss: 0.0302 7/27 [======>.......................] - ETA: 0s - loss: 0.0310 8/27 [=======>......................] - ETA: 0s - loss: 0.030110/27 [==========>...................] - ETA: 0s - loss: 0.030112/27 [============>.................] - ETA: 0s - loss: 0.032314/27 [==============>...............] - ETA: 0s - loss: 0.033016/27 [================>.............] - ETA: 0s - loss: 0.033118/27 [===================>..........] - ETA: 0s - loss: 0.034720/27 [=====================>........] - ETA: 0s - loss: 0.034022/27 [=======================>......] - ETA: 0s - loss: 0.033824/27 [=========================>....] - ETA: 0s - loss: 0.034026/27 [===========================>..] - ETA: 0s - loss: 0.035227/27 [==============================] - 1s 50ms/step - loss: 0.0353 - val_loss: 0.0080 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0301 3/27 [==>...........................] - ETA: 1s - loss: 0.0284 5/27 [====>.........................] - ETA: 0s - loss: 0.0368 6/27 [=====>........................] - ETA: 0s - loss: 0.0345 8/27 [=======>......................] - ETA: 0s - loss: 0.0360 9/27 [=========>....................] - ETA: 0s - loss: 0.035111/27 [===========>..................] - ETA: 0s - loss: 0.033913/27 [=============>................] - ETA: 0s - loss: 0.033915/27 [===============>..............] - ETA: 0s - loss: 0.035217/27 [=================>............] - ETA: 0s - loss: 0.034519/27 [====================>.........] - ETA: 0s - loss: 0.035421/27 [======================>.......] - ETA: 0s - loss: 0.036023/27 [========================>.....] - ETA: 0s - loss: 0.036525/27 [==========================>...] - ETA: 0s - loss: 0.035727/27 [==============================] - ETA: 0s - loss: 0.035027/27 [==============================] - 1s 49ms/step - loss: 0.0350 - val_loss: 0.0046 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0465 3/27 [==>...........................] - ETA: 1s - loss: 0.0406 5/27 [====>.........................] - ETA: 1s - loss: 0.0357 7/27 [======>.......................] - ETA: 0s - loss: 0.0356 9/27 [=========>....................] - ETA: 0s - loss: 0.036511/27 [===========>..................] - ETA: 0s - loss: 0.035912/27 [============>.................] - ETA: 0s - loss: 0.034114/27 [==============>...............] - ETA: 0s - loss: 0.035015/27 [===============>..............] - ETA: 0s - loss: 0.035517/27 [=================>............] - ETA: 0s - loss: 0.035119/27 [====================>.........] - ETA: 0s - loss: 0.035321/27 [======================>.......] - ETA: 0s - loss: 0.035123/27 [========================>.....] - ETA: 0s - loss: 0.034925/27 [==========================>...] - ETA: 0s - loss: 0.035027/27 [==============================] - ETA: 0s - loss: 0.034627/27 [==============================] - 1s 50ms/step - loss: 0.0346 - val_loss: 0.0034 - lr: 0.0010
Epoch 8/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0332 3/27 [==>...........................] - ETA: 1s - loss: 0.0357 5/27 [====>.........................] - ETA: 1s - loss: 0.0374 7/27 [======>.......................] - ETA: 0s - loss: 0.0360 9/27 [=========>....................] - ETA: 0s - loss: 0.035611/27 [===========>..................] - ETA: 0s - loss: 0.038913/27 [=============>................] - ETA: 0s - loss: 0.036015/27 [===============>..............] - ETA: 0s - loss: 0.034617/27 [=================>............] - ETA: 0s - loss: 0.034619/27 [====================>.........] - ETA: 0s - loss: 0.033421/27 [======================>.......] - ETA: 0s - loss: 0.033623/27 [========================>.....] - ETA: 0s - loss: 0.033425/27 [==========================>...] - ETA: 0s - loss: 0.033727/27 [==============================] - ETA: 0s - loss: 0.034527/27 [==============================] - 1s 49ms/step - loss: 0.0345 - val_loss: 0.0048 - lr: 0.0010
Epoch 9/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0437 3/27 [==>...........................] - ETA: 1s - loss: 0.0414 5/27 [====>.........................] - ETA: 1s - loss: 0.0390 7/27 [======>.......................] - ETA: 0s - loss: 0.0387 9/27 [=========>....................] - ETA: 0s - loss: 0.039311/27 [===========>..................] - ETA: 0s - loss: 0.039312/27 [============>.................] - ETA: 0s - loss: 0.039214/27 [==============>...............] - ETA: 0s - loss: 0.038316/27 [================>.............] - ETA: 0s - loss: 0.037917/27 [=================>............] - ETA: 0s - loss: 0.038118/27 [===================>..........] - ETA: 0s - loss: 0.037820/27 [=====================>........] - ETA: 0s - loss: 0.036922/27 [=======================>......] - ETA: 0s - loss: 0.036324/27 [=========================>....] - ETA: 0s - loss: 0.035626/27 [===========================>..] - ETA: 0s - loss: 0.035027/27 [==============================] - 1s 51ms/step - loss: 0.0349 - val_loss: 0.0027 - lr: 0.0010
Epoch 10/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0292 3/27 [==>...........................] - ETA: 1s - loss: 0.0341 5/27 [====>.........................] - ETA: 0s - loss: 0.0429 7/27 [======>.......................] - ETA: 0s - loss: 0.0378 9/27 [=========>....................] - ETA: 0s - loss: 0.041011/27 [===========>..................] - ETA: 0s - loss: 0.039413/27 [=============>................] - ETA: 0s - loss: 0.037915/27 [===============>..............] - ETA: 0s - loss: 0.036117/27 [=================>............] - ETA: 0s - loss: 0.038319/27 [====================>.........] - ETA: 0s - loss: 0.036921/27 [======================>.......] - ETA: 0s - loss: 0.036423/27 [========================>.....] - ETA: 0s - loss: 0.035525/27 [==========================>...] - ETA: 0s - loss: 0.036526/27 [===========================>..] - ETA: 0s - loss: 0.036127/27 [==============================] - 1s 50ms/step - loss: 0.0360 - val_loss: 0.0102 - lr: 0.0010
Epoch 11/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0216 3/27 [==>...........................] - ETA: 1s - loss: 0.0252 5/27 [====>.........................] - ETA: 0s - loss: 0.0272 7/27 [======>.......................] - ETA: 0s - loss: 0.0339 9/27 [=========>....................] - ETA: 0s - loss: 0.034611/27 [===========>..................] - ETA: 0s - loss: 0.035313/27 [=============>................] - ETA: 0s - loss: 0.035614/27 [==============>...............] - ETA: 0s - loss: 0.035716/27 [================>.............] - ETA: 0s - loss: 0.036518/27 [===================>..........] - ETA: 0s - loss: 0.036020/27 [=====================>........] - ETA: 0s - loss: 0.035322/27 [=======================>......] - ETA: 0s - loss: 0.036124/27 [=========================>....] - ETA: 0s - loss: 0.035326/27 [===========================>..] - ETA: 0s - loss: 0.034627/27 [==============================] - 1s 50ms/step - loss: 0.0345 - val_loss: 0.0019 - lr: 0.0010
Epoch 12/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0262 3/27 [==>...........................] - ETA: 1s - loss: 0.0276 5/27 [====>.........................] - ETA: 1s - loss: 0.0263 7/27 [======>.......................] - ETA: 0s - loss: 0.0293 9/27 [=========>....................] - ETA: 0s - loss: 0.029311/27 [===========>..................] - ETA: 0s - loss: 0.029713/27 [=============>................] - ETA: 0s - loss: 0.031015/27 [===============>..............] - ETA: 0s - loss: 0.031617/27 [=================>............] - ETA: 0s - loss: 0.030319/27 [====================>.........] - ETA: 0s - loss: 0.030321/27 [======================>.......] - ETA: 0s - loss: 0.031422/27 [=======================>......] - ETA: 0s - loss: 0.030823/27 [========================>.....] - ETA: 0s - loss: 0.031824/27 [=========================>....] - ETA: 0s - loss: 0.031925/27 [==========================>...] - ETA: 0s - loss: 0.031927/27 [==============================] - ETA: 0s - loss: 0.033527/27 [==============================] - 1s 50ms/step - loss: 0.0335 - val_loss: 0.0093 - lr: 0.0010
Epoch 13/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0132 2/27 [=>............................] - ETA: 1s - loss: 0.0190 4/27 [===>..........................] - ETA: 1s - loss: 0.0271 6/27 [=====>........................] - ETA: 1s - loss: 0.0323 8/27 [=======>......................] - ETA: 0s - loss: 0.030510/27 [==========>...................] - ETA: 0s - loss: 0.031711/27 [===========>..................] - ETA: 0s - loss: 0.031413/27 [=============>................] - ETA: 0s - loss: 0.032615/27 [===============>..............] - ETA: 0s - loss: 0.034117/27 [=================>............] - ETA: 0s - loss: 0.034919/27 [====================>.........] - ETA: 0s - loss: 0.036220/27 [=====================>........] - ETA: 0s - loss: 0.036422/27 [=======================>......] - ETA: 0s - loss: 0.036623/27 [========================>.....] - ETA: 0s - loss: 0.036725/27 [==========================>...] - ETA: 0s - loss: 0.036026/27 [===========================>..] - ETA: 0s - loss: 0.035627/27 [==============================] - 1s 51ms/step - loss: 0.0355 - val_loss: 0.0057 - lr: 0.0010
Epoch 14/20
 1/27 [>.............................] - ETA: 1s - loss: 0.0375 2/27 [=>............................] - ETA: 1s - loss: 0.0318 3/27 [==>...........................] - ETA: 1s - loss: 0.0314 4/27 [===>..........................] - ETA: 1s - loss: 0.0318 6/27 [=====>........................] - ETA: 1s - loss: 0.0329 7/27 [======>.......................] - ETA: 0s - loss: 0.0419 9/27 [=========>....................] - ETA: 0s - loss: 0.036311/27 [===========>..................] - ETA: 0s - loss: 0.035412/27 [============>.................] - ETA: 0s - loss: 0.034114/27 [==============>...............] - ETA: 0s - loss: 0.034316/27 [================>.............] - ETA: 0s - loss: 0.034717/27 [=================>............] - ETA: 0s - loss: 0.034419/27 [====================>.........] - ETA: 0s - loss: 0.033321/27 [======================>.......] - ETA: 0s - loss: 0.033522/27 [=======================>......] - ETA: 0s - loss: 0.034323/27 [========================>.....] - ETA: 0s - loss: 0.034825/27 [==========================>...] - ETA: 0s - loss: 0.034127/27 [==============================] - ETA: 0s - loss: 0.035127/27 [==============================] - 1s 53ms/step - loss: 0.0351 - val_loss: 0.0084 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.00325/5 [==============================] - 0s 11ms/step - loss: 0.0064
Test Loss: 0.006398700177669525
Saved model as forecasting_models_v5/model_gru_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for GRU model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 570ms/step
Predicted QoE for the next time step: 89.79092359131216
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/gru_with_stats.h5
Completed at Δευ 12 Μαΐ 2025 10:25:54 μμ EEST
=====================================================

=====================================================
Training transformer model with config: basic
Starting at Δευ 12 Μαΐ 2025 10:25:54 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type transformer                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 
2025-05-12 22:25:54.554896: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:25:54.699539: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:25:55.274469: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:25:55.274548: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:25:55.274557: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:25:57.965144: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:25:58.626932: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:25:58.626968: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:25:58.627091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5536 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Transformer model...
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5, 45)]           0         
                                                                 
 transformer_block (Transfor  (None, 5, 45)            22564     
 merBlock)                                                       
                                                                 
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense_2 (Dense)             (None, 32)                7232      
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 29,829
Trainable params: 29,829
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 38s - loss: 0.3577 8/27 [=======>......................] - ETA: 0s - loss: 0.1607 15/27 [===============>..............] - ETA: 0s - loss: 0.126522/27 [=======================>......] - ETA: 0s - loss: 0.104227/27 [==============================] - 2s 19ms/step - loss: 0.0981 - val_loss: 0.0222 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0691 8/27 [=======>......................] - ETA: 0s - loss: 0.054715/27 [===============>..............] - ETA: 0s - loss: 0.051722/27 [=======================>......] - ETA: 0s - loss: 0.047627/27 [==============================] - 0s 10ms/step - loss: 0.0469 - val_loss: 0.0273 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0595 8/27 [=======>......................] - ETA: 0s - loss: 0.043314/27 [==============>...............] - ETA: 0s - loss: 0.049621/27 [======================>.......] - ETA: 0s - loss: 0.044527/27 [==============================] - ETA: 0s - loss: 0.045727/27 [==============================] - 0s 11ms/step - loss: 0.0457 - val_loss: 0.0154 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0488 7/27 [======>.......................] - ETA: 0s - loss: 0.044913/27 [=============>................] - ETA: 0s - loss: 0.046520/27 [=====================>........] - ETA: 0s - loss: 0.043927/27 [==============================] - ETA: 0s - loss: 0.040927/27 [==============================] - 0s 11ms/step - loss: 0.0409 - val_loss: 0.0110 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0213 8/27 [=======>......................] - ETA: 0s - loss: 0.034314/27 [==============>...............] - ETA: 0s - loss: 0.035820/27 [=====================>........] - ETA: 0s - loss: 0.037126/27 [===========================>..] - ETA: 0s - loss: 0.036927/27 [==============================] - 0s 11ms/step - loss: 0.0368 - val_loss: 0.0153 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0247 8/27 [=======>......................] - ETA: 0s - loss: 0.035814/27 [==============>...............] - ETA: 0s - loss: 0.035220/27 [=====================>........] - ETA: 0s - loss: 0.034026/27 [===========================>..] - ETA: 0s - loss: 0.037427/27 [==============================] - 0s 11ms/step - loss: 0.0373 - val_loss: 0.0414 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0202 8/27 [=======>......................] - ETA: 0s - loss: 0.035215/27 [===============>..............] - ETA: 0s - loss: 0.037321/27 [======================>.......] - ETA: 0s - loss: 0.036627/27 [==============================] - ETA: 0s - loss: 0.036627/27 [==============================] - 0s 11ms/step - loss: 0.0366 - val_loss: 0.0223 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.01365/5 [==============================] - 0s 4ms/step - loss: 0.0113
Test Loss: 0.011312529444694519
Saved model as forecasting_models_v5/model_transformer_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for TRANSFORMER model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 183ms/step
Predicted QoE for the next time step: 77.82106202512622
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/transformer_basic.h5
Completed at Δευ 12 Μαΐ 2025 10:26:05 μμ EEST
=====================================================

=====================================================
Training transformer model with config: more_heads
Starting at Δευ 12 Μαΐ 2025 10:26:05 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type transformer                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --num_heads 4
2025-05-12 22:26:06.139701: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:26:06.290572: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:26:06.862760: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:26:06.862853: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:26:06.862864: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:26:09.518089: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:26:10.183511: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:26:10.183535: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:26:10.183670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5536 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Transformer model...
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5, 45)]           0         
                                                                 
 transformer_block (Transfor  (None, 5, 45)            39034     
 merBlock)                                                       
                                                                 
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense_2 (Dense)             (None, 32)                7232      
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 46,299
Trainable params: 46,299
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 38s - loss: 0.6539 8/27 [=======>......................] - ETA: 0s - loss: 0.3125 15/27 [===============>..............] - ETA: 0s - loss: 0.223422/27 [=======================>......] - ETA: 0s - loss: 0.177327/27 [==============================] - 2s 20ms/step - loss: 0.1587 - val_loss: 0.0424 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0256 8/27 [=======>......................] - ETA: 0s - loss: 0.053715/27 [===============>..............] - ETA: 0s - loss: 0.056021/27 [======================>.......] - ETA: 0s - loss: 0.053527/27 [==============================] - 0s 10ms/step - loss: 0.0560 - val_loss: 0.0371 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0611 7/27 [======>.......................] - ETA: 0s - loss: 0.052514/27 [==============>...............] - ETA: 0s - loss: 0.056221/27 [======================>.......] - ETA: 0s - loss: 0.053827/27 [==============================] - 0s 10ms/step - loss: 0.0527 - val_loss: 0.0375 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0393 8/27 [=======>......................] - ETA: 0s - loss: 0.045614/27 [==============>...............] - ETA: 0s - loss: 0.043321/27 [======================>.......] - ETA: 0s - loss: 0.041427/27 [==============================] - ETA: 0s - loss: 0.040127/27 [==============================] - 0s 11ms/step - loss: 0.0401 - val_loss: 0.0263 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0333 7/27 [======>.......................] - ETA: 0s - loss: 0.042214/27 [==============>...............] - ETA: 0s - loss: 0.042921/27 [======================>.......] - ETA: 0s - loss: 0.040027/27 [==============================] - ETA: 0s - loss: 0.038127/27 [==============================] - 0s 11ms/step - loss: 0.0381 - val_loss: 0.0180 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0496 7/27 [======>.......................] - ETA: 0s - loss: 0.043513/27 [=============>................] - ETA: 0s - loss: 0.042719/27 [====================>.........] - ETA: 0s - loss: 0.040325/27 [==========================>...] - ETA: 0s - loss: 0.039427/27 [==============================] - 0s 11ms/step - loss: 0.0387 - val_loss: 0.0153 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0319 7/27 [======>.......................] - ETA: 0s - loss: 0.040713/27 [=============>................] - ETA: 0s - loss: 0.041520/27 [=====================>........] - ETA: 0s - loss: 0.039526/27 [===========================>..] - ETA: 0s - loss: 0.037927/27 [==============================] - 0s 11ms/step - loss: 0.0377 - val_loss: 0.0074 - lr: 0.0010
Epoch 8/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0496 8/27 [=======>......................] - ETA: 0s - loss: 0.041515/27 [===============>..............] - ETA: 0s - loss: 0.037921/27 [======================>.......] - ETA: 0s - loss: 0.035627/27 [==============================] - ETA: 0s - loss: 0.037027/27 [==============================] - 0s 11ms/step - loss: 0.0370 - val_loss: 0.0159 - lr: 0.0010
Epoch 9/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0211 7/27 [======>.......................] - ETA: 0s - loss: 0.030014/27 [==============>...............] - ETA: 0s - loss: 0.036221/27 [======================>.......] - ETA: 0s - loss: 0.036127/27 [==============================] - 0s 11ms/step - loss: 0.0361 - val_loss: 0.0030 - lr: 0.0010
Epoch 10/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0496 7/27 [======>.......................] - ETA: 0s - loss: 0.038713/27 [=============>................] - ETA: 0s - loss: 0.035120/27 [=====================>........] - ETA: 0s - loss: 0.035326/27 [===========================>..] - ETA: 0s - loss: 0.034627/27 [==============================] - 0s 11ms/step - loss: 0.0345 - val_loss: 0.0036 - lr: 0.0010
Epoch 11/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0461 7/27 [======>.......................] - ETA: 0s - loss: 0.037114/27 [==============>...............] - ETA: 0s - loss: 0.034920/27 [=====================>........] - ETA: 0s - loss: 0.034927/27 [==============================] - ETA: 0s - loss: 0.035627/27 [==============================] - 0s 11ms/step - loss: 0.0356 - val_loss: 0.0111 - lr: 0.0010
Epoch 12/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0304 7/27 [======>.......................] - ETA: 0s - loss: 0.031813/27 [=============>................] - ETA: 0s - loss: 0.033519/27 [====================>.........] - ETA: 0s - loss: 0.034825/27 [==========================>...] - ETA: 0s - loss: 0.034127/27 [==============================] - 0s 12ms/step - loss: 0.0337 - val_loss: 0.0047 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.00225/5 [==============================] - 0s 4ms/step - loss: 9.9205e-04
Test Loss: 0.0009920487646013498
Saved model as forecasting_models_v5/model_transformer_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for TRANSFORMER model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 182ms/step
Predicted QoE for the next time step: 54.768080209007266
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/transformer_more_heads.h5
Completed at Δευ 12 Μαΐ 2025 10:26:18 μμ EEST
=====================================================

=====================================================
Training transformer model with config: large_ff
Starting at Δευ 12 Μαΐ 2025 10:26:18 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type transformer                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --ff_dim 128
2025-05-12 22:26:19.236780: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:26:19.376726: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:26:19.956683: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:26:19.956776: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:26:19.956785: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:26:22.615191: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:26:23.256108: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:26:23.256144: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:26:23.256276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5534 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Transformer model...
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5, 45)]           0         
                                                                 
 transformer_block (Transfor  (None, 5, 45)            28388     
 merBlock)                                                       
                                                                 
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense_2 (Dense)             (None, 32)                7232      
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 35,653
Trainable params: 35,653
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 39s - loss: 0.6431 7/27 [======>.......................] - ETA: 0s - loss: 0.5205 14/27 [==============>...............] - ETA: 0s - loss: 0.358220/27 [=====================>........] - ETA: 0s - loss: 0.289726/27 [===========================>..] - ETA: 0s - loss: 0.257927/27 [==============================] - 2s 21ms/step - loss: 0.2582 - val_loss: 0.0736 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.1000 8/27 [=======>......................] - ETA: 0s - loss: 0.129615/27 [===============>..............] - ETA: 0s - loss: 0.111721/27 [======================>.......] - ETA: 0s - loss: 0.105027/27 [==============================] - ETA: 0s - loss: 0.102827/27 [==============================] - 0s 11ms/step - loss: 0.1028 - val_loss: 0.0158 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0904 8/27 [=======>......................] - ETA: 0s - loss: 0.081514/27 [==============>...............] - ETA: 0s - loss: 0.077220/27 [=====================>........] - ETA: 0s - loss: 0.075526/27 [===========================>..] - ETA: 0s - loss: 0.072827/27 [==============================] - 0s 11ms/step - loss: 0.0727 - val_loss: 0.0048 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0396 8/27 [=======>......................] - ETA: 0s - loss: 0.059414/27 [==============>...............] - ETA: 0s - loss: 0.058320/27 [=====================>........] - ETA: 0s - loss: 0.056726/27 [===========================>..] - ETA: 0s - loss: 0.053827/27 [==============================] - 0s 11ms/step - loss: 0.0536 - val_loss: 0.0107 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0643 8/27 [=======>......................] - ETA: 0s - loss: 0.057214/27 [==============>...............] - ETA: 0s - loss: 0.053720/27 [=====================>........] - ETA: 0s - loss: 0.049226/27 [===========================>..] - ETA: 0s - loss: 0.044927/27 [==============================] - 0s 11ms/step - loss: 0.0457 - val_loss: 0.0093 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0580 8/27 [=======>......................] - ETA: 0s - loss: 0.048814/27 [==============>...............] - ETA: 0s - loss: 0.048420/27 [=====================>........] - ETA: 0s - loss: 0.050326/27 [===========================>..] - ETA: 0s - loss: 0.048227/27 [==============================] - 0s 11ms/step - loss: 0.0480 - val_loss: 0.0049 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.00985/5 [==============================] - 0s 3ms/step - loss: 0.0165
Test Loss: 0.01651419885456562
Saved model as forecasting_models_v5/model_transformer_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for TRANSFORMER model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 181ms/step
Predicted QoE for the next time step: 14.603321019128858
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/transformer_large_ff.h5
Completed at Δευ 12 Μαΐ 2025 10:26:30 μμ EEST
=====================================================

=====================================================
Training transformer model with config: low_dropout
Starting at Δευ 12 Μαΐ 2025 10:26:30 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type transformer                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 --dropout_rate 0.05
2025-05-12 22:26:30.564924: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:26:30.706809: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:26:31.294640: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:26:31.294719: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:26:31.294732: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:26:33.955890: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:26:34.636552: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:26:34.636575: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:26:34.636703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5536 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Transformer model...
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5, 45)]           0         
                                                                 
 transformer_block (Transfor  (None, 5, 45)            22564     
 merBlock)                                                       
                                                                 
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense_2 (Dense)             (None, 32)                7232      
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 29,829
Trainable params: 29,829
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 38s - loss: 0.3624 8/27 [=======>......................] - ETA: 0s - loss: 0.2079 15/27 [===============>..............] - ETA: 0s - loss: 0.173822/27 [=======================>......] - ETA: 0s - loss: 0.139127/27 [==============================] - 2s 20ms/step - loss: 0.1302 - val_loss: 0.0103 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0675 8/27 [=======>......................] - ETA: 0s - loss: 0.050715/27 [===============>..............] - ETA: 0s - loss: 0.047522/27 [=======================>......] - ETA: 0s - loss: 0.047727/27 [==============================] - 0s 10ms/step - loss: 0.0474 - val_loss: 0.0082 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0238 8/27 [=======>......................] - ETA: 0s - loss: 0.030414/27 [==============>...............] - ETA: 0s - loss: 0.029120/27 [=====================>........] - ETA: 0s - loss: 0.035026/27 [===========================>..] - ETA: 0s - loss: 0.038127/27 [==============================] - 0s 11ms/step - loss: 0.0380 - val_loss: 0.0111 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0428 7/27 [======>.......................] - ETA: 0s - loss: 0.036713/27 [=============>................] - ETA: 0s - loss: 0.036619/27 [====================>.........] - ETA: 0s - loss: 0.035126/27 [===========================>..] - ETA: 0s - loss: 0.036427/27 [==============================] - 0s 11ms/step - loss: 0.0371 - val_loss: 0.0019 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0533 8/27 [=======>......................] - ETA: 0s - loss: 0.044914/27 [==============>...............] - ETA: 0s - loss: 0.042020/27 [=====================>........] - ETA: 0s - loss: 0.041927/27 [==============================] - ETA: 0s - loss: 0.038027/27 [==============================] - 0s 11ms/step - loss: 0.0380 - val_loss: 0.0086 - lr: 0.0010
Epoch 6/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0306 7/27 [======>.......................] - ETA: 0s - loss: 0.029013/27 [=============>................] - ETA: 0s - loss: 0.034219/27 [====================>.........] - ETA: 0s - loss: 0.033525/27 [==========================>...] - ETA: 0s - loss: 0.033827/27 [==============================] - 0s 11ms/step - loss: 0.0332 - val_loss: 0.0050 - lr: 0.0010
Epoch 7/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0425 8/27 [=======>......................] - ETA: 0s - loss: 0.035615/27 [===============>..............] - ETA: 0s - loss: 0.034422/27 [=======================>......] - ETA: 0s - loss: 0.034527/27 [==============================] - 0s 11ms/step - loss: 0.0340 - val_loss: 0.0026 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.00165/5 [==============================] - 0s 4ms/step - loss: 9.3640e-04
Test Loss: 0.0009364007855765522
Saved model as forecasting_models_v5/model_transformer_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for TRANSFORMER model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 183ms/step
Predicted QoE for the next time step: 122.8564718416357
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/transformer_low_dropout.h5
Completed at Δευ 12 Μαΐ 2025 10:26:41 μμ EEST
=====================================================

=====================================================
Training transformer model with config: with_stats
Starting at Δευ 12 Μαΐ 2025 10:26:41 μμ EEST
=====================================================
Command: python3 timeseries_forecasting_models_v5.py                 --data_folder ./real_dataset_3                 --model_type transformer                 --seq_length 5                 --epochs 20                 --batch_size 16                 --augmented                 --use_stats                 
2025-05-12 22:26:42.183364: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:26:42.329664: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-12 22:26:42.903338: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:26:42.903421: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:/usr/local/cuda-11.2/lib64:/usr/lib/cuda/include:/usr/lib/cuda/lib64:
2025-05-12 22:26:42.903431: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2025-05-12 22:26:45.572258: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-12 22:26:46.269028: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2025-05-12 22:26:46.269063: I tensorflow/core/common_runtime/gpu/gpu_process_state.cc:222] Using CUDA malloc Async allocator for GPU: 0
2025-05-12 22:26:46.269188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5534 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5
Loading augmented dataset from: ./real_dataset_3
Using new format
Dataset shape: (659, 47)
Features: 45
Sample timestamp: 2025-04-02 12:19:54
Total sequences: 654
Input shape: (654, 5, 45)
Training samples: 523 Test samples: 131
Building Transformer model...
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5, 45)]           0         
                                                                 
 transformer_block (Transfor  (None, 5, 45)            22564     
 merBlock)                                                       
                                                                 
 flatten (Flatten)           (None, 225)               0         
                                                                 
 dense_2 (Dense)             (None, 32)                7232      
                                                                 
 dense_3 (Dense)             (None, 1)                 33        
                                                                 
=================================================================
Total params: 29,829
Trainable params: 29,829
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
 1/27 [>.............................] - ETA: 37s - loss: 1.5874 8/27 [=======>......................] - ETA: 0s - loss: 0.4662 15/27 [===============>..............] - ETA: 0s - loss: 0.306322/27 [=======================>......] - ETA: 0s - loss: 0.230127/27 [==============================] - 2s 20ms/step - loss: 0.2024 - val_loss: 0.0038 - lr: 0.0010
Epoch 2/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0387 9/27 [=========>....................] - ETA: 0s - loss: 0.058415/27 [===============>..............] - ETA: 0s - loss: 0.056021/27 [======================>.......] - ETA: 0s - loss: 0.049727/27 [==============================] - ETA: 0s - loss: 0.046627/27 [==============================] - 0s 11ms/step - loss: 0.0466 - val_loss: 0.0011 - lr: 0.0010
Epoch 3/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0338 7/27 [======>.......................] - ETA: 0s - loss: 0.038013/27 [=============>................] - ETA: 0s - loss: 0.032419/27 [====================>.........] - ETA: 0s - loss: 0.035726/27 [===========================>..] - ETA: 0s - loss: 0.039127/27 [==============================] - 0s 11ms/step - loss: 0.0391 - val_loss: 0.0028 - lr: 0.0010
Epoch 4/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0200 7/27 [======>.......................] - ETA: 0s - loss: 0.034613/27 [=============>................] - ETA: 0s - loss: 0.035719/27 [====================>.........] - ETA: 0s - loss: 0.033925/27 [==========================>...] - ETA: 0s - loss: 0.035127/27 [==============================] - 0s 11ms/step - loss: 0.0350 - val_loss: 0.0042 - lr: 0.0010
Epoch 5/20
 1/27 [>.............................] - ETA: 0s - loss: 0.0436 7/27 [======>.......................] - ETA: 0s - loss: 0.046013/27 [=============>................] - ETA: 0s - loss: 0.039619/27 [====================>.........] - ETA: 0s - loss: 0.040826/27 [===========================>..] - ETA: 0s - loss: 0.038027/27 [==============================] - 0s 11ms/step - loss: 0.0378 - val_loss: 0.0015 - lr: 5.0000e-04
1/5 [=====>........................] - ETA: 0s - loss: 0.00285/5 [==============================] - 0s 4ms/step - loss: 0.0075
Test Loss: 0.007494342979043722
Saved model as forecasting_models_v5/model_transformer_with_attention.h5
Saved scaler as forecasting_models_v5/scaler.save

Preparing sample inference example for TRANSFORMER model...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 182ms/step
Predicted QoE for the next time step: 2.0863498833827765
Model renamed to: /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/transformer_with_stats.h5
Completed at Δευ 12 Μαΐ 2025 10:26:52 μμ EEST
=====================================================
Scaler file exists at /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5/scaler.save

=====================================================
All models trained successfully!
Models are saved in /home/dimitris/Impact-xG_prediction_model/forecasting_models_v5
Training completed at Δευ 12 Μαΐ 2025 10:26:52 μμ EEST
=====================================================
